
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7. 進階運算與統計方法 &#8212; Python在大氣和海洋科學上的應用 (PyAOS)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. xarray繪圖 (1)：繪製1D資料" href="08_plotting_1d.html" />
    <link rel="prev" title="6. 計算氣候場及距平值" href="06_clim_anml.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HKB5C6NRJC"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-HKB5C6NRJC');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/PyAOS_logo_color.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python在大氣和海洋科學上的應用 (PyAOS)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_syllabus.html">
                    教學綱要（中文）
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  xArray基本原理與操作
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_setup.html">
   電腦環境設置與Python安裝
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_intro.html">
   1. 導論
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_open_nc_files.html">
   2. 讀取netCDF和GRIB資料
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_plotting_basics.html">
   3. 繪製月平均地圖及輸出計算結果
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_xr_datetime.html">
   4. 時間條件控制
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_da_create.html">
   5. 手動創建DataArray
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  氣候分析方法基礎
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="06_clim_anml.html">
   6. 計算氣候場及距平值
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   7. 進階運算與統計方法
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  xArray繪圖
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="08_plotting_1d.html">
   8.
   <code class="docutils literal notranslate">
    <span class="pre">
     xarray
    </span>
   </code>
   繪圖 (1)：繪製1D資料
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_plotting_2d.html">
   9.
   <code class="docutils literal notranslate">
    <span class="pre">
     xarray
    </span>
   </code>
   繪圖 (2)：繪製2D資料
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_pandas_seaborn.html">
   10.
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   和
   <code class="docutils literal notranslate">
    <span class="pre">
     seaborn
    </span>
   </code>
   : 統計圖表繪製
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  其他重要議題
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="11_cdo.html">
   11. Climate Data Operator (CDO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_large_ds.html">
   12. 大型資料處理
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  附錄
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="appendix-main.html">
   附錄：實用氣候分析程式範例
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="A4_ireg_grid_sel.html">
     不規則形狀的網格選擇
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A3_bandpass_filter.html">
     Lanczos 時間序列帶通濾波 (Bandpass Filter)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A1_mjo_phase.html">
     馬登－朱利安震盪 (MJO) 氣候變異分析
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A2_besttracks.html">
     颱風資料庫與路徑繪製
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/wyhtsai/wyhtsai.github.io/master?urlpath=tree/docs/07_statistics_calc.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos-wks/docs"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos-wks/docs/issues/new?title=Issue%20on%20page%20%2F07_statistics_calc.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/07_statistics_calc.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolation">
   網格內插 (Interpolation)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   改變網格解析度
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-mean">
   滑動平均 (running mean)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation-map">
   相關係數地圖 (correlation map)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where">
   <code class="docutils literal notranslate">
    <span class="pre">
     where
    </span>
   </code>
   條件控制
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vorticity-divergence">
   計算相對渦度 (vorticity)、散度 (divergence)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#streamfunction-velocity-potential">
   計算流函數(streamfunction)、速度位(velocity potential)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eof">
   計算經驗正交函數 (EOF)
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>7. 進階運算與統計方法</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolation">
   網格內插 (Interpolation)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   改變網格解析度
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-mean">
   滑動平均 (running mean)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation-map">
   相關係數地圖 (correlation map)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where">
   <code class="docutils literal notranslate">
    <span class="pre">
     where
    </span>
   </code>
   條件控制
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vorticity-divergence">
   計算相對渦度 (vorticity)、散度 (divergence)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#streamfunction-velocity-potential">
   計算流函數(streamfunction)、速度位(velocity potential)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eof">
   計算經驗正交函數 (EOF)
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>7. 進階運算與統計方法<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="interpolation">
<h2>網格內插 (Interpolation)<a class="headerlink" href="#interpolation" title="Permalink to this headline">#</a></h2>
<p>不同的資料通常有不同的時間和網格解析度，根據需求有時需要將資料<code class="docutils literal notranslate"><span class="pre">A</span></code>資料內插到資料<code class="docutils literal notranslate"><span class="pre">B</span></code>的網格上。<code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> 和<code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> 有內建網格內插的方法<code class="docutils literal notranslate"><span class="pre">xr.interp</span></code>，請見以下範例。</p>
<p><strong>Example 1:</strong> GPCP降雨資料網格解析度為2.5度，OLR網格資料解析度為1度，欲將OLR資料內插到GPCP資料網格上。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">lats</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="n">latn</span> <span class="o">=</span>  <span class="mi">30</span>
<span class="n">lon1</span> <span class="o">=</span>  <span class="mi">79</span> 
<span class="n">lon2</span> <span class="o">=</span> <span class="mi">161</span>

<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/gpcp_precip_1979-2019.pentad.nc&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pcp_ds</span><span class="p">:</span> 
    <span class="n">pcp</span> <span class="o">=</span> <span class="n">pcp_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/olr.nc&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">olr_ds</span><span class="p">:</span>
    <span class="n">olr</span> <span class="o">=</span> <span class="n">olr_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">olr</span>

<span class="n">olr_rmp</span> <span class="o">=</span> <span class="n">olr</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>   <span class="c1"># 利用interp的method進行網格內插。</span>
<span class="n">olr_rmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 8760, lat: 20, lon: 32)&gt;
array([[[210.37125, 199.29874, 197.44077, ..., 268.05853, 268.25916,
         266.9823 ],
        [204.61313, 213.93433, 230.92719, ..., 284.24072, 282.60632,
         278.35385],
        [236.69272, 247.62692, 259.35587, ..., 294.86554, 292.45862,
         292.01804],
        ...,
        [297.27472, 302.5027 , 305.18634, ..., 193.11395, 206.42505,
         197.59212],
        [291.31464, 291.11176, 298.43726, ..., 155.4393 , 146.58469,
         162.1478 ],
        [286.89136, 290.6887 , 291.20618, ..., 171.58977, 183.45123,
         195.39035]],

       [[259.8478 , 225.8486 , 211.98647, ..., 269.50348, 269.39746,
         272.64   ],
        [276.39136, 272.1738 , 268.95856, ..., 291.94778, 289.79297,
         284.37097],
        [260.77368, 265.89886, 275.41898, ..., 301.7583 , 299.66028,
         292.9348 ],
...
        [289.9028 , 281.8377 , 285.37466, ..., 169.81645, 173.29109,
         213.98285],
        [286.0285 , 282.36426, 284.31454, ..., 111.96492, 154.03249,
         224.03793],
        [290.05353, 295.02466, 291.87067, ..., 125.69296, 153.77583,
         191.87067]],

       [[240.00652, 211.87251, 198.56546, ..., 264.23984, 258.3333 ,
         255.25803],
        [224.23218, 243.02698, 246.38681, ..., 279.6334 , 274.43097,
         277.21472],
        [234.04726, 253.98969, 263.0449 , ..., 289.64203, 291.71185,
         293.91864],
        ...,
        [286.8454 , 287.29822, 284.08643, ..., 165.07278, 165.68568,
         180.77968],
        [291.43097, 289.64923, 295.36426, ..., 178.16243, 158.17258,
         182.52911],
        [294.91678, 297.96875, 296.73392, ..., 174.35318, 157.13422,
         152.69089]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1998-01-01 1998-01-02 ... 2021-12-31
  * lon      (lon) float32 81.25 83.75 86.25 88.75 ... 151.2 153.8 156.2 158.8
  * lat      (lat) float32 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8760</li><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-707e4d97-54b6-46d1-9a37-3a7e03c620cc' class='xr-array-in' type='checkbox' checked><label for='section-707e4d97-54b6-46d1-9a37-3a7e03c620cc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>210.4 199.3 197.4 206.3 213.6 205.5 ... 267.5 231.1 174.4 157.1 152.7</span></div><div class='xr-array-data'><pre>array([[[210.37125, 199.29874, 197.44077, ..., 268.05853, 268.25916,
         266.9823 ],
        [204.61313, 213.93433, 230.92719, ..., 284.24072, 282.60632,
         278.35385],
        [236.69272, 247.62692, 259.35587, ..., 294.86554, 292.45862,
         292.01804],
        ...,
        [297.27472, 302.5027 , 305.18634, ..., 193.11395, 206.42505,
         197.59212],
        [291.31464, 291.11176, 298.43726, ..., 155.4393 , 146.58469,
         162.1478 ],
        [286.89136, 290.6887 , 291.20618, ..., 171.58977, 183.45123,
         195.39035]],

       [[259.8478 , 225.8486 , 211.98647, ..., 269.50348, 269.39746,
         272.64   ],
        [276.39136, 272.1738 , 268.95856, ..., 291.94778, 289.79297,
         284.37097],
        [260.77368, 265.89886, 275.41898, ..., 301.7583 , 299.66028,
         292.9348 ],
...
        [289.9028 , 281.8377 , 285.37466, ..., 169.81645, 173.29109,
         213.98285],
        [286.0285 , 282.36426, 284.31454, ..., 111.96492, 154.03249,
         224.03793],
        [290.05353, 295.02466, 291.87067, ..., 125.69296, 153.77583,
         191.87067]],

       [[240.00652, 211.87251, 198.56546, ..., 264.23984, 258.3333 ,
         255.25803],
        [224.23218, 243.02698, 246.38681, ..., 279.6334 , 274.43097,
         277.21472],
        [234.04726, 253.98969, 263.0449 , ..., 289.64203, 291.71185,
         293.91864],
        ...,
        [286.8454 , 287.29822, 284.08643, ..., 165.07278, 165.68568,
         180.77968],
        [291.43097, 289.64923, 295.36426, ..., 178.16243, 158.17258,
         182.52911],
        [294.91678, 297.96875, 296.73392, ..., 174.35318, 157.13422,
         152.69089]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4711c0d2-7865-4648-9355-69466b1ab421' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4711c0d2-7865-4648-9355-69466b1ab421' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-31</div><input id='attrs-898f99d2-c185-44d0-acbc-3dba64a3b7d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-898f99d2-c185-44d0-acbc-3dba64a3b7d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdf89f24-bca8-4736-88df-69444a4e4eac' class='xr-var-data-in' type='checkbox'><label for='data-fdf89f24-bca8-4736-88df-69444a4e4eac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-02T00:00:00.000000000&#x27;,
       &#x27;1998-01-03T00:00:00.000000000&#x27;, ..., &#x27;2021-12-29T00:00:00.000000000&#x27;,
       &#x27;2021-12-30T00:00:00.000000000&#x27;, &#x27;2021-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-bfce38ae-a386-486f-9c51-c04e49e7eb0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bfce38ae-a386-486f-9c51-c04e49e7eb0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6cf6c88-1a7a-4cc2-8943-807552284d60' class='xr-var-data-in' type='checkbox'><label for='data-d6cf6c88-1a7a-4cc2-8943-807552284d60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-32fe3924-419a-4b8a-aec9-9c4e5dddb223' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-32fe3924-419a-4b8a-aec9-9c4e5dddb223' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49a02898-cb3b-42bf-b839-b507adb934e1' class='xr-var-data-in' type='checkbox'><label for='data-49a02898-cb3b-42bf-b839-b507adb934e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0f98d6b6-4c83-46ab-bc02-f6e1d192e1da' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0f98d6b6-4c83-46ab-bc02-f6e1d192e1da' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="id2">
<h2>改變網格解析度<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>時間和空間的網格解析度可以用採用 <code class="docutils literal notranslate"><span class="pre">xarray.DataArray.coarsen</span></code> 更改。</p>
<p><strong>Example 2:</strong> 將每日OLR轉換成侯(pentad)平均資料，意即將時間解析度調整為5天一次。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">olr_noleap</span> <span class="o">=</span> <span class="n">olr</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">olr</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">olr</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>
<span class="n">olr_ptd</span> <span class="o">=</span> <span class="p">(</span><span class="n">olr_noleap</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                              <span class="n">coord_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">})</span>  
                     <span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">olr_ptd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 1752, lat: 50, lon: 82)&gt;
array([[[284.27383, 285.73615, 288.25266, ..., 231.88799, 241.6569 ,
         249.84024],
        [286.65228, 288.0508 , 288.27435, ..., 215.95383, 230.82944,
         246.1481 ],
        [290.7838 , 290.2586 , 287.82904, ..., 198.27681, 214.98921,
         225.9622 ],
        ...,
        [247.29614, 246.06245, 247.9498 , ..., 279.0298 , 277.99088,
         276.57684],
        [244.55948, 242.81021, 239.57669, ..., 273.2099 , 271.63373,
         270.99365],
        [236.1903 , 229.96805, 221.43008, ..., 266.5147 , 266.81476,
         266.7093 ]],

       [[257.097  , 249.0689 , 260.7727 , ..., 251.24785, 258.4394 ,
         267.57504],
        [265.49664, 263.9062 , 270.4431 , ..., 237.29636, 248.2174 ,
         250.10226],
        [261.7508 , 266.22888, 276.74783, ..., 222.4416 , 235.64157,
         227.53247],
...
        [246.52588, 246.06046, 249.06099, ..., 256.54034, 259.21564,
         260.40427],
        [244.2377 , 247.02632, 246.57185, ..., 258.28464, 255.90445,
         257.71054],
        [237.54703, 235.23251, 224.96394, ..., 255.28891, 253.66435,
         255.53586]],

       [[286.864  , 287.83688, 290.30945, ..., 194.66502, 212.79057,
         210.36748],
        [288.31   , 288.92453, 290.12537, ..., 204.64694, 225.9674 ,
         223.37724],
        [284.80383, 288.20563, 289.7766 , ..., 215.14029, 236.13554,
         232.43852],
        ...,
        [236.44717, 236.95544, 234.64787, ..., 268.50082, 268.91937,
         267.25333],
        [235.04623, 231.87952, 229.08992, ..., 267.69647, 267.49542,
         266.0851 ],
        [233.44182, 225.93411, 211.10928, ..., 268.23108, 265.9177 ,
         264.84662]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1998-01-01 1998-01-06 ... 2021-12-27
  * lon      (lon) float32 79.5 80.5 81.5 82.5 83.5 ... 157.5 158.5 159.5 160.5
  * lat      (lat) float32 -19.5 -18.5 -17.5 -16.5 -15.5 ... 26.5 27.5 28.5 29.5
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1752</li><li><span class='xr-has-index'>lat</span>: 50</li><li><span class='xr-has-index'>lon</span>: 82</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-bb927777-d97b-49fa-9993-a15c7f36da76' class='xr-array-in' type='checkbox' checked><label for='section-bb927777-d97b-49fa-9993-a15c7f36da76' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>284.3 285.7 288.3 286.6 273.7 271.3 ... 266.2 264.9 268.2 265.9 264.8</span></div><div class='xr-array-data'><pre>array([[[284.27383, 285.73615, 288.25266, ..., 231.88799, 241.6569 ,
         249.84024],
        [286.65228, 288.0508 , 288.27435, ..., 215.95383, 230.82944,
         246.1481 ],
        [290.7838 , 290.2586 , 287.82904, ..., 198.27681, 214.98921,
         225.9622 ],
        ...,
        [247.29614, 246.06245, 247.9498 , ..., 279.0298 , 277.99088,
         276.57684],
        [244.55948, 242.81021, 239.57669, ..., 273.2099 , 271.63373,
         270.99365],
        [236.1903 , 229.96805, 221.43008, ..., 266.5147 , 266.81476,
         266.7093 ]],

       [[257.097  , 249.0689 , 260.7727 , ..., 251.24785, 258.4394 ,
         267.57504],
        [265.49664, 263.9062 , 270.4431 , ..., 237.29636, 248.2174 ,
         250.10226],
        [261.7508 , 266.22888, 276.74783, ..., 222.4416 , 235.64157,
         227.53247],
...
        [246.52588, 246.06046, 249.06099, ..., 256.54034, 259.21564,
         260.40427],
        [244.2377 , 247.02632, 246.57185, ..., 258.28464, 255.90445,
         257.71054],
        [237.54703, 235.23251, 224.96394, ..., 255.28891, 253.66435,
         255.53586]],

       [[286.864  , 287.83688, 290.30945, ..., 194.66502, 212.79057,
         210.36748],
        [288.31   , 288.92453, 290.12537, ..., 204.64694, 225.9674 ,
         223.37724],
        [284.80383, 288.20563, 289.7766 , ..., 215.14029, 236.13554,
         232.43852],
        ...,
        [236.44717, 236.95544, 234.64787, ..., 268.50082, 268.91937,
         267.25333],
        [235.04623, 231.87952, 229.08992, ..., 267.69647, 267.49542,
         266.0851 ],
        [233.44182, 225.93411, 211.10928, ..., 268.23108, 265.9177 ,
         264.84662]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-3225c675-521c-4a39-bc20-2da5ed284dee' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3225c675-521c-4a39-bc20-2da5ed284dee' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-27</div><input id='attrs-82449321-a058-4063-a112-24f833df0647' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-82449321-a058-4063-a112-24f833df0647' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d1a16f9-7506-4c40-b675-01a23e89fccf' class='xr-var-data-in' type='checkbox'><label for='data-1d1a16f9-7506-4c40-b675-01a23e89fccf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-06T00:00:00.000000000&#x27;,
       &#x27;1998-01-11T00:00:00.000000000&#x27;, ..., &#x27;2021-12-17T00:00:00.000000000&#x27;,
       &#x27;2021-12-22T00:00:00.000000000&#x27;, &#x27;2021-12-27T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>79.5 80.5 81.5 ... 159.5 160.5</div><input id='attrs-0473ed65-62bf-4c6d-9262-0cd68523f7ed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0473ed65-62bf-4c6d-9262-0cd68523f7ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be8bc2b8-306d-4124-b251-63cb93db1032' class='xr-var-data-in' type='checkbox'><label for='data-be8bc2b8-306d-4124-b251-63cb93db1032' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 28.5 29.5</div><input id='attrs-aee88a72-2973-4cc4-b88b-e92924be0d00' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aee88a72-2973-4cc4-b88b-e92924be0d00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f3234b3-740f-435b-98b2-b8eb402746e0' class='xr-var-data-in' type='checkbox'><label for='data-8f3234b3-740f-435b-98b2-b8eb402746e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5d8d26f2-9467-4b34-be59-6714244cb824' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5d8d26f2-9467-4b34-be59-6714244cb824' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>也就是在時間的維度上，5天為一個單位平均。 <code class="docutils literal notranslate"><span class="pre">coord_func</span></code> 預設為 <code class="docutils literal notranslate"><span class="pre">mean</span></code>，也就是重新取樣後的座標 (時間) 軸會選擇5天平均後的時間軸 (如1998-01-03, 1998-01-08, 1998-01-13, …)，其他選項可選 <code class="docutils literal notranslate"><span class="pre">min</span></code> 設定為最小值 (一侯的開始日) 或 <code class="docutils literal notranslate"><span class="pre">max</span></code> 最大值 (一侯的結束日)。</p>
<p><strong>Note:</strong> 雖然<code class="docutils literal notranslate"><span class="pre">xarray.DataArray.resample</span></code>看似也有同樣功能，但根據API reference，</p>
<blockquote>
<div><p>The resampled dimension must be a datetime-like coordinate.</p>
</div></blockquote>
<p>根據以上範例，就是 <code class="docutils literal notranslate"><span class="pre">olr_ptd</span> <span class="pre">=</span> <span class="pre">olr_noleap.resample(time='5D')</span></code> ，然而<code class="docutils literal notranslate"><span class="pre">datetime</span></code> 物件無法選擇日曆格式，也就是在計算五天平均時，不論原始資料 <code class="docutils literal notranslate"><span class="pre">olr_noleap</span></code> 有沒有2/29，這個方法都會納入2/29 (延伸閱讀：<a class="reference external" href="https://stackoverflow.com/questions/64476727/can-we-assign-the-calendar-of-pandas-datetimeindex-as-noleap-or-can-datetime">StackOverflow 的問答</a>)。</p>
<div class="seealso admonition">
<p class="admonition-title">Exercise</p>
<p>請利用coarsen改變空間的解析度 (i.e. 將1˚解析度的OLR資料regrid成2˚解析度)。</p>
</div>
</section>
<section id="running-mean">
<h2>滑動平均 (running mean)<a class="headerlink" href="#running-mean" title="Permalink to this headline">#</a></h2>
<p>可利用 <code class="docutils literal notranslate"><span class="pre">xarray.DataArray.rolling</span></code>，連續選擇3個單位，再進行平均。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">olr_3p_runave</span> <span class="o">=</span> <span class="p">(</span><span class="n">olr_ptd</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>        <span class="c1"># 選擇幾個時間單位</span>
                                 <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">olr_3p_runave</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 1752, lat: 50, lon: 82)&gt;
array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
...
        [258.01865, 258.54132, 260.59457, ..., 265.62262, 266.46997,
         267.72852],
        [254.52092, 255.43341, 253.74515, ..., 262.07703, 262.12787,
         264.36252],
        [249.05486, 243.50095, 230.53357, ..., 257.8312 , 259.1329 ,
         259.55786]],

       [[285.45612, 286.57214, 287.6652 , ..., 247.677  , 257.28473,
         259.3609 ],
        [288.13184, 288.3128 , 289.0145 , ..., 255.27068, 264.8253 ,
         264.77902],
        [288.0848 , 289.45697, 289.93057, ..., 261.4938 , 269.81818,
         268.2691 ],
        ...,
        [248.90976, 249.10083, 250.33572, ..., 262.9018 , 263.4146 ,
         263.58185],
        [247.00436, 247.02068, 245.05011, ..., 261.76514, 261.24374,
         261.8905 ],
        [243.24814, 237.90851, 224.16135, ..., 258.3669 , 257.77066,
         257.97882]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1998-01-01 1998-01-06 ... 2021-12-27
  * lon      (lon) float32 79.5 80.5 81.5 82.5 83.5 ... 157.5 158.5 159.5 160.5
  * lat      (lat) float32 -19.5 -18.5 -17.5 -16.5 -15.5 ... 26.5 27.5 28.5 29.5
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1752</li><li><span class='xr-has-index'>lat</span>: 50</li><li><span class='xr-has-index'>lon</span>: 82</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ce7a6c5a-b18e-4b90-bab5-c7a7e65366f1' class='xr-array-in' type='checkbox' checked><label for='section-ce7a6c5a-b18e-4b90-bab5-c7a7e65366f1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 258.0 256.9 255.2 258.4 257.8 258.0</span></div><div class='xr-array-data'><pre>array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
...
        [258.01865, 258.54132, 260.59457, ..., 265.62262, 266.46997,
         267.72852],
        [254.52092, 255.43341, 253.74515, ..., 262.07703, 262.12787,
         264.36252],
        [249.05486, 243.50095, 230.53357, ..., 257.8312 , 259.1329 ,
         259.55786]],

       [[285.45612, 286.57214, 287.6652 , ..., 247.677  , 257.28473,
         259.3609 ],
        [288.13184, 288.3128 , 289.0145 , ..., 255.27068, 264.8253 ,
         264.77902],
        [288.0848 , 289.45697, 289.93057, ..., 261.4938 , 269.81818,
         268.2691 ],
        ...,
        [248.90976, 249.10083, 250.33572, ..., 262.9018 , 263.4146 ,
         263.58185],
        [247.00436, 247.02068, 245.05011, ..., 261.76514, 261.24374,
         261.8905 ],
        [243.24814, 237.90851, 224.16135, ..., 258.3669 , 257.77066,
         257.97882]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-beb2039c-eeb3-421b-89e0-d32db86245bf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-beb2039c-eeb3-421b-89e0-d32db86245bf' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-27</div><input id='attrs-a454b66a-b4bd-4ef3-8324-616e18a9e473' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a454b66a-b4bd-4ef3-8324-616e18a9e473' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b9f5ca2a-3145-4de0-8654-b1857715e0da' class='xr-var-data-in' type='checkbox'><label for='data-b9f5ca2a-3145-4de0-8654-b1857715e0da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-06T00:00:00.000000000&#x27;,
       &#x27;1998-01-11T00:00:00.000000000&#x27;, ..., &#x27;2021-12-17T00:00:00.000000000&#x27;,
       &#x27;2021-12-22T00:00:00.000000000&#x27;, &#x27;2021-12-27T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>79.5 80.5 81.5 ... 159.5 160.5</div><input id='attrs-b0c61a97-8f19-4cbc-8cd7-976a5168d20b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b0c61a97-8f19-4cbc-8cd7-976a5168d20b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6713530a-33df-4642-8d61-8e291509ad7e' class='xr-var-data-in' type='checkbox'><label for='data-6713530a-33df-4642-8d61-8e291509ad7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 28.5 29.5</div><input id='attrs-1d61fb8a-0789-4186-b7ef-c9191f12eb9a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1d61fb8a-0789-4186-b7ef-c9191f12eb9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7927157e-bb4d-4649-89bb-d77c3d0ce5bc' class='xr-var-data-in' type='checkbox'><label for='data-7927157e-bb4d-4649-89bb-d77c3d0ce5bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-102d020d-0adf-4915-a284-1d7bc0a27d17' class='xr-section-summary-in' type='checkbox'  checked><label for='section-102d020d-0adf-4915-a284-1d7bc0a27d17' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>由於頭尾會有缺失值NaN，可加上<code class="docutils literal notranslate"><span class="pre">dropna()</span></code>移除之。</p>
</section>
<section id="correlation-map">
<h2>相關係數地圖 (correlation map)<a class="headerlink" href="#correlation-map" title="Permalink to this headline">#</a></h2>
<p>給定兩個DataArray，我們就可以計算兩者之間沿著特定座標軸 (e.g. 沿著時間軸的) 的相關係數。</p>
<p><strong>Example 3:</strong> 計算NDJ <a class="reference external" href="https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php">Oceanic Niño Index (ONI)</a> 和十二月降雨的相關係數地圖。</p>
<p>Step 1: 得到GPCP十二月平均資料 (先所有選12月資料，再用<code class="docutils literal notranslate"><span class="pre">groupby</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcp_dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">12</span><span class="p">]))</span>
              <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span>
              <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
<span class="n">pcp_dec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;data&#x27; (year: 41, lat: 20, lon: 32)&gt;
array([[[1.0133333e+00, 9.1833335e-01, 7.9833335e-01, ...,
         3.6333332e+00, 2.7116668e+00, 2.5383332e+00],
        [2.0333333e-01, 4.2833331e-01, 2.5000000e-01, ...,
         2.4483335e+00, 2.3216665e+00, 1.7766668e+00],
        [5.4999996e-02, 1.3666667e-01, 1.5833335e-01, ...,
         2.2033334e+00, 1.8683333e+00, 1.2850000e+00],
        ...,
        [1.1466666e+00, 1.4950000e+00, 1.8333334e+00, ...,
         3.6483333e+00, 4.2433333e+00, 2.9916668e+00],
        [7.1833342e-01, 1.3866667e+00, 1.4466667e+00, ...,
         4.0750003e+00, 3.2466667e+00, 2.8599999e+00],
        [3.9666668e-01, 8.2333332e-01, 1.1883334e+00, ...,
         2.9016666e+00, 2.7083333e+00, 1.7416667e+00]],

       [[4.6500000e-01, 2.8333333e-01, 3.4333333e-01, ...,
         3.8716667e+00, 3.8800001e+00, 3.4633334e+00],
        [6.0833335e-01, 1.7000000e-01, 1.4666666e-01, ...,
         3.9749997e+00, 3.6300001e+00, 3.1483333e+00],
        [1.2800001e+00, 3.2166669e-01, 1.2000000e-01, ...,
         2.4466670e+00, 2.1550000e+00, 1.1616668e+00],
...
        [7.9235020e+00, 7.0794005e+00, 5.7172122e+00, ...,
         9.7668800e+00, 1.0939357e+01, 1.0846936e+01],
        [9.5492640e+00, 7.4848499e+00, 3.3095341e+00, ...,
         1.2228070e+01, 1.2528176e+01, 1.1302447e+01],
        [7.2531962e+00, 5.3915715e+00, 2.0546637e+00, ...,
         1.0486613e+01, 1.3482673e+01, 1.1387761e+01]],

       [[2.0096309e+00, 1.1509016e+00, 4.8980752e-01, ...,
         2.0202532e+00, 2.7056715e+00, 2.6676538e+00],
        [1.2896463e+00, 1.1470729e+00, 2.6983759e-01, ...,
         1.3239046e+00, 1.6525989e+00, 1.6284057e+00],
        [8.9463836e-01, 3.9747801e-01, 1.5476857e-01, ...,
         1.1533504e+00, 1.1403440e+00, 9.9328095e-01],
        ...,
        [1.2956619e+00, 6.6536540e-01, 5.8920258e-01, ...,
         4.1320643e+00, 4.3791137e+00, 4.1250491e+00],
        [1.7519034e+00, 1.2151116e+00, 9.6764684e-01, ...,
         5.1612849e+00, 5.1797566e+00, 2.8651981e+00],
        [3.1523106e+00, 2.0467210e+00, 1.0773114e+00, ...,
         3.6295269e+00, 4.3244128e+00, 2.4604805e+00]]], dtype=float32)
Coordinates:
  * lon      (lon) float32 81.25 83.75 86.25 88.75 ... 151.2 153.8 156.2 158.8
  * lat      (lat) float32 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75
  * year     (year) int64 1979 1980 1981 1982 1983 ... 2015 2016 2017 2018 2019</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'data'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d88f9f27-08d2-49c1-ac62-50a2b4c30b11' class='xr-array-in' type='checkbox' checked><label for='section-d88f9f27-08d2-49c1-ac62-50a2b4c30b11' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.013 0.9183 0.7983 0.16 0.2633 0.9183 ... 1.036 1.953 3.63 4.324 2.46</span></div><div class='xr-array-data'><pre>array([[[1.0133333e+00, 9.1833335e-01, 7.9833335e-01, ...,
         3.6333332e+00, 2.7116668e+00, 2.5383332e+00],
        [2.0333333e-01, 4.2833331e-01, 2.5000000e-01, ...,
         2.4483335e+00, 2.3216665e+00, 1.7766668e+00],
        [5.4999996e-02, 1.3666667e-01, 1.5833335e-01, ...,
         2.2033334e+00, 1.8683333e+00, 1.2850000e+00],
        ...,
        [1.1466666e+00, 1.4950000e+00, 1.8333334e+00, ...,
         3.6483333e+00, 4.2433333e+00, 2.9916668e+00],
        [7.1833342e-01, 1.3866667e+00, 1.4466667e+00, ...,
         4.0750003e+00, 3.2466667e+00, 2.8599999e+00],
        [3.9666668e-01, 8.2333332e-01, 1.1883334e+00, ...,
         2.9016666e+00, 2.7083333e+00, 1.7416667e+00]],

       [[4.6500000e-01, 2.8333333e-01, 3.4333333e-01, ...,
         3.8716667e+00, 3.8800001e+00, 3.4633334e+00],
        [6.0833335e-01, 1.7000000e-01, 1.4666666e-01, ...,
         3.9749997e+00, 3.6300001e+00, 3.1483333e+00],
        [1.2800001e+00, 3.2166669e-01, 1.2000000e-01, ...,
         2.4466670e+00, 2.1550000e+00, 1.1616668e+00],
...
        [7.9235020e+00, 7.0794005e+00, 5.7172122e+00, ...,
         9.7668800e+00, 1.0939357e+01, 1.0846936e+01],
        [9.5492640e+00, 7.4848499e+00, 3.3095341e+00, ...,
         1.2228070e+01, 1.2528176e+01, 1.1302447e+01],
        [7.2531962e+00, 5.3915715e+00, 2.0546637e+00, ...,
         1.0486613e+01, 1.3482673e+01, 1.1387761e+01]],

       [[2.0096309e+00, 1.1509016e+00, 4.8980752e-01, ...,
         2.0202532e+00, 2.7056715e+00, 2.6676538e+00],
        [1.2896463e+00, 1.1470729e+00, 2.6983759e-01, ...,
         1.3239046e+00, 1.6525989e+00, 1.6284057e+00],
        [8.9463836e-01, 3.9747801e-01, 1.5476857e-01, ...,
         1.1533504e+00, 1.1403440e+00, 9.9328095e-01],
        ...,
        [1.2956619e+00, 6.6536540e-01, 5.8920258e-01, ...,
         4.1320643e+00, 4.3791137e+00, 4.1250491e+00],
        [1.7519034e+00, 1.2151116e+00, 9.6764684e-01, ...,
         5.1612849e+00, 5.1797566e+00, 2.8651981e+00],
        [3.1523106e+00, 2.0467210e+00, 1.0773114e+00, ...,
         3.6295269e+00, 4.3244128e+00, 2.4604805e+00]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-1ac434bd-b565-4e3a-a9f4-ccde65abbf49' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ac434bd-b565-4e3a-a9f4-ccde65abbf49' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-2ebdbda4-2eed-44df-868d-0fb159d58d1d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2ebdbda4-2eed-44df-868d-0fb159d58d1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1f26477-dfd0-4696-9b78-5f4b1891a315' class='xr-var-data-in' type='checkbox'><label for='data-e1f26477-dfd0-4696-9b78-5f4b1891a315' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-5798f3a0-5723-4c75-9bb2-20971c55ee33' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5798f3a0-5723-4c75-9bb2-20971c55ee33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e17df59-e44d-4de4-a89f-2c9bbbb62ec1' class='xr-var-data-in' type='checkbox'><label for='data-0e17df59-e44d-4de4-a89f-2c9bbbb62ec1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1979 1980 1981 ... 2017 2018 2019</div><input id='attrs-cbe0ff92-9886-499d-ac76-85644e13f4b5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cbe0ff92-9886-499d-ac76-85644e13f4b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22ccbd19-3dde-41cd-86e5-96e7666b6b83' class='xr-var-data-in' type='checkbox'><label for='data-22ccbd19-3dde-41cd-86e5-96e7666b6b83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1bbe2fa6-8fef-4d3b-b4d6-d23ec58e8dc7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1bbe2fa6-8fef-4d3b-b4d6-d23ec58e8dc7' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 2: 製造NDJ ONI index矩陣。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oni_ndj</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span> 
                       <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> 
                             <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> 
                             <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> 
                             <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                       <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
                       <span class="n">coords</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">pcp_dec</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
                       <span class="p">)</span>
<span class="n">oni_ndj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (year: 41)&gt;
array([ 0.6,  0. , -0.1,  2.2, -0.9, -1.1, -0.4,  1.2,  1.1, -1.8, -0.1,
        0.4,  1.5, -0.1,  0.1,  1.1, -1. , -0.5,  2.4, -1.6, -1.7, -0.7,
       -0.3,  1.1,  0.4,  0.7, -0.8,  0.9, -1.6, -0.7,  1.6, -1.6, -1. ,
       -0.2, -0.3,  0.7,  2.6, -0.6, -1. ,  0.8,  0.5])
Coordinates:
  * year     (year) int64 1979 1980 1981 1982 1983 ... 2015 2016 2017 2018 2019</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-42947f9a-e007-47f9-957a-38f5323cc5f1' class='xr-array-in' type='checkbox' checked><label for='section-42947f9a-e007-47f9-957a-38f5323cc5f1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.6 0.0 -0.1 2.2 -0.9 -1.1 -0.4 1.2 ... -0.3 0.7 2.6 -0.6 -1.0 0.8 0.5</span></div><div class='xr-array-data'><pre>array([ 0.6,  0. , -0.1,  2.2, -0.9, -1.1, -0.4,  1.2,  1.1, -1.8, -0.1,
        0.4,  1.5, -0.1,  0.1,  1.1, -1. , -0.5,  2.4, -1.6, -1.7, -0.7,
       -0.3,  1.1,  0.4,  0.7, -0.8,  0.9, -1.6, -0.7,  1.6, -1.6, -1. ,
       -0.2, -0.3,  0.7,  2.6, -0.6, -1. ,  0.8,  0.5])</pre></div></div></li><li class='xr-section-item'><input id='section-cbd92841-2215-4aad-8af7-8b456caa85f3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cbd92841-2215-4aad-8af7-8b456caa85f3' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1979 1980 1981 ... 2017 2018 2019</div><input id='attrs-d57a4a4a-8982-494e-810c-6eb6670cb190' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d57a4a4a-8982-494e-810c-6eb6670cb190' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6483509c-0613-4c79-ae1c-441515ad6bcf' class='xr-var-data-in' type='checkbox'><label for='data-6483509c-0613-4c79-ae1c-441515ad6bcf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-130a6d96-ce15-4b56-874c-bf7e4595c88c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-130a6d96-ce15-4b56-874c-bf7e4595c88c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 3: 用<code class="docutils literal notranslate"><span class="pre">xr.corr</span></code>計算相關係數。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">pcp_dec</span><span class="p">,</span><span class="n">oni_ndj</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 20, lon: 32)&gt;
array([[ 3.62929450e-01,  3.42366942e-01,  1.36141381e-01,
         2.86181881e-01,  1.81635016e-01,  1.49191938e-01,
         2.91984707e-01,  4.77790090e-01,  4.72934967e-01,
         2.59950187e-01,  3.45925678e-01,  3.45836386e-01,
         2.41839253e-01,  3.26920712e-01,  3.12002379e-01,
         2.78955894e-01,  2.83943333e-01,  3.95803462e-01,
         4.20742017e-01,  4.71375062e-01,  5.46175411e-01,
         4.34086566e-01,  3.36992656e-01,  2.34458521e-01,
         3.30061207e-01,  2.83089061e-01,  6.62670181e-02,
        -6.41038278e-02, -8.02356746e-02, -1.32435581e-01,
        -6.14116575e-02, -3.57627851e-01],
       [ 3.83909994e-01,  3.03894569e-01,  2.37785616e-01,
         2.14941988e-01,  1.29919746e-01,  9.02064334e-02,
         1.65142449e-01,  2.02511240e-01,  2.68816747e-01,
         1.56273277e-01,  2.46169211e-01,  3.13843017e-01,
         3.71282390e-01,  3.76425076e-01,  3.56976465e-01,
         3.31840138e-01,  1.84695381e-01,  4.19843113e-01,
         4.71277836e-01,  4.27318301e-01,  3.51365938e-01,
         2.37002946e-01,  2.34139459e-01,  2.04142730e-01,
         1.27191132e-01, -7.16084567e-02, -1.17030932e-01,
...
        -1.63141762e-01,  2.02073892e-02,  8.64961718e-02,
        -6.46166026e-02, -1.30967883e-01, -1.11179142e-01,
        -2.19488529e-01, -3.89394358e-01, -5.41138826e-01,
        -5.55411056e-01, -4.62892794e-01, -3.87886305e-01,
        -2.86447731e-01, -1.87858259e-01, -4.88526557e-02,
        -6.03390711e-02, -5.92937118e-02, -1.09022280e-02,
        -1.62940985e-01, -1.06521362e-01, -1.63654750e-01,
        -2.66138357e-01, -3.63495718e-01, -3.56191189e-01,
        -3.43018587e-01, -4.02329780e-01],
       [ 2.18229669e-01,  1.50764063e-01,  4.34983981e-02,
        -2.31485316e-02, -1.24680815e-01, -2.82829680e-01,
        -2.27022126e-01, -1.80625273e-01, -6.68313151e-02,
        -1.22718870e-01, -7.70160205e-02, -1.92838392e-01,
        -2.63437026e-01, -4.77678647e-01, -6.13706399e-01,
        -5.25689473e-01, -3.34162299e-01, -3.46265772e-01,
        -2.73299079e-01, -3.36175567e-01, -1.75612505e-01,
        -7.18667215e-02, -2.45879337e-02,  2.50090720e-03,
        -1.46619849e-01, -7.41479404e-02, -3.23609326e-02,
        -1.90437809e-01, -2.59385829e-01, -3.08636804e-01,
        -2.93624470e-01, -3.09437427e-01]])
Coordinates:
  * lon      (lon) float32 81.25 83.75 86.25 88.75 ... 151.2 153.8 156.2 158.8
  * lat      (lat) float32 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0ef34918-666c-4831-bf7c-9bfd740b83e6' class='xr-array-in' type='checkbox' checked><label for='section-0ef34918-666c-4831-bf7c-9bfd740b83e6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.3629 0.3424 0.1361 0.2862 0.1816 ... -0.2594 -0.3086 -0.2936 -0.3094</span></div><div class='xr-array-data'><pre>array([[ 3.62929450e-01,  3.42366942e-01,  1.36141381e-01,
         2.86181881e-01,  1.81635016e-01,  1.49191938e-01,
         2.91984707e-01,  4.77790090e-01,  4.72934967e-01,
         2.59950187e-01,  3.45925678e-01,  3.45836386e-01,
         2.41839253e-01,  3.26920712e-01,  3.12002379e-01,
         2.78955894e-01,  2.83943333e-01,  3.95803462e-01,
         4.20742017e-01,  4.71375062e-01,  5.46175411e-01,
         4.34086566e-01,  3.36992656e-01,  2.34458521e-01,
         3.30061207e-01,  2.83089061e-01,  6.62670181e-02,
        -6.41038278e-02, -8.02356746e-02, -1.32435581e-01,
        -6.14116575e-02, -3.57627851e-01],
       [ 3.83909994e-01,  3.03894569e-01,  2.37785616e-01,
         2.14941988e-01,  1.29919746e-01,  9.02064334e-02,
         1.65142449e-01,  2.02511240e-01,  2.68816747e-01,
         1.56273277e-01,  2.46169211e-01,  3.13843017e-01,
         3.71282390e-01,  3.76425076e-01,  3.56976465e-01,
         3.31840138e-01,  1.84695381e-01,  4.19843113e-01,
         4.71277836e-01,  4.27318301e-01,  3.51365938e-01,
         2.37002946e-01,  2.34139459e-01,  2.04142730e-01,
         1.27191132e-01, -7.16084567e-02, -1.17030932e-01,
...
        -1.63141762e-01,  2.02073892e-02,  8.64961718e-02,
        -6.46166026e-02, -1.30967883e-01, -1.11179142e-01,
        -2.19488529e-01, -3.89394358e-01, -5.41138826e-01,
        -5.55411056e-01, -4.62892794e-01, -3.87886305e-01,
        -2.86447731e-01, -1.87858259e-01, -4.88526557e-02,
        -6.03390711e-02, -5.92937118e-02, -1.09022280e-02,
        -1.62940985e-01, -1.06521362e-01, -1.63654750e-01,
        -2.66138357e-01, -3.63495718e-01, -3.56191189e-01,
        -3.43018587e-01, -4.02329780e-01],
       [ 2.18229669e-01,  1.50764063e-01,  4.34983981e-02,
        -2.31485316e-02, -1.24680815e-01, -2.82829680e-01,
        -2.27022126e-01, -1.80625273e-01, -6.68313151e-02,
        -1.22718870e-01, -7.70160205e-02, -1.92838392e-01,
        -2.63437026e-01, -4.77678647e-01, -6.13706399e-01,
        -5.25689473e-01, -3.34162299e-01, -3.46265772e-01,
        -2.73299079e-01, -3.36175567e-01, -1.75612505e-01,
        -7.18667215e-02, -2.45879337e-02,  2.50090720e-03,
        -1.46619849e-01, -7.41479404e-02, -3.23609326e-02,
        -1.90437809e-01, -2.59385829e-01, -3.08636804e-01,
        -2.93624470e-01, -3.09437427e-01]])</pre></div></div></li><li class='xr-section-item'><input id='section-4db96a79-db2e-434c-ab08-bbaebf0bddfc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4db96a79-db2e-434c-ab08-bbaebf0bddfc' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-dd583732-5552-4623-8584-2fd64f77f26a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd583732-5552-4623-8584-2fd64f77f26a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c0bfc74-0ecd-4f65-b72d-123aa1af7cf1' class='xr-var-data-in' type='checkbox'><label for='data-9c0bfc74-0ecd-4f65-b72d-123aa1af7cf1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-4432380b-68b3-40ec-9c98-371831c82682' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4432380b-68b3-40ec-9c98-371831c82682' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98c60234-f8df-41fc-8c19-6102ab731d45' class='xr-var-data-in' type='checkbox'><label for='data-98c60234-f8df-41fc-8c19-6102ab731d45' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8c273370-36d7-4643-91f5-6e49a8cd2cc9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8c273370-36d7-4643-91f5-6e49a8cd2cc9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 4: 將計算好的結果畫出來看看。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span>   
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>                  
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>     
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>

<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># 繪圖</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation map (Dec precip. and DJF ONI)&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>    <span class="c1"># 設定圖片標題，並且置於圖的左側。</span>
<span class="n">olrPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                              <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> 
                              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span>  
                              <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;neither&#39;</span><span class="p">,</span> 
                              <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                              <span class="p">)</span>
                              
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_statistics_calc_16_0.png" src="_images/07_statistics_calc_16_0.png" />
</div>
</div>
</section>
<section id="where">
<h2><code class="docutils literal notranslate"><span class="pre">where</span></code>條件控制<a class="headerlink" href="#where" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code>是一個很好用的方法，可以針對資料設定條件進行篩選和過濾。我們直接看以下例子：</p>
<p><strong>Example 4:</strong> 繪製2021年12月平均之Mean Sea Level Pressure，但海拔3000公尺以上的區域不畫。</p>
<p>Step 1: 讀MSLP、地形資料。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span><span class="o">=</span><span class="mi">0</span>
<span class="n">latn</span><span class="o">=</span><span class="mi">60</span>

<span class="n">topo_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/etopo5.nc&#39;</span><span class="p">)</span>
<span class="n">mslp_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/mslp.2021.nc&#39;</span><span class="p">)</span>
<span class="n">topo</span> <span class="o">=</span> <span class="n">topo_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">),</span>
                   <span class="n">X</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">bath</span>
<span class="n">mslp</span> <span class="o">=</span> <span class="n">mslp_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2021-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">),</span>
                   <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
                   <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">mslp</span>
<span class="n">mslp</span> <span class="o">=</span> <span class="n">mslp</span><span class="o">/</span><span class="mf">100.</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code>的原理是搜尋兩者相對應的網格是否滿足給定的控制條件 （以這個範例來說是搜尋topo &gt;= 3000的網格點），但兩者網格解析度不同時，沒有辦法比較。因此必須先進行網格內插，讓<code class="docutils literal notranslate"><span class="pre">topo</span></code>和<code class="docutils literal notranslate"><span class="pre">mslp</span></code>的解析度相同。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topo_rmp</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">mslp</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">mslp</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>接著用<code class="docutils literal notranslate"><span class="pre">where</span></code>設定條件：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mslp_mask</span> <span class="o">=</span> <span class="n">mslp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">topo_rmp</span><span class="o">&lt;=</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">mslp_mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;mslp&#x27; (time: 31, lat: 25, lon: 33)&gt;
array([[[1013.425, 1015.375, 1017.25 , ..., 1015.8  , 1015.5  ,
         1015.45 ],
        [1019.35 , 1020.625, 1021.65 , ..., 1009.975, 1012.825,
         1015.25 ],
        [1023.575, 1024.4  , 1025.175, ..., 1008.025, 1013.475,
         1017.35 ],
        ...,
        [1010.3  , 1009.675, 1008.85 , ..., 1006.8  , 1007.1  ,
         1007.05 ],
        [1010.15 , 1009.875, 1009.05 , ..., 1006.775, 1007.25 ,
         1007.125],
        [1010.075, 1009.9  , 1009.175, ..., 1007.15 , 1007.35 ,
         1007.275]],

       [[1003.85 , 1006.025, 1008.05 , ...,  983.225,  983.4  ,
          984.375],
        [1010.625, 1012.975, 1015.025, ...,  974.25 ,  978.325,
          981.95 ],
        [1015.5  , 1017.675, 1019.55 , ...,  976.95 ,  981.475,
          985.325],
...
        [1011.025, 1010.875, 1010.8  , ..., 1008.775, 1008.8  ,
         1008.825],
        [1010.625, 1010.525, 1010.65 , ..., 1009.075, 1008.9  ,
         1008.65 ],
        [1011.025, 1010.85 , 1010.825, ..., 1008.475, 1008.325,
         1008.75 ]],

       [[1024.175, 1025.275, 1026.675, ..., 1019.775, 1019.725,
         1019.45 ],
        [1029.125, 1029.8  , 1030.6  , ..., 1006.275, 1007.75 ,
         1010.   ],
        [1034.4  , 1034.875, 1035.45 , ...,  995.475,  997.3  ,
         1000.925],
        ...,
        [1011.825, 1011.275, 1010.975, ..., 1009.225, 1009.4  ,
         1009.475],
        [1011.55 , 1011.   , 1010.475, ..., 1008.975, 1009.125,
         1008.975],
        [1011.575, 1011.275, 1010.925, ..., 1008.9  , 1009.2  ,
         1009.025]]], dtype=float32)
Coordinates:
  * lat      (lat) float32 60.0 57.5 55.0 52.5 50.0 ... 10.0 7.5 5.0 2.5 0.0
  * lon      (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
  * time     (time) datetime64[ns] 2021-12-01 2021-12-02 ... 2021-12-31
    X        (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
    Y        (lat) float32 60.0 57.5 55.0 52.5 50.0 ... 10.0 7.5 5.0 2.5 0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'mslp'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 31</li><li><span class='xr-has-index'>lat</span>: 25</li><li><span class='xr-has-index'>lon</span>: 33</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ced46f31-93cd-4348-b4de-431b76c3acfd' class='xr-array-in' type='checkbox' checked><label for='section-ced46f31-93cd-4348-b4de-431b76c3acfd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.013e+03 1.015e+03 1.017e+03 ... 1.009e+03 1.009e+03 1.009e+03</span></div><div class='xr-array-data'><pre>array([[[1013.425, 1015.375, 1017.25 , ..., 1015.8  , 1015.5  ,
         1015.45 ],
        [1019.35 , 1020.625, 1021.65 , ..., 1009.975, 1012.825,
         1015.25 ],
        [1023.575, 1024.4  , 1025.175, ..., 1008.025, 1013.475,
         1017.35 ],
        ...,
        [1010.3  , 1009.675, 1008.85 , ..., 1006.8  , 1007.1  ,
         1007.05 ],
        [1010.15 , 1009.875, 1009.05 , ..., 1006.775, 1007.25 ,
         1007.125],
        [1010.075, 1009.9  , 1009.175, ..., 1007.15 , 1007.35 ,
         1007.275]],

       [[1003.85 , 1006.025, 1008.05 , ...,  983.225,  983.4  ,
          984.375],
        [1010.625, 1012.975, 1015.025, ...,  974.25 ,  978.325,
          981.95 ],
        [1015.5  , 1017.675, 1019.55 , ...,  976.95 ,  981.475,
          985.325],
...
        [1011.025, 1010.875, 1010.8  , ..., 1008.775, 1008.8  ,
         1008.825],
        [1010.625, 1010.525, 1010.65 , ..., 1009.075, 1008.9  ,
         1008.65 ],
        [1011.025, 1010.85 , 1010.825, ..., 1008.475, 1008.325,
         1008.75 ]],

       [[1024.175, 1025.275, 1026.675, ..., 1019.775, 1019.725,
         1019.45 ],
        [1029.125, 1029.8  , 1030.6  , ..., 1006.275, 1007.75 ,
         1010.   ],
        [1034.4  , 1034.875, 1035.45 , ...,  995.475,  997.3  ,
         1000.925],
        ...,
        [1011.825, 1011.275, 1010.975, ..., 1009.225, 1009.4  ,
         1009.475],
        [1011.55 , 1011.   , 1010.475, ..., 1008.975, 1009.125,
         1008.975],
        [1011.575, 1011.275, 1010.925, ..., 1008.9  , 1009.2  ,
         1009.025]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-d6a5f0f6-c209-4c32-b468-855c2b59a8a8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d6a5f0f6-c209-4c32-b468-855c2b59a8a8' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>60.0 57.5 55.0 52.5 ... 5.0 2.5 0.0</div><input id='attrs-9fe1ce50-2e63-4bc5-a699-5ee37d9a2273' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9fe1ce50-2e63-4bc5-a699-5ee37d9a2273' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c02a39fb-219b-4694-97e2-ac820789ab00' class='xr-var-data-in' type='checkbox'><label for='data-c02a39fb-219b-4694-97e2-ac820789ab00' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[ 90. -90.]</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([60. , 57.5, 55. , 52.5, 50. , 47.5, 45. , 42.5, 40. , 37.5, 35. , 32.5,
       30. , 27.5, 25. , 22.5, 20. , 17.5, 15. , 12.5, 10. ,  7.5,  5. ,  2.5,
        0. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-b65026ba-1fd7-48d3-b491-2587a3f9021e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b65026ba-1fd7-48d3-b491-2587a3f9021e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ccdf91d5-a6be-498f-979a-401020b57ffa' class='xr-var-data-in' type='checkbox'><label for='data-ccdf91d5-a6be-498f-979a-401020b57ffa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.  357.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-12-01 ... 2021-12-31</div><input id='attrs-3a58c964-5462-4844-aebf-bcbdb43295a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a58c964-5462-4844-aebf-bcbdb43295a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8838477e-37f3-44d9-b0cf-3f4ed4e539f7' class='xr-var-data-in' type='checkbox'><label for='data-8838477e-37f3-44d9-b0cf-3f4ed4e539f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>avg_period :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>actual_range :</span></dt><dd>[1937256. 1945992.]</dd><dt><span>coordinate_defines :</span></dt><dd>start</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-12-01T00:00:00.000000000&#x27;, &#x27;2021-12-02T00:00:00.000000000&#x27;,
       &#x27;2021-12-03T00:00:00.000000000&#x27;, &#x27;2021-12-04T00:00:00.000000000&#x27;,
       &#x27;2021-12-05T00:00:00.000000000&#x27;, &#x27;2021-12-06T00:00:00.000000000&#x27;,
       &#x27;2021-12-07T00:00:00.000000000&#x27;, &#x27;2021-12-08T00:00:00.000000000&#x27;,
       &#x27;2021-12-09T00:00:00.000000000&#x27;, &#x27;2021-12-10T00:00:00.000000000&#x27;,
       &#x27;2021-12-11T00:00:00.000000000&#x27;, &#x27;2021-12-12T00:00:00.000000000&#x27;,
       &#x27;2021-12-13T00:00:00.000000000&#x27;, &#x27;2021-12-14T00:00:00.000000000&#x27;,
       &#x27;2021-12-15T00:00:00.000000000&#x27;, &#x27;2021-12-16T00:00:00.000000000&#x27;,
       &#x27;2021-12-17T00:00:00.000000000&#x27;, &#x27;2021-12-18T00:00:00.000000000&#x27;,
       &#x27;2021-12-19T00:00:00.000000000&#x27;, &#x27;2021-12-20T00:00:00.000000000&#x27;,
       &#x27;2021-12-21T00:00:00.000000000&#x27;, &#x27;2021-12-22T00:00:00.000000000&#x27;,
       &#x27;2021-12-23T00:00:00.000000000&#x27;, &#x27;2021-12-24T00:00:00.000000000&#x27;,
       &#x27;2021-12-25T00:00:00.000000000&#x27;, &#x27;2021-12-26T00:00:00.000000000&#x27;,
       &#x27;2021-12-27T00:00:00.000000000&#x27;, &#x27;2021-12-28T00:00:00.000000000&#x27;,
       &#x27;2021-12-29T00:00:00.000000000&#x27;, &#x27;2021-12-30T00:00:00.000000000&#x27;,
       &#x27;2021-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>X</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-cc41a4eb-7b82-4a37-8e68-442162f5bcb6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc41a4eb-7b82-4a37-8e68-442162f5bcb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e6262f9-d262-4a4b-a33c-63eddaced736' class='xr-var-data-in' type='checkbox'><label for='data-6e6262f9-d262-4a4b-a33c-63eddaced736' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.  357.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Y</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>60.0 57.5 55.0 52.5 ... 5.0 2.5 0.0</div><input id='attrs-7d5c65bc-5ed3-40ed-9fb0-b85ec35c2074' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7d5c65bc-5ed3-40ed-9fb0-b85ec35c2074' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4ad7850-c27c-4f89-b8f6-94e6c2cc108b' class='xr-var-data-in' type='checkbox'><label for='data-e4ad7850-c27c-4f89-b8f6-94e6c2cc108b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[ 90. -90.]</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([60. , 57.5, 55. , 52.5, 50. , 47.5, 45. , 42.5, 40. , 37.5, 35. , 32.5,
       30. , 27.5, 25. , 22.5, 20. , 17.5, 15. , 12.5, 10. ,  7.5,  5. ,  2.5,
        0. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0c9c1dec-aa9f-467d-8297-9af6f3cfde65' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0c9c1dec-aa9f-467d-8297-9af6f3cfde65' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>我們設定的條件就是<code class="docutils literal notranslate"><span class="pre">topo&lt;=3000</span></code>，不滿足的會直接被設定為缺失值。也可以在<code class="docutils literal notranslate"><span class="pre">where</span></code>的引數<code class="docutils literal notranslate"><span class="pre">other</span></code>中，設定當不滿足條件時要代入的值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>                  
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>     
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>

<span class="c1"># 繪圖</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MSLP, Dec. 2021&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>    <span class="c1"># 設定圖片標題，並且置於圖的左側。</span>
<span class="n">olrPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">mslp_mask</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                                   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                                   <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">986</span><span class="p">,</span><span class="mi">1048</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> 
                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>  
                                   <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                                   <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                                   <span class="p">)</span>
                              
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_statistics_calc_24_0.png" src="_images/07_statistics_calc_24_0.png" />
</div>
</div>
</section>
<section id="vorticity-divergence">
<h2>計算相對渦度 (vorticity)、散度 (divergence)<a class="headerlink" href="#vorticity-divergence" title="Permalink to this headline">#</a></h2>
<p>以上的計算都只是一些基本的統計，利用xarray的函數就可以辦到。但如果想要計算一些氣象的函數應該怎麼辦呢？我們可以使用MetPy，目前MetPy對xarray有完整的支援，可以直接將DataArray讀入MetPy的函數中。接下來我們以計算相對渦度為例，渦度和散度是氣象上常用來衡量風的旋轉量和輻合散的方法，<a class="reference external" href="https://unidata.github.io/MetPy/latest/api/generated/metpy.calc.vorticity.html">metpy.calc.vorticity</a> 可以用來計算渦度。</p>
<p><strong>Example 5:</strong> 計算2017年12月平均之850-hPa 相對渦度。</p>
<p>Step 1: 讀風場資料、選擇時空範圍。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latn</span> <span class="o">=</span> <span class="mi">30</span> 
<span class="n">lats</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>

<span class="n">uds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/ncep_r2_uv850/u850.2017.nc&#39;</span><span class="p">)</span>
<span class="n">vds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/ncep_r2_uv850/v850.2017.nc&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">uds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-12-31&#39;</span><span class="p">),</span> 
            <span class="n">level</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
            <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">uwnd</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-12-31&#39;</span><span class="p">),</span> 
            <span class="n">level</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
            <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">vwnd</span>
</pre></div>
</div>
</div>
</div>
<p>Step 2: 利用MetPy計算渦度。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>
<span class="n">vor</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vorticity</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="n">vorm</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">vorm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 21, lon: 33)&gt;
&lt;Quantity([[ 2.36233265e-06 -6.39825419e-06 -1.48893953e-05 -2.11165757e-05
  -2.33088755e-05 -2.16360718e-05 -1.75706997e-05 -1.30767962e-05
  -9.95386362e-06 -9.48662168e-06 -1.10210110e-05 -1.20864321e-05
  -9.91610363e-06 -4.92629044e-06 -9.92819381e-07 -2.22235288e-06
  -8.12038261e-06 -1.37675316e-05 -1.38730237e-05 -8.75700707e-06
  -3.11504521e-06 -1.58914246e-06 -4.06481821e-06 -6.54995237e-06
  -6.29303306e-06 -4.22673790e-06 -3.65957268e-06 -6.30998155e-06
  -1.05054567e-05 -1.36024604e-05 -1.43581988e-05 -1.37337349e-05
  -1.28075835e-05]
 [ 1.66610151e-06  1.63049861e-07 -2.98559045e-06 -6.12234630e-06
  -7.09628207e-06 -6.18605526e-06 -5.04248570e-06 -4.47708095e-06
  -3.92552273e-06 -3.13478532e-06 -2.89859971e-06 -3.75179561e-06
  -4.85217527e-06 -5.19096406e-06 -5.28739674e-06 -7.00345729e-06
  -1.07777807e-05 -1.41815747e-05 -1.41490328e-05 -1.03097954e-05
  -5.81333335e-06 -4.12559815e-06 -5.74425434e-06 -8.13382929e-06
  -8.92682657e-06 -8.35513423e-06 -8.39039425e-06 -1.01758117e-05
  -1.27938936e-05 -1.44857098e-05 -1.47083688e-05 -1.45178643e-05
  -1.47242019e-05]
 [-2.27394027e-06  1.09890178e-06  2.47027273e-06  3.24616526e-06
   4.62710452e-06  5.35378997e-06  3.55858626e-06  1.88624233e-07
...
  -8.60945662e-06 -1.11518731e-05 -1.20576630e-05 -1.14484975e-05
  -1.00187169e-05]
 [ 1.95302170e-08 -2.17666089e-06 -2.84257402e-06 -2.11128257e-06
  -9.72026477e-07 -4.91585957e-07 -9.49424917e-07 -1.43279707e-06
  -8.79066499e-07  3.55887102e-08 -9.51634479e-07 -4.42169968e-06
  -7.23094867e-06 -6.09512000e-06 -2.22809428e-06  6.57922710e-08
  -6.08036930e-07 -9.26498958e-07  1.89372298e-06  5.30749064e-06
   4.86631486e-06  6.39610666e-07 -2.41893757e-06 -8.87570244e-07
   3.13440881e-06  5.12225361e-06  3.26233714e-06 -7.08142162e-07
  -4.37945632e-06 -6.75003597e-06 -7.80123944e-06 -7.90489377e-06
  -7.50612552e-06]
 [ 3.47806787e-06  8.42960772e-08 -2.07482572e-06 -2.52527035e-06
  -1.65890932e-06 -9.57128923e-07 -1.27121261e-06 -1.73315592e-06
  -9.34373982e-07  3.18894133e-07 -5.56217745e-07 -4.74504340e-06
  -8.92532459e-06 -8.92940951e-06 -4.82235948e-06 -1.07761138e-06
  -7.63222025e-07 -2.18376918e-06 -1.97444585e-06 -2.01324902e-07
  -5.83177218e-08 -3.16564554e-06 -6.89058298e-06 -7.59123419e-06
  -4.59077338e-06 -1.49306514e-07  3.25302803e-06  4.72578338e-06
   4.46305870e-06  2.73413771e-06  3.92927204e-07 -1.69582623e-06
  -3.17572777e-06]], &#x27;1 / second&#x27;)&gt;
Coordinates:
  * lon      (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
  * lat      (lat) float32 30.0 27.5 25.0 22.5 20.0 ... -12.5 -15.0 -17.5 -20.0
    level    float32 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 21</li><li><span class='xr-has-index'>lon</span>: 33</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-8a5833d4-1027-4892-9aa3-b7092de580bd' class='xr-array-in' type='checkbox' checked><label for='section-8a5833d4-1027-4892-9aa3-b7092de580bd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>&lt;Quantity([[ 2.36233265e-06 -6.39825419e-06 -1.48893953e-05 -2.1116...</span></div><div class='xr-array-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[2.362332653997221e-06 -6.398254187744445e-06 -1.4889395323794273e-05<br>  -2.1116575679548796e-05 -2.330887552487547e-05 -2.1636071841310123e-05<br>  -1.7570699670105137e-05 -1.3076796242023209e-05 -9.953863620075213e-06<br>  -9.486621682624412e-06 -1.1021010969061373e-05 -1.2086432092443352e-05<br>  -9.91610363453668e-06 -4.926290436053886e-06 -9.928193806384323e-07<br>  -2.2223528817839707e-06 -8.120382614016711e-06 -1.3767531603287688e-05<br>  -1.3873023677672003e-05 -8.757007067865869e-06 -3.1150452055039806e-06<br>  -1.5891424645545815e-06 -4.064818209775112e-06 -6.549952370607104e-06<br>  -6.293033059508976e-06 -4.2267378969708835e-06 -3.6595726762488223e-06<br>  -6.309981548486137e-06 -1.0505456727005921e-05 -1.3602460418688458e-05<br>  -1.4358198846362108e-05 -1.3733734886886793e-05 -1.280758347359777e-05]<br> [1.6661015078194805e-06 1.6304986118740267e-07 -2.9855904508341586e-06<br>  -6.1223462950412595e-06 -7.0962820739532464e-06 -6.186055262958314e-06<br>  -5.042485695964989e-06 -4.477080945571737e-06 -3.925522730496983e-06<br>  -3.134785318196166e-06 -2.898599708648209e-06 -3.751795607330526e-06<br>  -4.852175267069523e-06 -5.190964055078969e-06 -5.287396736669966e-06<br>  -7.003457285979486e-06 -1.0777780714993725e-05 -1.4181574650552453e-05<br>  -1.4149032794888407e-05 -1.030979541847952e-05 -5.813333353072695e-06<br>  -4.125598147522754e-06 -5.744254338335591e-06 -8.13382928890478e-06<br>  -8.926826574482482e-06 -8.355134225644175e-06 -8.390394249029164e-06<br>  -1.0175811657951178e-05 -1.2793893601290063e-05 -1.4485709808259467e-05<br>  -1.470836884935186e-05 -1.451786427897572e-05 -1.4724201917148073e-05]<br> [-2.2739402652696904e-06 1.0989017764990088e-06 2.470272725089719e-06<br>  3.2461652559412253e-06 4.627104522339021e-06 5.353789969407829e-06<br>  3.558586263162925e-06 1.8862423258841394e-07 -1.4545006623847824e-06<br>  1.531666659516068e-07 2.50143356983118e-06 1.934433766873788e-06<br>  -2.265633889350283e-06 -7.421028383250221e-06 -1.0836138357242773e-05<br>  -1.222123089156416e-05 -1.2836676248431683e-05 -1.3301547307081107e-05<br>  -1.2908376314913598e-05 -1.0995110289600958e-05 -8.431165329858502e-06<br>  -6.6936822956767215e-06 -6.664547962896241e-06 -7.811779362321128e-06<br>  -9.136705353259035e-06 -1.0202199919774312e-05 -1.126719735632177e-05<br>  -1.2434296206043176e-05 -1.3310858237254318e-05 -1.3504020097434149e-05<br>  -1.3338648244924995e-05 -1.3804034829321036e-05 -1.5195955551901864e-05]<br> [-9.796487213316303e-06 -5.669389392289657e-06 -2.058775626078281e-06<br>  2.1433630042421436e-06 6.395700856922461e-06 7.905528663115197e-06<br>  4.601253612631529e-06 -1.292836255457139e-06 -4.862071690193096e-06<br>  -4.029485112241319e-06 -1.6819204293349215e-06 -1.914620562445942e-06<br>  -5.586285546943131e-06 -1.0021695977931007e-05 -1.2267956481135325e-05<br>  -1.1830692618357141e-05 -1.029139190263494e-05 -9.23133547805238e-06<br>  -9.061612268718637e-06 -9.253245856424794e-06 -8.929701327926808e-06<br>  -7.776649830106442e-06 -6.405015334001769e-06 -5.847024279933372e-06<br>  -6.704639138099189e-06 -8.738523728892882e-06 -1.0930841828980658e-05<br>  -1.2268654560878696e-05 -1.2521053999199429e-05 -1.2092662066950106e-05<br>  -1.184703663469802e-05 -1.2443901626350353e-05 -1.372891042277834e-05]<br> [-1.4741076157858923e-05 -1.2046499244147753e-05 -8.508143425517726e-06<br>  -3.6240367715042104e-06 1.1570888692941357e-06 2.8361974753066762e-06<br>  -3.961793926101769e-08 -5.205544922060189e-06 -8.981719991519464e-06<br>  -1.0335921480855086e-05 -1.0833862435860513e-05 -1.1375446015726136e-05<br>  -1.0934176424850373e-05 -8.72504678675075e-06 -5.789014942219062e-06<br>  -3.8363875247204094e-06 -3.261510817653619e-06 -3.3378221428505927e-06<br>  -3.7489069379812253e-06 -4.647591553461227e-06 -5.755190542259159e-06<br>  -6.183752075598321e-06 -5.485087473342726e-06 -4.661731010010894e-06<br>  -5.012441846070157e-06 -6.913653784361905e-06 -9.370277885097112e-06<br>  -1.1093537587898007e-05 -1.1643581386505806e-05 -1.1576174138708533e-05<br>  -1.1553173821493865e-05 -1.175577031043159e-05 -1.198468586715396e-05]<br> [-1.2060150013192108e-05 -9.62121287299037e-06 -6.675186890855316e-06<br>  -3.850582594356627e-06 -2.021312910550566e-06 -2.1516091419613374e-06<br>  -3.697454015226019e-06 -5.13059805919407e-06 -6.502627428807221e-06<br>  -9.793288693397934e-06 -1.4911959744631062e-05 -1.755946831196552e-05<br>  -1.3441736589330256e-05 -4.366313299909766e-06 2.97266333700316e-06<br>  4.173377465594046e-06 1.486558794064656e-06 -3.3972859429641396e-07<br>  2.4829024039993373e-07 9.674039301974803e-07 -2.0947403293404263e-07<br>  -2.6351196575334466e-06 -4.448128735905858e-06 -4.935183568063622e-06<br>  -4.997639913091503e-06 -5.573293997770835e-06 -6.653869492683217e-06<br>  -7.591941417693015e-06 -8.041949485334189e-06 -8.271894406419628e-06<br>  -8.50144708780542e-06 -8.530978935275993e-06 -8.16634672216552e-06]<br> [-4.282154720686661e-06 -8.810396639857927e-07 1.4001549613281594e-06<br>  9.294564850577934e-07 -1.8642796484962802e-06 -5.2052536232775566e-06<br>  -5.948476444229977e-06 -3.1222288089957663e-06 -7.258928444157091e-07<br>  -4.150435022319785e-06 -1.2513849036207997e-05 -1.731371112018262e-05<br>  -1.1932773975936428e-05 -1.7130539797323614e-07 7.642208492481362e-06<br>  6.571090643384424e-06 1.67147861773514e-06 4.3772498724212465e-07<br>  4.013621399787481e-06 7.4375608826861856e-06 6.722087529670323e-06<br>  2.5271931587462437e-06 -1.7867821166539858e-06 -4.0861631923724635e-06<br>  -4.507183299934103e-06 -4.063880150030529e-06 -3.5194298010289886e-06<br>  -2.994925179872256e-06 -2.4834475377236624e-06 -2.119850665465342e-06<br>  -2.1766396278614244e-06 -2.3258174214211124e-06 -2.278252677848091e-06]<br> [1.548362557506855e-06 4.804400256241322e-06 6.068015244886583e-06<br>  3.4935967367385805e-06 -1.9318085400372406e-06 -7.12280830892051e-06<br>  -7.96785251263528e-06 -3.539251838531966e-06 8.075807596859009e-07<br>  -1.4570451693169138e-06 -9.133290849372012e-06 -1.2911428343658978e-05<br>  -6.5452843665283165e-06 4.6624354273236414e-06 1.026529409097945e-05<br>  7.363629966134717e-06 3.0378172550742907e-06 4.52479570818388e-06<br>  1.0735277749821375e-05 1.5226132441772318e-05 1.4350859382043179e-05<br>  9.66972329440138e-06 4.68915152214959e-06 1.3143706306017087e-06<br>  -4.685144513994784e-07 -1.194898643012457e-06 -1.2620199581694317e-06<br>  -7.281767455724744e-07 3.758759385185944e-07 1.4931907444126281e-06<br>  1.9896147904882214e-06 1.8922004083421372e-06 1.6051076219014623e-06]<br> [2.323287946006794e-06 4.203433640244319e-06 4.763903452911704e-06<br>  3.1690468741610786e-06 5.440969965616932e-08 -3.37083742579168e-06<br>  -4.51663687470555e-06 -2.3380554412014995e-06 -2.0584156164753913e-07<br>  -2.200868288344759e-06 -6.245572802639071e-06 -5.18283725790025e-06<br>  3.6352768485962803e-06 1.3454094766850312e-05 1.5994191721778356e-05<br>  1.168319452963204e-05 8.512803806796211e-06 1.1473200949259872e-05<br>  1.73433608575004e-05 2.045134264925046e-05 1.932264744822243e-05<br>  1.644303409940058e-05 1.367212022143861e-05 1.0929032811919284e-05<br>  7.864306337287795e-06 4.832542678046853e-06 2.4917231396741455e-06<br>  1.2384716249705632e-06 1.190185674968099e-06 1.8340219169860544e-06<br>  2.1426330743934455e-06 1.8173710027534777e-06 1.4178063473587526e-06]<br> [2.3170167329813695e-06 3.195390378242436e-06 4.180890179768719e-06<br>  6.125389869110705e-06 8.45794211220351e-06 9.26904561550122e-06<br>  8.194420049719266e-06 6.172915394970385e-06 3.28801537600764e-06<br>  -5.896318503948602e-09 -4.0686272849615286e-07 5.783963080385593e-06<br>  1.65840013898775e-05 2.395329517553526e-05 2.2517383621886097e-05<br>  1.5851404027026893e-05 1.1743893762007767e-05 1.3087401559636607e-05<br>  1.6154143216527862e-05 1.7382359530956778e-05 1.745316199659869e-05<br>  1.8198112171621283e-05 1.9038373203070132e-05 1.838066078537156e-05<br>  1.625448452618027e-05 1.375063216486604e-05 1.1425685549092647e-05<br>  9.13984105816397e-06 7.180269826236204e-06 5.805282798819759e-06<br>  4.328209939200828e-06 2.5636768807500817e-06 1.0510171479919535e-06]<br> [5.4156680236830425e-06 6.265724240545083e-06 7.949558435114384e-06<br>  1.2447829129896594e-05 1.8497760339487734e-05 2.2177225552505165e-05<br>  2.1088062118528944e-05 1.6075867557795786e-05 9.831520970551835e-06<br>  5.91842979173731e-06 7.797192179001088e-06 1.584261759461682e-05<br>  2.4984951581811534e-05 2.784502585579056e-05 2.211211665962633e-05<br>  1.2967105389315047e-05 7.069853650675108e-06 5.89173225738146e-06<br>  6.700312586519845e-06 7.834403622644674e-06 1.0020246726392052e-05<br>  1.3167171273447982e-05 1.538576061573183e-05 1.6000814327823864e-05<br>  1.69019326019064e-05 1.939719511026573e-05 2.1766171815424377e-05<br>  2.1654014497567494e-05 1.9014813235545604e-05 1.546065824237849e-05<br>  1.1895487892874488e-05 8.44859163124568e-06 5.3594966918540354e-06]<br> [8.535357607188166e-06 8.59406316233068e-06 9.60260347496982e-06<br>  1.3499761313006915e-05 1.887551779181964e-05 2.1939091675921535e-05<br>  2.0434585250752437e-05 1.547422071105108e-05 1.0404268008285848e-05<br>  8.931937753340996e-06 1.2609478441109702e-05 1.9081690383231383e-05<br>  2.307068634062734e-05 2.0650519373123008e-05 1.2793673543924269e-05<br>  4.4243059528706725e-06 -5.33076989181432e-07 -1.9196527593116076e-06<br>  -1.2848388025408065e-06 6.455963270285897e-07 3.4201347315449136e-06<br>  5.121670107849603e-06 4.27770815793609e-06 3.1402669972794873e-06<br>  6.0895514354699985e-06 1.4178286429603941e-05 2.2833714645151046e-05<br>  2.669192562202491e-05 2.4974069242625927e-05 2.0919068763305384e-05<br>  1.722702304597063e-05 1.4222053180712548e-05 1.1517167310824817e-05]<br> [4.856806665285454e-06 2.9059287883643125e-06 2.309190917378598e-06<br>  4.178951807079473e-06 6.884096049987797e-06 7.970013766555223e-06<br>  6.3423452642235795e-06 3.5056595568980514e-06 2.5747804585272326e-06<br>  5.605912455904604e-06 1.1128670133108148e-05 1.4839776016946142e-05<br>  1.340655215165279e-05 7.645843031067591e-06 1.590823653754291e-06<br>  -1.6643106248115064e-06 -2.2595493068130043e-06 -1.950825945213204e-06<br>  -1.3889233419088041e-06 -2.1945797155747315e-07 5.195654612143274e-07<br>  -1.5349109990080562e-06 -6.906208654925205e-06 -1.1457815880635634e-05<br>  -9.628518272246418e-06 -4.955927105896067e-07 1.0434736346345694e-05<br>  1.6440219453934136e-05 1.5968721374821745e-05 1.2889123400643102e-05<br>  1.1216911927868436e-05 1.1492504481761681e-05 1.2118096301201176e-05]<br> [-5.281273929718326e-06 -8.628397732546353e-06 -9.906600717642167e-06<br>  -8.82240097795139e-06 -7.097933280326215e-06 -6.481015924391592e-06<br>  -7.4337569246647175e-06 -8.422991406380317e-06 -6.4886428508987174e-06<br>  -5.15616972942713e-07 6.093219753355574e-06 7.882727767031855e-06<br>  3.3901706805466976e-06 -2.6864998834139155e-06 -4.66949321427634e-06<br>  -1.9859034287542876e-06 1.4151058876511886e-06 2.202550918858406e-06<br>  7.704353694577433e-07 -9.247168692454511e-07 -2.7235563075217626e-06<br>  -6.3512934985170725e-06 -1.2180414779241005e-05 -1.7566002544523214e-05<br>  -1.8391761345760864e-05 -1.3260227927736052e-05 -5.508534945859504e-06<br>  -4.5829833905968864e-07 -4.0717526553010085e-07 -2.5897772134868567e-06<br>  -2.5535990546443525e-06 1.0136206492383898e-06 5.490453305048451e-06]<br> [-1.2860773509967321e-05 -1.548063214950035e-05 -1.606873549912992e-05<br>  -1.4694794071164697e-05 -1.2737855241117946e-05 -1.1479501979592106e-05<br>  -1.1795677185679529e-05 -1.2759761416233194e-05 -1.1276738055013554e-05<br>  -5.658942783216447e-06 5.794931334225196e-07 1.8189380695238414e-06<br>  -2.7516286840323862e-06 -7.301954489369649e-06 -6.389596438352428e-06<br>  -1.2528124236058392e-06 2.4394249504214594e-06 1.4671790314550068e-06<br>  -2.624934125034813e-06 -6.6808189515147736e-06 -9.04565888357349e-06<br>  -1.0059892515364095e-05 -1.0952735339033696e-05 -1.2761852541931315e-05<br>  -1.4743573840888943e-05 -1.4830239321111994e-05 -1.2187212035316761e-05<br>  -9.192128760834578e-06 -8.988501283138615e-06 -1.1188063876841769e-05<br>  -1.1760956018483564e-05 -7.949279955875049e-06 -2.2227860891208546e-06]<br> [-1.1251188329809233e-05 -1.1683120954663177e-05 -1.158586937683046e-05<br>  -1.0951550791238362e-05 -1.0124419563880244e-05 -9.541745351463648e-06<br>  -1.0403479890071481e-05 -1.2611345692261087e-05 -1.3164140367495413e-05<br>  -9.631548983323165e-06 -4.482051148404085e-06 -2.835467818337531e-06<br>  -5.658408179669208e-06 -8.31156800369655e-06 -6.928171281088062e-06<br>  -3.341969216476312e-06 -2.0448642709200784e-06 -4.48359267451798e-06<br>  -8.63181927904754e-06 -1.198917633175668e-05 -1.2960075326768594e-05<br>  -1.0626403544756423e-05 -6.074707687897016e-06 -2.9024314179877047e-06<br>  -3.820424264103764e-06 -7.0085997102616105e-06 -8.30515626981333e-06<br>  -6.958512835748708e-06 -6.610657693337326e-06 -9.19982554544091e-06<br>  -1.1707162625580733e-05 -1.0220136574679062e-05 -6.146943373211745e-06]<br> [-4.343197283252934e-06 -3.1194230370458217e-06 -3.0413529076764093e-06<br>  -4.031192273062995e-06 -5.506720872798486e-06 -6.889983673419138e-06<br>  -8.90993213854755e-06 -1.1829152815230301e-05 -1.3376201578765002e-05<br>  -1.139346456997427e-05 -7.473776344504365e-06 -5.616582005718578e-06<br>  -6.661729532008187e-06 -7.630190864507787e-06 -6.65880770607172e-06<br>  -5.5630798659203854e-06 -6.300279271471532e-06 -7.829428116029746e-06<br>  -8.389765854546719e-06 -8.38794127111748e-06 -8.20755047174575e-06<br>  -5.9447553515531055e-06 -4.091144367424264e-07 5.101319928790687e-06<br>  5.816878791950512e-06 1.8210241627872023e-06 -2.0687022010563684e-06<br>  -2.9948334977305727e-06 -3.410596185489009e-06 -6.0848895951672335e-06<br>  -9.397762516587286e-06 -9.785686011891038e-06 -7.730265175938422e-06]<br> [-2.489513191018441e-07 7.724490387222206e-07 7.899606936922467e-07<br>  -3.6347730426590565e-07 -2.4202815422745087e-06 -4.53313226762907e-06<br>  -6.715676983280941e-06 -8.963740833617854e-06 -9.927188686927865e-06<br>  -8.582509065962698e-06 -6.385107947540243e-06 -5.742716664016125e-06<br>  -6.305982970198707e-06 -5.895763623714225e-06 -4.504849299503345e-06<br>  -4.372290189290993e-06 -5.593963005666979e-06 -5.080520899242265e-06<br>  -1.5740836193148668e-06 1.6879886113686506e-06 1.701296450625303e-06<br>  7.797806721841027e-07 3.0537189359683787e-06 7.914890292632359e-06<br>  1.0051783090192667e-05 6.720199798418554e-06 9.889418618720182e-07<br>  -3.3109263057657415e-06 -5.90457745940591e-06 -8.451306142534555e-06<br>  -1.0708177163656453e-05 -1.0928113520141564e-05 -9.478112671343966e-06]<br> [-4.88300932211477e-07 -1.117947176892415e-06 -1.0768044109209405e-06<br>  -7.88014843230882e-07 -9.57749477777685e-07 -1.7151078215296071e-06<br>  -2.902719794600666e-06 -3.94898668782461e-06 -3.936859833364549e-06<br>  -2.9773983455946225e-06 -2.9012139517264427e-06 -4.574808897673572e-06<br>  -6.023001579606342e-06 -4.833796260472812e-06 -2.1173715618923377e-06<br>  -1.2017211865887443e-06 -2.23214220312421e-06 -1.2995531267915601e-06<br>  3.2937229265224e-06 7.570992192385656e-06 7.008453004345376e-06<br>  3.203830365741965e-06 1.9701055033459144e-06 5.2611147669811825e-06<br>  8.751272622881469e-06 7.627202964435981e-06 2.117884044759939e-06<br>  -4.123265963246895e-06 -8.609456621156764e-06 -1.1151873148613777e-05<br>  -1.2057663042511676e-05 -1.1448497496801487e-05 -1.0018716881719844e-05]<br> [1.9530216973879883e-08 -2.1766608926339697e-06 -2.8425740220798486e-06<br>  -2.1112825714000185e-06 -9.720264771101975e-07 -4.915859565629772e-07<br>  -9.494249171030636e-07 -1.4327970673335517e-06 -8.790664993062608e-07<br>  3.5588710154439705e-08 -9.516344786615596e-07 -4.4216996824667065e-06<br>  -7.230948673460642e-06 -6.095119996795751e-06 -2.228094283928184e-06<br>  6.579227103675092e-08 -6.080369298571097e-07 -9.264989579505003e-07<br>  1.8937229847971017e-06 5.30749063821442e-06 4.866314858166461e-06<br>  6.396106660530816e-07 -2.418937574694651e-06 -8.875702436164816e-07<br>  3.1344088091564335e-06 5.122253609053076e-06 3.2623371409014304e-06<br>  -7.081421615044571e-07 -4.379456318355337e-06 -6.750035974019517e-06<br>  -7.801239442825919e-06 -7.904893768037139e-06 -7.506125519488485e-06]<br> [3.4780678676176312e-06 8.4296077212868e-08 -2.074825717619751e-06<br>  -2.525270353337844e-06 -1.6589093183190748e-06 -9.571289234373592e-07<br>  -1.2712126127738436e-06 -1.7331559176611046e-06 -9.343739824491148e-07<br>  3.1889413258771066e-07 -5.562177451547342e-07 -4.745043397397628e-06<br>  -8.92532458991251e-06 -8.929409514229753e-06 -4.822359483158842e-06<br>  -1.0776113829990951e-06 -7.632220248783699e-07 -2.1837691844607853e-06<br>  -1.974445854752891e-06 -2.0132490165865978e-07 -5.831772179868616e-08<br>  -3.1656455398063478e-06 -6.890582975886665e-06 -7.591234189029194e-06<br>  -4.590773379094391e-06 -1.493065141172888e-07 3.253028028711219e-06<br>  4.725783380923731e-06 4.463058699656582e-06 2.734137705824248e-06<br>  3.929272041388181e-07 -1.6958262265856826e-06 -3.1757277748679395e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/second</td></tr></tbody></table></div></div></li><li class='xr-section-item'><input id='section-5c403f1e-cb25-4e0c-a410-0ef422db1945' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c403f1e-cb25-4e0c-a410-0ef422db1945' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-9b0a1b14-1bf9-4d4b-bc19-06aefe30e8a9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b0a1b14-1bf9-4d4b-bc19-06aefe30e8a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5bc7b2c-dde2-4b60-9c60-400303c426b8' class='xr-var-data-in' type='checkbox'><label for='data-e5bc7b2c-dde2-4b60-9c60-400303c426b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>_metpy_axis :</span></dt><dd>x,longitude</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>30.0 27.5 25.0 ... -17.5 -20.0</div><input id='attrs-3a353ca4-a016-473f-9fbe-5d86ea0e5262' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a353ca4-a016-473f-9fbe-5d86ea0e5262' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3faf1e30-a9ba-4504-bc07-b6c4d271c9e2' class='xr-var-data-in' type='checkbox'><label for='data-3faf1e30-a9ba-4504-bc07-b6c4d271c9e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_metpy_axis :</span></dt><dd>y,latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 30. ,  27.5,  25. ,  22.5,  20. ,  17.5,  15. ,  12.5,  10. ,   7.5,
         5. ,   2.5,   0. ,  -2.5,  -5. ,  -7.5, -10. , -12.5, -15. , -17.5,
       -20. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-43f6cdd2-b2f6-47d1-94c2-ea5ab99425e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-43f6cdd2-b2f6-47d1-94c2-ea5ab99425e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6daacba3-afc8-4ad1-805c-94edf9e78679' class='xr-var-data-in' type='checkbox'><label for='data-6daacba3-afc8-4ad1-805c-94edf9e78679' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>_metpy_axis :</span></dt><dd>vertical</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fb7e6f34-382a-4923-a898-6ecca1122d27' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fb7e6f34-382a-4923-a898-6ecca1122d27' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 3: 繪圖。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cmaps</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>                  
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>     
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;850-hPa vorticity, Dec. 2017&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>    
<span class="n">vorm</span> <span class="o">=</span> <span class="n">vorm</span> <span class="o">*</span> <span class="mf">10e5</span>
<span class="n">vorPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">vorm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                              <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                              <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="o">.</span><span class="n">CBR_coldhot</span><span class="p">,</span>  
                              <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                              <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                              <span class="p">)</span>
                              
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;850-hPa Vorticity, December 2017&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_statistics_calc_30_0.png" src="_images/07_statistics_calc_30_0.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>同Example 5，但計算散度 <a class="reference external" href="https://unidata.github.io/MetPy/latest/api/generated/metpy.calc.divergence.html">metpy.calc.divergence</a>。</p>
</div>
</section>
<section id="streamfunction-velocity-potential">
<h2>計算流函數(streamfunction)、速度位(velocity potential)<a class="headerlink" href="#streamfunction-velocity-potential" title="Permalink to this headline">#</a></h2>
<p>使用<code class="docutils literal notranslate"><span class="pre">windspharm</span></code>套件，範例請見<a class="reference external" href="https://ajdawson.github.io/windspharm/latest/examples/sfvp_xarray.html">官方網站</a>。</p>
<p><code class="docutils literal notranslate"><span class="pre">windspharm</span></code>也可以用來計算</p>
<ul class="simple">
<li><p>divergence</p></li>
<li><p>vorticity (relative and absolute)</p></li>
<li><p>streamfunction</p></li>
<li><p>velocity potential</p></li>
<li><p>irrotational and non-divergent components of the wind (Helmholtz decomposition)</p></li>
<li><p>vector gradient of a scalar function</p></li>
<li><p>triangular truncation of a scalar field</p></li>
<li><p>magnitude (wind speed)</p></li>
</ul>
<p>可以試著比較用<code class="docutils literal notranslate"><span class="pre">MetPy</span></code>計算渦度、散度和用<code class="docutils literal notranslate"><span class="pre">windspharm</span></code>計算有沒有什麼不同。</p>
</section>
<section id="eof">
<h2>計算經驗正交函數 (EOF)<a class="headerlink" href="#eof" title="Permalink to this headline">#</a></h2>
<p>使用<code class="docutils literal notranslate"><span class="pre">eofs</span></code>套件，範例請見<a class="reference external" href="https://ajdawson.github.io/eofs/latest/examples/xarray_examples_index.html">官方網站</a>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">eofs.xarray</span> <span class="kn">import</span> <span class="n">Eof</span>
</pre></div>
</div>
</div>
</div>
<p>用法是</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">Eof</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
</pre></div>
</div>
<p>然後<code class="docutils literal notranslate"><span class="pre">solver</span></code>會有幾個methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solver.eofs()</span></code>: 計算EOF的主模態。若給定<code class="docutils literal notranslate"><span class="pre">neofs</span></code>引數，可以得到對應的模態數量。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.pcs()</span></code>: 計算rincipal component的時間序列。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.varianceFraction()</span></code>: 計算各個模態變異度佔全部的比例，也就是各個模態能夠解釋原始DataArray的程度之比例。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.reconstructedField()</span></code>: 利用EOF模態和時間序列重建得到的變數場。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.projectField()</span></code>: 將變數投影到EOF主模態上。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="06_clim_anml.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">6. 計算氣候場及距平值</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="08_plotting_1d.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8. <code class="docutils literal notranslate"><span class="pre">xarray</span></code>繪圖 (1)：繪製1D資料</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Wayne Yuan-Huai Tsai, 國立台灣大學大氣科學系<br/>
  
      &copy; Copyright 2021-2023.<br/>
    <div class="extra_footer">
      <p>
Last updated: 2023-04-10
</p>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>