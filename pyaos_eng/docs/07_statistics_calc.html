
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7. Advanced Calculation and Stistical Methods &#8212; Python for Atmosphere and Ocean Science (PyAOS)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-HKB5C6NRJC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-HKB5C6NRJC');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-HKB5C6NRJC');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '07_statistics_calc';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. xarray繪圖 (1)：繪製1D資料" href="08_plotting_1d.html" />
    <link rel="prev" title="6. Climatology and Anomaly" href="06_clim_anml.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00_syllabus_eng.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/PyAOS_gray_logo.png" class="logo__image only-light" alt="Python for Atmosphere and Ocean Science (PyAOS) - Home"/>
    <script>document.write(`<img src="_static/PyAOS_gray_logo.png" class="logo__image only-dark" alt="Python for Atmosphere and Ocean Science (PyAOS) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_syllabus_eng.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals in xarray</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_setup.html">電腦環境設置與Python安裝</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_open_nc_files.html">2. NetCDF and GRIB Datasets I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_plotting_basics.html">3. Basic Workflow Demo: Plotting A Monthly Mean Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_xr_datetime.html">4. Conditional Control of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_da_create.html">5. Manually Create a DataArray</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals in climate analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06_clim_anml.html">6. Climatology and Anomaly</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Advanced Calculation and Stistical Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced plotting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="08_plotting_1d.html">8. <code class="docutils literal notranslate"><span class="pre">xarray</span></code>繪圖 (1)：繪製1D資料</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_plotting_2d.html">9.<code class="docutils literal notranslate"><span class="pre">xarray</span></code>繪圖 (2)：繪製2D資料</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_pandas_seaborn.html">10. <code class="docutils literal notranslate"><span class="pre">pandas</span></code>和<code class="docutils literal notranslate"><span class="pre">seaborn</span></code>: 統計圖表繪製</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="11_cdo.html">11. Climate Data Operator (CDO)</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_large_ds.html">12. 大型資料處理</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="appendix-main.html">附錄：實用氣候分析程式範例</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="A4_ireg_grid_sel.html">不規則形狀的網格選擇</a></li>
<li class="toctree-l2"><a class="reference internal" href="A3_lanczos_filter.html">Lanczos 時間序列濾波</a></li>
<li class="toctree-l2"><a class="reference internal" href="A1_mjo_phase.html">馬登－朱利安震盪 (MJO) 氣候變異分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="A6_tropical_waves.html">熱帶波動判識與分析</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos-wks-eng/docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos-wks-eng/docs/issues/new?title=Issue%20on%20page%20%2F07_statistics_calc.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/07_statistics_calc.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7. Advanced Calculation and Stistical Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regridding">Regridding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#change-coordinate-resolution">Change Coordinate Resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-mean">滑動平均 (running mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-map">相關係數地圖 (correlation map)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where"><code class="docutils literal notranslate"><span class="pre">where</span></code>條件控制</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vorticity-divergence">計算相對渦度 (vorticity)、散度 (divergence)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eof">計算經驗正交函數 (EOF)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="advanced-calculation-and-stistical-methods">
<h1>7. Advanced Calculation and Stistical Methods<a class="headerlink" href="#advanced-calculation-and-stistical-methods" title="Link to this heading">#</a></h1>
<section id="regridding">
<h2>Regridding<a class="headerlink" href="#regridding" title="Link to this heading">#</a></h2>
<p>Different datasets usually have different time and grid resolutions. Sometimes we need to use different datasets with the same resolution, so we need to regrid the <code class="docutils literal notranslate"><span class="pre">A</span></code> grid onto the <code class="docutils literal notranslate"><span class="pre">B</span></code> grid resolution. The simplest way to do this with xarray is using <code class="docutils literal notranslate"><span class="pre">xr.interp</span></code>. The default interpolation method of the <code class="docutils literal notranslate"><span class="pre">xr.interp</span></code> function is linear interpolation.</p>
<p><strong>Example 1:</strong> The horizontal resolution of GPCP rainfall data is 2.5˚, and the horizontal resolution of OLR is 1˚. Now we will regrid the OLR data to the GPCP resolution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">lats</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="n">latn</span> <span class="o">=</span>  <span class="mi">30</span>
<span class="n">lon1</span> <span class="o">=</span>  <span class="mi">79</span> 
<span class="n">lon2</span> <span class="o">=</span> <span class="mi">161</span>

<span class="n">pcp_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/gpcp_precip_1979-2019.pentad.nc&#39;</span><span class="p">)</span> 
<span class="n">pcp</span> <span class="o">=</span> <span class="n">pcp_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>
<span class="n">olr_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/olr.nc&#39;</span><span class="p">)</span>
<span class="n">olr</span> <span class="o">=</span> <span class="n">olr_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">olr</span>

<span class="n">olr_rmp</span> <span class="o">=</span> <span class="n">olr</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>   <span class="c1"># Specify the target grid info to the `interp` method. </span>
<span class="n">olr_rmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 8760, lat: 20, lon: 32)&gt; Size: 22MB
array([[[210.37125, 199.29874, 197.44077, ..., 268.05853, 268.25916,
         266.9823 ],
        [204.61313, 213.93433, 230.92719, ..., 284.24072, 282.60632,
         278.35385],
        [236.69272, 247.62692, 259.35587, ..., 294.86554, 292.45862,
         292.01804],
        ...,
        [297.27472, 302.5027 , 305.18634, ..., 193.11395, 206.42505,
         197.59212],
        [291.31464, 291.11176, 298.43726, ..., 155.4393 , 146.58469,
         162.1478 ],
        [286.89136, 290.6887 , 291.20618, ..., 171.58977, 183.45123,
         195.39035]],

       [[259.8478 , 225.8486 , 211.98647, ..., 269.50348, 269.39746,
         272.64   ],
        [276.39136, 272.1738 , 268.95856, ..., 291.94778, 289.79297,
         284.37097],
        [260.77368, 265.89886, 275.41898, ..., 301.7583 , 299.66028,
         292.9348 ],
...
        [289.9028 , 281.8377 , 285.37466, ..., 169.81645, 173.29109,
         213.98285],
        [286.0285 , 282.36426, 284.31454, ..., 111.96492, 154.03249,
         224.03793],
        [290.05353, 295.02466, 291.87067, ..., 125.69296, 153.77583,
         191.87067]],

       [[240.00652, 211.87251, 198.56546, ..., 264.23984, 258.3333 ,
         255.25803],
        [224.23218, 243.02698, 246.38681, ..., 279.6334 , 274.43097,
         277.21472],
        [234.04726, 253.98969, 263.0449 , ..., 289.64203, 291.71185,
         293.91864],
        ...,
        [286.8454 , 287.29822, 284.08643, ..., 165.07278, 165.68568,
         180.77968],
        [291.43097, 289.64923, 295.36426, ..., 178.16243, 158.17258,
         182.52911],
        [294.91678, 297.96875, 296.73392, ..., 174.35318, 157.13422,
         152.69089]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 70kB 1998-01-01 1998-01-02 ... 2021-12-31
  * lon      (lon) float32 128B 81.25 83.75 86.25 88.75 ... 153.8 156.2 158.8
  * lat      (lat) float32 80B 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 8760</li><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-03ba8c00-f737-4d32-b7ca-1860422dc00b' class='xr-array-in' type='checkbox' checked><label for='section-03ba8c00-f737-4d32-b7ca-1860422dc00b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>210.4 199.3 197.4 206.3 213.6 205.5 ... 267.5 231.1 174.4 157.1 152.7</span></div><div class='xr-array-data'><pre>array([[[210.37125, 199.29874, 197.44077, ..., 268.05853, 268.25916,
         266.9823 ],
        [204.61313, 213.93433, 230.92719, ..., 284.24072, 282.60632,
         278.35385],
        [236.69272, 247.62692, 259.35587, ..., 294.86554, 292.45862,
         292.01804],
        ...,
        [297.27472, 302.5027 , 305.18634, ..., 193.11395, 206.42505,
         197.59212],
        [291.31464, 291.11176, 298.43726, ..., 155.4393 , 146.58469,
         162.1478 ],
        [286.89136, 290.6887 , 291.20618, ..., 171.58977, 183.45123,
         195.39035]],

       [[259.8478 , 225.8486 , 211.98647, ..., 269.50348, 269.39746,
         272.64   ],
        [276.39136, 272.1738 , 268.95856, ..., 291.94778, 289.79297,
         284.37097],
        [260.77368, 265.89886, 275.41898, ..., 301.7583 , 299.66028,
         292.9348 ],
...
        [289.9028 , 281.8377 , 285.37466, ..., 169.81645, 173.29109,
         213.98285],
        [286.0285 , 282.36426, 284.31454, ..., 111.96492, 154.03249,
         224.03793],
        [290.05353, 295.02466, 291.87067, ..., 125.69296, 153.77583,
         191.87067]],

       [[240.00652, 211.87251, 198.56546, ..., 264.23984, 258.3333 ,
         255.25803],
        [224.23218, 243.02698, 246.38681, ..., 279.6334 , 274.43097,
         277.21472],
        [234.04726, 253.98969, 263.0449 , ..., 289.64203, 291.71185,
         293.91864],
        ...,
        [286.8454 , 287.29822, 284.08643, ..., 165.07278, 165.68568,
         180.77968],
        [291.43097, 289.64923, 295.36426, ..., 178.16243, 158.17258,
         182.52911],
        [294.91678, 297.96875, 296.73392, ..., 174.35318, 157.13422,
         152.69089]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-7b76b9b8-3963-42b9-8c21-e30882145894' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7b76b9b8-3963-42b9-8c21-e30882145894' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-31</div><input id='attrs-2643ac30-c0a1-4696-9938-ffb21bb3dbe4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2643ac30-c0a1-4696-9938-ffb21bb3dbe4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c489d3be-aeb5-40f2-a7d5-7dadb123d872' class='xr-var-data-in' type='checkbox'><label for='data-c489d3be-aeb5-40f2-a7d5-7dadb123d872' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-02T00:00:00.000000000&#x27;,
       &#x27;1998-01-03T00:00:00.000000000&#x27;, ..., &#x27;2021-12-29T00:00:00.000000000&#x27;,
       &#x27;2021-12-30T00:00:00.000000000&#x27;, &#x27;2021-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-1bb261e8-36e4-4001-ab86-5d67ae2af65a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1bb261e8-36e4-4001-ab86-5d67ae2af65a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d6890b3-6a8b-4485-b720-45bb50758dd6' class='xr-var-data-in' type='checkbox'><label for='data-2d6890b3-6a8b-4485-b720-45bb50758dd6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-8149655e-87d6-457b-ae1b-5bf797eac094' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8149655e-87d6-457b-ae1b-5bf797eac094' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bc5a5be-ad76-44c4-9348-aac1ab79c1f4' class='xr-var-data-in' type='checkbox'><label for='data-9bc5a5be-ad76-44c4-9348-aac1ab79c1f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-08539bd6-a14e-4056-8f0b-6e6a7f34b687' class='xr-section-summary-in' type='checkbox'  ><label for='section-08539bd6-a14e-4056-8f0b-6e6a7f34b687' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-659c272b-d2cb-4da7-862d-5ac8a9726689' class='xr-index-data-in' type='checkbox'/><label for='index-659c272b-d2cb-4da7-862d-5ac8a9726689' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-01-01&#x27;, &#x27;1998-01-02&#x27;, &#x27;1998-01-03&#x27;, &#x27;1998-01-04&#x27;,
               &#x27;1998-01-05&#x27;, &#x27;1998-01-06&#x27;, &#x27;1998-01-07&#x27;, &#x27;1998-01-08&#x27;,
               &#x27;1998-01-09&#x27;, &#x27;1998-01-10&#x27;,
               ...
               &#x27;2021-12-22&#x27;, &#x27;2021-12-23&#x27;, &#x27;2021-12-24&#x27;, &#x27;2021-12-25&#x27;,
               &#x27;2021-12-26&#x27;, &#x27;2021-12-27&#x27;, &#x27;2021-12-28&#x27;, &#x27;2021-12-29&#x27;,
               &#x27;2021-12-30&#x27;, &#x27;2021-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=8760, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6b866e52-5054-45a0-856e-58a5c7ca992d' class='xr-index-data-in' type='checkbox'/><label for='index-6b866e52-5054-45a0-856e-58a5c7ca992d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-23bac510-41a5-4038-b590-4d824f4cdef1' class='xr-index-data-in' type='checkbox'/><label for='index-23bac510-41a5-4038-b590-4d824f4cdef1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b474508d-60d6-4293-98bc-e578db29e6de' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b474508d-60d6-4293-98bc-e578db29e6de' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>However, sometimes linear interpolation is not the best way to regrid. For example, rainfall need to stay mass conservation after regridding, therefore <strong>conservative</strong> regridding is required. Here we introduce <code class="docutils literal notranslate"><span class="pre">xesmf</span></code> library to do this.</p>
<p><strong>Example 1:</strong> Regrid the GPCP data to the OLR resolution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>

<span class="c1"># Set the grid information </span>
<span class="n">grid_olr</span>  <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">olr</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">olr</span><span class="o">.</span><span class="n">lon</span><span class="p">})</span> 
<span class="n">grid_gpcp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">pcp</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">pcp</span><span class="o">.</span><span class="n">lon</span><span class="p">})</span> 
<span class="c1"># ds_in: the input grid info; </span>
<span class="c1"># ds_out: the output grid info</span>
<span class="n">regridder</span> <span class="o">=</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">ds_in</span><span class="o">=</span><span class="n">grid_gpcp</span> <span class="p">,</span> <span class="n">ds_out</span><span class="o">=</span><span class="n">grid_olr</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;conservative_normed&quot;</span><span class="p">)</span>
<span class="n">pcp_rg</span> <span class="o">=</span> <span class="n">regridder</span><span class="p">(</span><span class="n">pcp</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Set the grid information </span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">grid_olr</span>  <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">olr</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">olr</span><span class="o">.</span><span class="n">lon</span><span class="p">})</span> 

<span class="n">File</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wtsai</span><span class="o">/</span><span class="n">micromamba</span><span class="o">/</span><span class="n">p3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">xesmf</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># flake8: noqa</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">data</span><span class="p">,</span> <span class="n">util</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">.frontend</span> <span class="kn">import</span> <span class="n">Regridder</span><span class="p">,</span> <span class="n">SpatialAverager</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">try</span><span class="p">:</span>

<span class="n">File</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wtsai</span><span class="o">/</span><span class="n">micromamba</span><span class="o">/</span><span class="n">p3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">xesmf</span><span class="o">/</span><span class="n">util</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">Polygon</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">8</span>     <span class="kn">import</span> <span class="nn">esmpy</span> <span class="k">as</span> <span class="nn">ESMF</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="kn">import</span> <span class="nn">ESMF</span>

<span class="n">File</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wtsai</span><span class="o">/</span><span class="n">micromamba</span><span class="o">/</span><span class="n">p3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">esmpy</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">106</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span> <span class="n">__requires_python__</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;Requires-Python&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="c1"># these don&#39;t seem to work with setuptools pyproject.toml</span>
<span class="ne">--&gt; </span><span class="mi">106</span> <span class="n">__author__</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;Author&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="n">__homepage__</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;Home-page&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="n">__obsoletes__</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;obsoletes&quot;</span><span class="p">]</span>

<span class="nn">File /data/wtsai/micromamba/p3/lib/python3.10/site-packages/importlib_metadata/_adapters.py:54,</span> in <span class="ni">Message.__getitem__</span><span class="nt">(self, item)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span> <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">54</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="k">return</span> <span class="n">res</span>

<span class="ne">KeyError</span>: &#39;Author&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="change-coordinate-resolution">
<h2>Change Coordinate Resolution<a class="headerlink" href="#change-coordinate-resolution" title="Link to this heading">#</a></h2>
<p>時間和空間的網格解析度可以用採用 <code class="docutils literal notranslate"><span class="pre">xarray.DataArray.coarsen</span></code> 更改。</p>
<p><strong>Example 3:</strong> 將每日OLR轉換成侯(pentad)平均資料，意即將時間解析度調整為5天一次。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">olr_noleap</span> <span class="o">=</span> <span class="n">olr</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">olr</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">olr</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>
<span class="n">olr_ptd</span> <span class="o">=</span> <span class="p">(</span><span class="n">olr_noleap</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                              <span class="n">coord_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">})</span>  
                     <span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">olr_ptd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 1752, lat: 50, lon: 82)&gt;
array([[[284.27383, 285.73615, 288.25266, ..., 231.88799, 241.6569 ,
         249.84024],
        [286.65228, 288.0508 , 288.27435, ..., 215.95383, 230.82944,
         246.1481 ],
        [290.7838 , 290.2586 , 287.82904, ..., 198.27681, 214.98921,
         225.9622 ],
        ...,
        [247.29614, 246.06245, 247.9498 , ..., 279.0298 , 277.99088,
         276.57684],
        [244.55948, 242.81021, 239.57669, ..., 273.2099 , 271.63373,
         270.99365],
        [236.1903 , 229.96805, 221.43008, ..., 266.5147 , 266.81476,
         266.7093 ]],

       [[257.097  , 249.0689 , 260.7727 , ..., 251.24785, 258.4394 ,
         267.57504],
        [265.49664, 263.9062 , 270.4431 , ..., 237.29636, 248.2174 ,
         250.10226],
        [261.7508 , 266.22888, 276.74783, ..., 222.4416 , 235.64157,
         227.53247],
...
        [246.52588, 246.06046, 249.06099, ..., 256.54034, 259.21564,
         260.40427],
        [244.2377 , 247.02632, 246.57185, ..., 258.28464, 255.90445,
         257.71054],
        [237.54703, 235.23251, 224.96394, ..., 255.28891, 253.66435,
         255.53586]],

       [[286.864  , 287.83688, 290.30945, ..., 194.66502, 212.79057,
         210.36748],
        [288.31   , 288.92453, 290.12537, ..., 204.64694, 225.9674 ,
         223.37724],
        [284.80383, 288.20563, 289.7766 , ..., 215.14029, 236.13554,
         232.43852],
        ...,
        [236.44717, 236.95544, 234.64787, ..., 268.50082, 268.91937,
         267.25333],
        [235.04623, 231.87952, 229.08992, ..., 267.69647, 267.49542,
         266.0851 ],
        [233.44182, 225.93411, 211.10928, ..., 268.23108, 265.9177 ,
         264.84662]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1998-01-01 1998-01-06 ... 2021-12-27
  * lon      (lon) float32 79.5 80.5 81.5 82.5 83.5 ... 157.5 158.5 159.5 160.5
  * lat      (lat) float32 -19.5 -18.5 -17.5 -16.5 -15.5 ... 26.5 27.5 28.5 29.5
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1752</li><li><span class='xr-has-index'>lat</span>: 50</li><li><span class='xr-has-index'>lon</span>: 82</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5446e4fa-784b-4a67-83bd-3c02b35dd062' class='xr-array-in' type='checkbox' checked><label for='section-5446e4fa-784b-4a67-83bd-3c02b35dd062' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>284.3 285.7 288.3 286.6 273.7 271.3 ... 266.2 264.9 268.2 265.9 264.8</span></div><div class='xr-array-data'><pre>array([[[284.27383, 285.73615, 288.25266, ..., 231.88799, 241.6569 ,
         249.84024],
        [286.65228, 288.0508 , 288.27435, ..., 215.95383, 230.82944,
         246.1481 ],
        [290.7838 , 290.2586 , 287.82904, ..., 198.27681, 214.98921,
         225.9622 ],
        ...,
        [247.29614, 246.06245, 247.9498 , ..., 279.0298 , 277.99088,
         276.57684],
        [244.55948, 242.81021, 239.57669, ..., 273.2099 , 271.63373,
         270.99365],
        [236.1903 , 229.96805, 221.43008, ..., 266.5147 , 266.81476,
         266.7093 ]],

       [[257.097  , 249.0689 , 260.7727 , ..., 251.24785, 258.4394 ,
         267.57504],
        [265.49664, 263.9062 , 270.4431 , ..., 237.29636, 248.2174 ,
         250.10226],
        [261.7508 , 266.22888, 276.74783, ..., 222.4416 , 235.64157,
         227.53247],
...
        [246.52588, 246.06046, 249.06099, ..., 256.54034, 259.21564,
         260.40427],
        [244.2377 , 247.02632, 246.57185, ..., 258.28464, 255.90445,
         257.71054],
        [237.54703, 235.23251, 224.96394, ..., 255.28891, 253.66435,
         255.53586]],

       [[286.864  , 287.83688, 290.30945, ..., 194.66502, 212.79057,
         210.36748],
        [288.31   , 288.92453, 290.12537, ..., 204.64694, 225.9674 ,
         223.37724],
        [284.80383, 288.20563, 289.7766 , ..., 215.14029, 236.13554,
         232.43852],
        ...,
        [236.44717, 236.95544, 234.64787, ..., 268.50082, 268.91937,
         267.25333],
        [235.04623, 231.87952, 229.08992, ..., 267.69647, 267.49542,
         266.0851 ],
        [233.44182, 225.93411, 211.10928, ..., 268.23108, 265.9177 ,
         264.84662]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-7ef88a2f-f5e9-4deb-9ad9-fec86f28857c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7ef88a2f-f5e9-4deb-9ad9-fec86f28857c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-27</div><input id='attrs-57dd618f-6f2e-4db4-b44e-b9cfe54f43db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57dd618f-6f2e-4db4-b44e-b9cfe54f43db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-408144ba-5d19-4a40-8805-1c3ba7395b02' class='xr-var-data-in' type='checkbox'><label for='data-408144ba-5d19-4a40-8805-1c3ba7395b02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-06T00:00:00.000000000&#x27;,
       &#x27;1998-01-11T00:00:00.000000000&#x27;, ..., &#x27;2021-12-17T00:00:00.000000000&#x27;,
       &#x27;2021-12-22T00:00:00.000000000&#x27;, &#x27;2021-12-27T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>79.5 80.5 81.5 ... 159.5 160.5</div><input id='attrs-f9798f1f-b2c9-4f14-85af-4b66b48cbac2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9798f1f-b2c9-4f14-85af-4b66b48cbac2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5eb7cf55-e5df-4614-bc16-f50e3b3d1d0b' class='xr-var-data-in' type='checkbox'><label for='data-5eb7cf55-e5df-4614-bc16-f50e3b3d1d0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 28.5 29.5</div><input id='attrs-12c55136-3d89-40b7-8473-a789452e819c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12c55136-3d89-40b7-8473-a789452e819c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6ffd05d-f86d-4e2d-957e-b442a0a724ad' class='xr-var-data-in' type='checkbox'><label for='data-c6ffd05d-f86d-4e2d-957e-b442a0a724ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e103c257-1dca-4603-a695-e9b2dfcfc185' class='xr-section-summary-in' type='checkbox'  ><label for='section-e103c257-1dca-4603-a695-e9b2dfcfc185' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9de7aa76-4022-4dbf-85db-5b1beb3b010e' class='xr-index-data-in' type='checkbox'/><label for='index-9de7aa76-4022-4dbf-85db-5b1beb3b010e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-01-01&#x27;, &#x27;1998-01-06&#x27;, &#x27;1998-01-11&#x27;, &#x27;1998-01-16&#x27;,
               &#x27;1998-01-21&#x27;, &#x27;1998-01-26&#x27;, &#x27;1998-01-31&#x27;, &#x27;1998-02-05&#x27;,
               &#x27;1998-02-10&#x27;, &#x27;1998-02-15&#x27;,
               ...
               &#x27;2021-11-12&#x27;, &#x27;2021-11-17&#x27;, &#x27;2021-11-22&#x27;, &#x27;2021-11-27&#x27;,
               &#x27;2021-12-02&#x27;, &#x27;2021-12-07&#x27;, &#x27;2021-12-12&#x27;, &#x27;2021-12-17&#x27;,
               &#x27;2021-12-22&#x27;, &#x27;2021-12-27&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1752, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-77c4644f-2ed4-421f-8c46-2e28b04a01a3' class='xr-index-data-in' type='checkbox'/><label for='index-77c4644f-2ed4-421f-8c46-2e28b04a01a3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-29927f63-a8bc-43fd-a1c1-7bca6bb008e7' class='xr-index-data-in' type='checkbox'/><label for='index-29927f63-a8bc-43fd-a1c1-7bca6bb008e7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8a9fd096-8914-4036-836d-0d167ea7ee16' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a9fd096-8914-4036-836d-0d167ea7ee16' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>也就是在時間的維度上，5天為一個單位平均。 <code class="docutils literal notranslate"><span class="pre">coord_func</span></code> 預設為 <code class="docutils literal notranslate"><span class="pre">mean</span></code>，也就是重新取樣後的座標 (時間) 軸會選擇5天平均後的時間軸 (如1998-01-03, 1998-01-08, 1998-01-13, …)，其他選項可選 <code class="docutils literal notranslate"><span class="pre">min</span></code> 設定為最小值 (一侯的開始日) 或 <code class="docutils literal notranslate"><span class="pre">max</span></code> 最大值 (一侯的結束日)。</p>
<p><strong>Note:</strong> 雖然<code class="docutils literal notranslate"><span class="pre">xarray.DataArray.resample</span></code>看似也有同樣功能，但根據API reference，</p>
<blockquote>
<div><p>The resampled dimension must be a datetime-like coordinate.</p>
</div></blockquote>
<p>根據以上範例，就是 <code class="docutils literal notranslate"><span class="pre">olr_ptd</span> <span class="pre">=</span> <span class="pre">olr_noleap.resample(time='5D')</span></code> ，然而<code class="docutils literal notranslate"><span class="pre">datetime</span></code> 物件無法選擇日曆格式，也就是在計算五天平均時，不論原始資料 <code class="docutils literal notranslate"><span class="pre">olr_noleap</span></code> 有沒有2/29，這個方法都會納入2/29 (延伸閱讀：<a class="reference external" href="https://stackoverflow.com/questions/64476727/can-we-assign-the-calendar-of-pandas-datetimeindex-as-noleap-or-can-datetime">StackOverflow 的問答</a>)。</p>
<div class="seealso admonition">
<p class="admonition-title">Exercise</p>
<p>請利用coarsen改變空間的解析度 (i.e. 將1˚解析度的OLR資料regrid成2˚解析度)。</p>
</div>
</section>
<section id="running-mean">
<h2>滑動平均 (running mean)<a class="headerlink" href="#running-mean" title="Link to this heading">#</a></h2>
<p>可利用 <code class="docutils literal notranslate"><span class="pre">xarray.DataArray.rolling</span></code>，連續選擇3個單位，再進行平均。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">olr_3p_runave</span> <span class="o">=</span> <span class="p">(</span><span class="n">olr_ptd</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>        <span class="c1"># 選擇幾個時間單位</span>
                                 <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">olr_3p_runave</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;olr&#x27; (time: 1752, lat: 50, lon: 82)&gt;
array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
...
        [258.01865, 258.54132, 260.59457, ..., 265.62262, 266.46997,
         267.72852],
        [254.52092, 255.43341, 253.74515, ..., 262.07703, 262.12787,
         264.36252],
        [249.05486, 243.50095, 230.53357, ..., 257.8312 , 259.1329 ,
         259.55786]],

       [[285.45612, 286.57214, 287.6652 , ..., 247.677  , 257.28473,
         259.3609 ],
        [288.13184, 288.3128 , 289.0145 , ..., 255.27068, 264.8253 ,
         264.77902],
        [288.0848 , 289.45697, 289.93057, ..., 261.4938 , 269.81818,
         268.2691 ],
        ...,
        [248.90976, 249.10083, 250.33572, ..., 262.9018 , 263.4146 ,
         263.58185],
        [247.00436, 247.02068, 245.05011, ..., 261.76514, 261.24374,
         261.8905 ],
        [243.24814, 237.90851, 224.16135, ..., 258.3669 , 257.77066,
         257.97882]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1998-01-01 1998-01-06 ... 2021-12-27
  * lon      (lon) float32 79.5 80.5 81.5 82.5 83.5 ... 157.5 158.5 159.5 160.5
  * lat      (lat) float32 -19.5 -18.5 -17.5 -16.5 -15.5 ... 26.5 27.5 28.5 29.5
Attributes:
    standard_name:  toa_outgoing_longwave_flux
    long_name:      NOAA Climate Data Record of Daily Mean Upward Longwave Fl...
    units:          W m-2
    cell_methods:   time: mean area: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'olr'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1752</li><li><span class='xr-has-index'>lat</span>: 50</li><li><span class='xr-has-index'>lon</span>: 82</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e55bbcd5-59f8-4300-b452-178409fa540a' class='xr-array-in' type='checkbox' checked><label for='section-e55bbcd5-59f8-4300-b452-178409fa540a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 258.0 256.9 255.2 258.4 257.8 258.0</span></div><div class='xr-array-data'><pre>array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
...
        [258.01865, 258.54132, 260.59457, ..., 265.62262, 266.46997,
         267.72852],
        [254.52092, 255.43341, 253.74515, ..., 262.07703, 262.12787,
         264.36252],
        [249.05486, 243.50095, 230.53357, ..., 257.8312 , 259.1329 ,
         259.55786]],

       [[285.45612, 286.57214, 287.6652 , ..., 247.677  , 257.28473,
         259.3609 ],
        [288.13184, 288.3128 , 289.0145 , ..., 255.27068, 264.8253 ,
         264.77902],
        [288.0848 , 289.45697, 289.93057, ..., 261.4938 , 269.81818,
         268.2691 ],
        ...,
        [248.90976, 249.10083, 250.33572, ..., 262.9018 , 263.4146 ,
         263.58185],
        [247.00436, 247.02068, 245.05011, ..., 261.76514, 261.24374,
         261.8905 ],
        [243.24814, 237.90851, 224.16135, ..., 258.3669 , 257.77066,
         257.97882]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-e66492dd-fe62-4c9a-8769-9d633534e8db' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e66492dd-fe62-4c9a-8769-9d633534e8db' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2021-12-27</div><input id='attrs-53360053-0f66-470d-9b8d-f4dd09ab90cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-53360053-0f66-470d-9b8d-f4dd09ab90cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f434aba8-3b46-41f2-b343-d219409e2f0b' class='xr-var-data-in' type='checkbox'><label for='data-f434aba8-3b46-41f2-b343-d219409e2f0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>reference time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-06T00:00:00.000000000&#x27;,
       &#x27;1998-01-11T00:00:00.000000000&#x27;, ..., &#x27;2021-12-17T00:00:00.000000000&#x27;,
       &#x27;2021-12-22T00:00:00.000000000&#x27;, &#x27;2021-12-27T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>79.5 80.5 81.5 ... 159.5 160.5</div><input id='attrs-0bf30ae1-bd5a-4b6b-b6ca-7f42a1300c3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0bf30ae1-bd5a-4b6b-b6ca-7f42a1300c3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be883705-90f2-4211-ad0c-a70ad13d74e7' class='xr-var-data-in' type='checkbox'><label for='data-be883705-90f2-4211-ad0c-a70ad13d74e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-19.5 -18.5 -17.5 ... 28.5 29.5</div><input id='attrs-deef990b-e953-4941-b73a-eb479599c7d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-deef990b-e953-4941-b73a-eb479599c7d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12f84b05-86b2-48a3-b347-849337cfa302' class='xr-var-data-in' type='checkbox'><label for='data-12f84b05-86b2-48a3-b347-849337cfa302' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d491834d-8487-4a95-9812-fca0ae9575d7' class='xr-section-summary-in' type='checkbox'  ><label for='section-d491834d-8487-4a95-9812-fca0ae9575d7' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e13abc69-0767-4a43-ab45-e3f207bfcf62' class='xr-index-data-in' type='checkbox'/><label for='index-e13abc69-0767-4a43-ab45-e3f207bfcf62' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-01-01&#x27;, &#x27;1998-01-06&#x27;, &#x27;1998-01-11&#x27;, &#x27;1998-01-16&#x27;,
               &#x27;1998-01-21&#x27;, &#x27;1998-01-26&#x27;, &#x27;1998-01-31&#x27;, &#x27;1998-02-05&#x27;,
               &#x27;1998-02-10&#x27;, &#x27;1998-02-15&#x27;,
               ...
               &#x27;2021-11-12&#x27;, &#x27;2021-11-17&#x27;, &#x27;2021-11-22&#x27;, &#x27;2021-11-27&#x27;,
               &#x27;2021-12-02&#x27;, &#x27;2021-12-07&#x27;, &#x27;2021-12-12&#x27;, &#x27;2021-12-17&#x27;,
               &#x27;2021-12-22&#x27;, &#x27;2021-12-27&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1752, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b33232a1-8c7b-4674-8a8a-fd1a6afc7873' class='xr-index-data-in' type='checkbox'/><label for='index-b33232a1-8c7b-4674-8a8a-fd1a6afc7873' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 79.5,  80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,
        89.5,  90.5,  91.5,  92.5,  93.5,  94.5,  95.5,  96.5,  97.5,  98.5,
        99.5, 100.5, 101.5, 102.5, 103.5, 104.5, 105.5, 106.5, 107.5, 108.5,
       109.5, 110.5, 111.5, 112.5, 113.5, 114.5, 115.5, 116.5, 117.5, 118.5,
       119.5, 120.5, 121.5, 122.5, 123.5, 124.5, 125.5, 126.5, 127.5, 128.5,
       129.5, 130.5, 131.5, 132.5, 133.5, 134.5, 135.5, 136.5, 137.5, 138.5,
       139.5, 140.5, 141.5, 142.5, 143.5, 144.5, 145.5, 146.5, 147.5, 148.5,
       149.5, 150.5, 151.5, 152.5, 153.5, 154.5, 155.5, 156.5, 157.5, 158.5,
       159.5, 160.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-50ec377d-1eb4-453d-b0bc-f28ac3370cb9' class='xr-index-data-in' type='checkbox'/><label for='index-50ec377d-1eb4-453d-b0bc-f28ac3370cb9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-88170b9b-d191-44f6-a36f-ae9a05488e65' class='xr-section-summary-in' type='checkbox'  checked><label for='section-88170b9b-d191-44f6-a36f-ae9a05488e65' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>long_name :</span></dt><dd>NOAA Climate Data Record of Daily Mean Upward Longwave Flux at Top of the Atmosphere</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean area: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>由於頭尾會有缺失值NaN，可加上<code class="docutils literal notranslate"><span class="pre">dropna()</span></code>移除之。</p>
</section>
<section id="correlation-map">
<h2>相關係數地圖 (correlation map)<a class="headerlink" href="#correlation-map" title="Link to this heading">#</a></h2>
<p>給定兩個DataArray，我們就可以計算兩者之間沿著特定座標軸 (e.g. 沿著時間軸的) 的相關係數。</p>
<p><strong>Example 4:</strong> 計算NDJ <a class="reference external" href="https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php">Oceanic Niño Index (ONI)</a> 和十二月降雨的相關係數地圖。</p>
<p>Step 1: 得到GPCP十二月平均資料 (先所有選12月資料，再用<code class="docutils literal notranslate"><span class="pre">groupby</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcp_dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">12</span><span class="p">]))</span>
              <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span>
              <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
<span class="n">pcp_dec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;data&#x27; (year: 41, lat: 20, lon: 32)&gt;
array([[[1.0133333e+00, 9.1833329e-01, 7.9833335e-01, ...,
         3.6333334e+00, 2.7116668e+00, 2.5383332e+00],
        [2.0333333e-01, 4.2833331e-01, 2.5000000e-01, ...,
         2.4483333e+00, 2.3216665e+00, 1.7766665e+00],
        [5.4999996e-02, 1.3666667e-01, 1.5833335e-01, ...,
         2.2033336e+00, 1.8683332e+00, 1.2850000e+00],
        ...,
        [1.1466666e+00, 1.4949999e+00, 1.8333334e+00, ...,
         3.6483333e+00, 4.2433333e+00, 2.9916668e+00],
        [7.1833330e-01, 1.3866667e+00, 1.4466667e+00, ...,
         4.0750003e+00, 3.2466669e+00, 2.8599999e+00],
        [3.9666665e-01, 8.2333332e-01, 1.1883334e+00, ...,
         2.9016666e+00, 2.7083333e+00, 1.7416667e+00]],

       [[4.6500000e-01, 2.8333333e-01, 3.4333333e-01, ...,
         3.8716667e+00, 3.8799999e+00, 3.4633334e+00],
        [6.0833335e-01, 1.7000000e-01, 1.4666666e-01, ...,
         3.9750001e+00, 3.6300001e+00, 3.1483333e+00],
        [1.2800001e+00, 3.2166669e-01, 1.2000000e-01, ...,
         2.4466667e+00, 2.1550000e+00, 1.1616668e+00],
...
        [7.9235015e+00, 7.0794005e+00, 5.7172127e+00, ...,
         9.7668800e+00, 1.0939357e+01, 1.0846936e+01],
        [9.5492640e+00, 7.4848499e+00, 3.3095343e+00, ...,
         1.2228072e+01, 1.2528176e+01, 1.1302447e+01],
        [7.2531962e+00, 5.3915715e+00, 2.0546637e+00, ...,
         1.0486613e+01, 1.3482674e+01, 1.1387763e+01]],

       [[2.0096309e+00, 1.1509016e+00, 4.8980752e-01, ...,
         2.0202532e+00, 2.7056713e+00, 2.6676538e+00],
        [1.2896461e+00, 1.1470729e+00, 2.6983759e-01, ...,
         1.3239046e+00, 1.6525987e+00, 1.6284056e+00],
        [8.9463830e-01, 3.9747801e-01, 1.5476857e-01, ...,
         1.1533502e+00, 1.1403440e+00, 9.9328095e-01],
        ...,
        [1.2956619e+00, 6.6536534e-01, 5.8920252e-01, ...,
         4.1320643e+00, 4.3791137e+00, 4.1250496e+00],
        [1.7519032e+00, 1.2151116e+00, 9.6764684e-01, ...,
         5.1612849e+00, 5.1797566e+00, 2.8651981e+00],
        [3.1523111e+00, 2.0467207e+00, 1.0773114e+00, ...,
         3.6295269e+00, 4.3244128e+00, 2.4604805e+00]]], dtype=float32)
Coordinates:
  * lon      (lon) float32 81.25 83.75 86.25 88.75 ... 151.2 153.8 156.2 158.8
  * lat      (lat) float32 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75
  * year     (year) int64 1979 1980 1981 1982 1983 ... 2015 2016 2017 2018 2019
Attributes:
    long_name:  GPCP pentad precipitation (mm/day)
    units:      mm/day</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'data'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2765e06e-7840-4373-9165-2aa1adbae8d4' class='xr-array-in' type='checkbox' checked><label for='section-2765e06e-7840-4373-9165-2aa1adbae8d4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.013 0.9183 0.7983 0.16 0.2633 0.9183 ... 1.036 1.953 3.63 4.324 2.46</span></div><div class='xr-array-data'><pre>array([[[1.0133333e+00, 9.1833329e-01, 7.9833335e-01, ...,
         3.6333334e+00, 2.7116668e+00, 2.5383332e+00],
        [2.0333333e-01, 4.2833331e-01, 2.5000000e-01, ...,
         2.4483333e+00, 2.3216665e+00, 1.7766665e+00],
        [5.4999996e-02, 1.3666667e-01, 1.5833335e-01, ...,
         2.2033336e+00, 1.8683332e+00, 1.2850000e+00],
        ...,
        [1.1466666e+00, 1.4949999e+00, 1.8333334e+00, ...,
         3.6483333e+00, 4.2433333e+00, 2.9916668e+00],
        [7.1833330e-01, 1.3866667e+00, 1.4466667e+00, ...,
         4.0750003e+00, 3.2466669e+00, 2.8599999e+00],
        [3.9666665e-01, 8.2333332e-01, 1.1883334e+00, ...,
         2.9016666e+00, 2.7083333e+00, 1.7416667e+00]],

       [[4.6500000e-01, 2.8333333e-01, 3.4333333e-01, ...,
         3.8716667e+00, 3.8799999e+00, 3.4633334e+00],
        [6.0833335e-01, 1.7000000e-01, 1.4666666e-01, ...,
         3.9750001e+00, 3.6300001e+00, 3.1483333e+00],
        [1.2800001e+00, 3.2166669e-01, 1.2000000e-01, ...,
         2.4466667e+00, 2.1550000e+00, 1.1616668e+00],
...
        [7.9235015e+00, 7.0794005e+00, 5.7172127e+00, ...,
         9.7668800e+00, 1.0939357e+01, 1.0846936e+01],
        [9.5492640e+00, 7.4848499e+00, 3.3095343e+00, ...,
         1.2228072e+01, 1.2528176e+01, 1.1302447e+01],
        [7.2531962e+00, 5.3915715e+00, 2.0546637e+00, ...,
         1.0486613e+01, 1.3482674e+01, 1.1387763e+01]],

       [[2.0096309e+00, 1.1509016e+00, 4.8980752e-01, ...,
         2.0202532e+00, 2.7056713e+00, 2.6676538e+00],
        [1.2896461e+00, 1.1470729e+00, 2.6983759e-01, ...,
         1.3239046e+00, 1.6525987e+00, 1.6284056e+00],
        [8.9463830e-01, 3.9747801e-01, 1.5476857e-01, ...,
         1.1533502e+00, 1.1403440e+00, 9.9328095e-01],
        ...,
        [1.2956619e+00, 6.6536534e-01, 5.8920252e-01, ...,
         4.1320643e+00, 4.3791137e+00, 4.1250496e+00],
        [1.7519032e+00, 1.2151116e+00, 9.6764684e-01, ...,
         5.1612849e+00, 5.1797566e+00, 2.8651981e+00],
        [3.1523111e+00, 2.0467207e+00, 1.0773114e+00, ...,
         3.6295269e+00, 4.3244128e+00, 2.4604805e+00]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-d9006618-0ac2-4e4e-a94e-a9fc23a0610c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d9006618-0ac2-4e4e-a94e-a9fc23a0610c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-f216ec75-dae3-4ee2-a13c-3d109dd0327a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f216ec75-dae3-4ee2-a13c-3d109dd0327a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9359ea92-36b2-4dd3-b115-29c231496686' class='xr-var-data-in' type='checkbox'><label for='data-9359ea92-36b2-4dd3-b115-29c231496686' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-8ba54193-ec4b-4151-9ef3-67e11bd0baa3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8ba54193-ec4b-4151-9ef3-67e11bd0baa3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3ec5d60-ac7d-4a0e-9b61-621c72894315' class='xr-var-data-in' type='checkbox'><label for='data-a3ec5d60-ac7d-4a0e-9b61-621c72894315' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1979 1980 1981 ... 2017 2018 2019</div><input id='attrs-bad7434e-998a-46cc-9fc3-220177e4b0b5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bad7434e-998a-46cc-9fc3-220177e4b0b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4825f272-01fe-4776-8236-3b28d68e667a' class='xr-var-data-in' type='checkbox'><label for='data-4825f272-01fe-4776-8236-3b28d68e667a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-805ec5ec-b567-4b36-9df1-ecc35131f4e1' class='xr-section-summary-in' type='checkbox'  ><label for='section-805ec5ec-b567-4b36-9df1-ecc35131f4e1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5c36fa12-ed65-4f05-bfd6-f91fb3e2ed7c' class='xr-index-data-in' type='checkbox'/><label for='index-5c36fa12-ed65-4f05-bfd6-f91fb3e2ed7c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-78d5529e-43b3-45dd-a4c5-317fcb34bda1' class='xr-index-data-in' type='checkbox'/><label for='index-78d5529e-43b3-45dd-a4c5-317fcb34bda1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-eb27e006-f3b1-469d-a9da-c82011e0873f' class='xr-index-data-in' type='checkbox'/><label for='index-eb27e006-f3b1-469d-a9da-c82011e0873f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-94ff10f5-dae5-45eb-bc23-ce4a515e6dbe' class='xr-section-summary-in' type='checkbox'  checked><label for='section-94ff10f5-dae5-45eb-bc23-ce4a515e6dbe' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>GPCP pentad precipitation (mm/day)</dd><dt><span>units :</span></dt><dd>mm/day</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 2: 製造NDJ ONI index矩陣。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oni_ndj</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span> 
                       <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> 
                             <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> 
                             <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> 
                             <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                       <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
                       <span class="n">coords</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">pcp_dec</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
                       <span class="p">)</span>
<span class="n">oni_ndj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (year: 41)&gt;
array([ 0.6,  0. , -0.1,  2.2, -0.9, -1.1, -0.4,  1.2,  1.1, -1.8, -0.1,
        0.4,  1.5, -0.1,  0.1,  1.1, -1. , -0.5,  2.4, -1.6, -1.7, -0.7,
       -0.3,  1.1,  0.4,  0.7, -0.8,  0.9, -1.6, -0.7,  1.6, -1.6, -1. ,
       -0.2, -0.3,  0.7,  2.6, -0.6, -1. ,  0.8,  0.5])
Coordinates:
  * year     (year) int64 1979 1980 1981 1982 1983 ... 2015 2016 2017 2018 2019</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 41</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6ecaaac9-f6bd-4c65-8dc5-c75fd2e197f2' class='xr-array-in' type='checkbox' checked><label for='section-6ecaaac9-f6bd-4c65-8dc5-c75fd2e197f2' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.6 0.0 -0.1 2.2 -0.9 -1.1 -0.4 1.2 ... -0.3 0.7 2.6 -0.6 -1.0 0.8 0.5</span></div><div class='xr-array-data'><pre>array([ 0.6,  0. , -0.1,  2.2, -0.9, -1.1, -0.4,  1.2,  1.1, -1.8, -0.1,
        0.4,  1.5, -0.1,  0.1,  1.1, -1. , -0.5,  2.4, -1.6, -1.7, -0.7,
       -0.3,  1.1,  0.4,  0.7, -0.8,  0.9, -1.6, -0.7,  1.6, -1.6, -1. ,
       -0.2, -0.3,  0.7,  2.6, -0.6, -1. ,  0.8,  0.5])</pre></div></div></li><li class='xr-section-item'><input id='section-86ed27f2-ba53-462f-967b-f7a952144769' class='xr-section-summary-in' type='checkbox'  checked><label for='section-86ed27f2-ba53-462f-967b-f7a952144769' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1979 1980 1981 ... 2017 2018 2019</div><input id='attrs-b49f557c-1046-484f-a442-73706523480d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b49f557c-1046-484f-a442-73706523480d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-91ff8c61-9275-4e64-8eeb-70f0b5d8f05b' class='xr-var-data-in' type='checkbox'><label for='data-91ff8c61-9275-4e64-8eeb-70f0b5d8f05b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a04774c4-4790-457b-b772-42463c328899' class='xr-section-summary-in' type='checkbox'  ><label for='section-a04774c4-4790-457b-b772-42463c328899' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a3e4fc12-ad0d-4e4e-90d4-147663c251b2' class='xr-index-data-in' type='checkbox'/><label for='index-a3e4fc12-ad0d-4e4e-90d4-147663c251b2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
       1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
       2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c63d7a86-2a3f-47d6-a54c-319e6997d4f1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c63d7a86-2a3f-47d6-a54c-319e6997d4f1' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 3: 用<code class="docutils literal notranslate"><span class="pre">xr.corr</span></code>計算相關係數。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">pcp_dec</span><span class="p">,</span><span class="n">oni_ndj</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 20, lon: 32)&gt;
array([[ 3.62929452e-01,  3.42366935e-01,  1.36141385e-01,
         2.86181885e-01,  1.81635007e-01,  1.49191933e-01,
         2.91984747e-01,  4.77790062e-01,  4.72934980e-01,
         2.59950214e-01,  3.45925729e-01,  3.45836394e-01,
         2.41839289e-01,  3.26920710e-01,  3.12002374e-01,
         2.78955901e-01,  2.83943380e-01,  3.95803450e-01,
         4.20742051e-01,  4.71375054e-01,  5.46175408e-01,
         4.34086465e-01,  3.36992606e-01,  2.34458518e-01,
         3.30061209e-01,  2.83089068e-01,  6.62670164e-02,
        -6.41038383e-02, -8.02357126e-02, -1.32435603e-01,
        -6.14116577e-02, -3.57627814e-01],
       [ 3.83909987e-01,  3.03894582e-01,  2.37785616e-01,
         2.14941992e-01,  1.29919746e-01,  9.02064326e-02,
         1.65142443e-01,  2.02511225e-01,  2.68816770e-01,
         1.56273306e-01,  2.46169180e-01,  3.13843048e-01,
         3.71282366e-01,  3.76425080e-01,  3.56976452e-01,
         3.31840158e-01,  1.84695348e-01,  4.19843103e-01,
         4.71277802e-01,  4.27318315e-01,  3.51365941e-01,
         2.37002913e-01,  2.34139483e-01,  2.04142657e-01,
         1.27191143e-01, -7.16084696e-02, -1.17030947e-01,
...
        -1.63141768e-01,  2.02073967e-02,  8.64961743e-02,
        -6.46165929e-02, -1.30967877e-01, -1.11179142e-01,
        -2.19488532e-01, -3.89394397e-01, -5.41138832e-01,
        -5.55411086e-01, -4.62892783e-01, -3.87886292e-01,
        -2.86447708e-01, -1.87858258e-01, -4.88526454e-02,
        -6.03390847e-02, -5.92937090e-02, -1.09022023e-02,
        -1.62940949e-01, -1.06521328e-01, -1.63654736e-01,
        -2.66138362e-01, -3.63495740e-01, -3.56191141e-01,
        -3.43018577e-01, -4.02329768e-01],
       [ 2.18229674e-01,  1.50764053e-01,  4.34983952e-02,
        -2.31485281e-02, -1.24680834e-01, -2.82829671e-01,
        -2.27022137e-01, -1.80625263e-01, -6.68313177e-02,
        -1.22718872e-01, -7.70160205e-02, -1.92838402e-01,
        -2.63437000e-01, -4.77678670e-01, -6.13706400e-01,
        -5.25689479e-01, -3.34162312e-01, -3.46265743e-01,
        -2.73299118e-01, -3.36175549e-01, -1.75612517e-01,
        -7.18667328e-02, -2.45879382e-02,  2.50092725e-03,
        -1.46619847e-01, -7.41479082e-02, -3.23609599e-02,
        -1.90437806e-01, -2.59385838e-01, -3.08636754e-01,
        -2.93624430e-01, -3.09437350e-01]])
Coordinates:
  * lon      (lon) float32 81.25 83.75 86.25 88.75 ... 151.2 153.8 156.2 158.8
  * lat      (lat) float32 28.75 26.25 23.75 21.25 ... -13.75 -16.25 -18.75</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 20</li><li><span class='xr-has-index'>lon</span>: 32</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5dde19da-196a-4f15-999f-49839f2f5767' class='xr-array-in' type='checkbox' checked><label for='section-5dde19da-196a-4f15-999f-49839f2f5767' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.3629 0.3424 0.1361 0.2862 0.1816 ... -0.2594 -0.3086 -0.2936 -0.3094</span></div><div class='xr-array-data'><pre>array([[ 3.62929452e-01,  3.42366935e-01,  1.36141385e-01,
         2.86181885e-01,  1.81635007e-01,  1.49191933e-01,
         2.91984747e-01,  4.77790062e-01,  4.72934980e-01,
         2.59950214e-01,  3.45925729e-01,  3.45836394e-01,
         2.41839289e-01,  3.26920710e-01,  3.12002374e-01,
         2.78955901e-01,  2.83943380e-01,  3.95803450e-01,
         4.20742051e-01,  4.71375054e-01,  5.46175408e-01,
         4.34086465e-01,  3.36992606e-01,  2.34458518e-01,
         3.30061209e-01,  2.83089068e-01,  6.62670164e-02,
        -6.41038383e-02, -8.02357126e-02, -1.32435603e-01,
        -6.14116577e-02, -3.57627814e-01],
       [ 3.83909987e-01,  3.03894582e-01,  2.37785616e-01,
         2.14941992e-01,  1.29919746e-01,  9.02064326e-02,
         1.65142443e-01,  2.02511225e-01,  2.68816770e-01,
         1.56273306e-01,  2.46169180e-01,  3.13843048e-01,
         3.71282366e-01,  3.76425080e-01,  3.56976452e-01,
         3.31840158e-01,  1.84695348e-01,  4.19843103e-01,
         4.71277802e-01,  4.27318315e-01,  3.51365941e-01,
         2.37002913e-01,  2.34139483e-01,  2.04142657e-01,
         1.27191143e-01, -7.16084696e-02, -1.17030947e-01,
...
        -1.63141768e-01,  2.02073967e-02,  8.64961743e-02,
        -6.46165929e-02, -1.30967877e-01, -1.11179142e-01,
        -2.19488532e-01, -3.89394397e-01, -5.41138832e-01,
        -5.55411086e-01, -4.62892783e-01, -3.87886292e-01,
        -2.86447708e-01, -1.87858258e-01, -4.88526454e-02,
        -6.03390847e-02, -5.92937090e-02, -1.09022023e-02,
        -1.62940949e-01, -1.06521328e-01, -1.63654736e-01,
        -2.66138362e-01, -3.63495740e-01, -3.56191141e-01,
        -3.43018577e-01, -4.02329768e-01],
       [ 2.18229674e-01,  1.50764053e-01,  4.34983952e-02,
        -2.31485281e-02, -1.24680834e-01, -2.82829671e-01,
        -2.27022137e-01, -1.80625263e-01, -6.68313177e-02,
        -1.22718872e-01, -7.70160205e-02, -1.92838402e-01,
        -2.63437000e-01, -4.77678670e-01, -6.13706400e-01,
        -5.25689479e-01, -3.34162312e-01, -3.46265743e-01,
        -2.73299118e-01, -3.36175549e-01, -1.75612517e-01,
        -7.18667328e-02, -2.45879382e-02,  2.50092725e-03,
        -1.46619847e-01, -7.41479082e-02, -3.23609599e-02,
        -1.90437806e-01, -2.59385838e-01, -3.08636754e-01,
        -2.93624430e-01, -3.09437350e-01]])</pre></div></div></li><li class='xr-section-item'><input id='section-edf59cd4-dae7-494f-817f-58d037ca91e8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-edf59cd4-dae7-494f-817f-58d037ca91e8' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>81.25 83.75 86.25 ... 156.2 158.8</div><input id='attrs-1a3286e7-f1ee-44e5-9719-f681ffafd0fd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a3286e7-f1ee-44e5-9719-f681ffafd0fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4d243ff-cbf0-48a7-8904-0df9cc5f8ca2' class='xr-var-data-in' type='checkbox'><label for='data-e4d243ff-cbf0-48a7-8904-0df9cc5f8ca2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>28.75 26.25 23.75 ... -16.25 -18.75</div><input id='attrs-fc27dd6b-3d74-46b6-9660-84d739e18bf0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc27dd6b-3d74-46b6-9660-84d739e18bf0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-685bfdee-d6cd-4f39-8e9f-b49cfc39d725' class='xr-var-data-in' type='checkbox'><label for='data-685bfdee-d6cd-4f39-8e9f-b49cfc39d725' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-95e1c392-27fb-4fd0-b0d7-4c520a644885' class='xr-section-summary-in' type='checkbox'  ><label for='section-95e1c392-27fb-4fd0-b0d7-4c520a644885' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6974a0ef-81fd-433b-8672-2c8bd74fa371' class='xr-index-data-in' type='checkbox'/><label for='index-6974a0ef-81fd-433b-8672-2c8bd74fa371' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 81.25,  83.75,  86.25,  88.75,  91.25,  93.75,  96.25,  98.75, 101.25,
       103.75, 106.25, 108.75, 111.25, 113.75, 116.25, 118.75, 121.25, 123.75,
       126.25, 128.75, 131.25, 133.75, 136.25, 138.75, 141.25, 143.75, 146.25,
       148.75, 151.25, 153.75, 156.25, 158.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3b449cab-3472-447a-8113-e02525ad1a7c' class='xr-index-data-in' type='checkbox'/><label for='index-3b449cab-3472-447a-8113-e02525ad1a7c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.75,  26.25,  23.75,  21.25,  18.75,  16.25,  13.75,  11.25,   8.75,
         6.25,   3.75,   1.25,  -1.25,  -3.75,  -6.25,  -8.75, -11.25, -13.75,
       -16.25, -18.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4b960666-032f-4936-a22a-2a4e0c9706b2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4b960666-032f-4936-a22a-2a4e0c9706b2' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 4: 將計算好的結果畫出來看看。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span>   
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>  
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">proj</span><span class="p">})</span>                  

<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># 繪圖</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation map (Dec precip. and DJF ONI)&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>    <span class="c1"># 設定圖片標題，並且置於圖的左側。</span>
<span class="n">olrPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                              <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> 
                              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span>  
                              <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;neither&#39;</span><span class="p">,</span> 
                              <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                              <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>                              
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/waynetsai/micromamba/envs/p3/lib/python3.10/site-packages/shapely/predicates.py:798: RuntimeWarning: invalid value encountered in intersects
  return lib.intersects(a, b, **kwargs)
</pre></div>
</div>
<img alt="_images/ac4c27ed4bcc6934d56f50ce3edfdcfedbca2f1b73994b91edd426091ea3ca5d.png" src="_images/ac4c27ed4bcc6934d56f50ce3edfdcfedbca2f1b73994b91edd426091ea3ca5d.png" />
</div>
</div>
</section>
<section id="where">
<h2><code class="docutils literal notranslate"><span class="pre">where</span></code>條件控制<a class="headerlink" href="#where" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code>是一個很好用的方法，可以針對資料設定條件進行篩選和過濾。我們直接看以下例子：</p>
<p><strong>Example 4:</strong> 繪製2021年12月平均之Mean Sea Level Pressure，但海拔3000公尺以上的區域不畫。</p>
<p>Step 1: 讀MSLP、地形資料。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span><span class="o">=</span><span class="mi">0</span>
<span class="n">latn</span><span class="o">=</span><span class="mi">60</span>

<span class="n">topo_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/etopo5.nc&#39;</span><span class="p">)</span>
<span class="n">mslp_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/mslp.2021.nc&#39;</span><span class="p">)</span>
<span class="n">topo</span> <span class="o">=</span> <span class="n">topo_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">),</span>
                   <span class="n">X</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">bath</span>
<span class="n">mslp</span> <span class="o">=</span> <span class="n">mslp_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2021-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">),</span>
                   <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
                   <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">mslp</span>
<span class="n">mslp</span> <span class="o">=</span> <span class="n">mslp</span><span class="o">/</span><span class="mf">100.</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code>的原理是搜尋兩者相對應的網格是否滿足給定的控制條件 （以這個範例來說是搜尋topo &gt;= 3000的網格點），但兩者網格解析度不同時，沒有辦法比較。因此必須先進行網格內插，讓<code class="docutils literal notranslate"><span class="pre">topo</span></code>和<code class="docutils literal notranslate"><span class="pre">mslp</span></code>的解析度相同。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topo_rmp</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">mslp</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">mslp</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>接著用<code class="docutils literal notranslate"><span class="pre">where</span></code>設定條件：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mslp_mask</span> <span class="o">=</span> <span class="n">mslp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">topo_rmp</span><span class="o">&lt;=</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">mslp_mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;mslp&#x27; (time: 31, lat: 25, lon: 33)&gt;
array([[[1013.425, 1015.375, 1017.25 , ..., 1015.8  , 1015.5  ,
         1015.45 ],
        [1019.35 , 1020.625, 1021.65 , ..., 1009.975, 1012.825,
         1015.25 ],
        [1023.575, 1024.4  , 1025.175, ..., 1008.025, 1013.475,
         1017.35 ],
        ...,
        [1010.3  , 1009.675, 1008.85 , ..., 1006.8  , 1007.1  ,
         1007.05 ],
        [1010.15 , 1009.875, 1009.05 , ..., 1006.775, 1007.25 ,
         1007.125],
        [1010.075, 1009.9  , 1009.175, ..., 1007.15 , 1007.35 ,
         1007.275]],

       [[1003.85 , 1006.025, 1008.05 , ...,  983.225,  983.4  ,
          984.375],
        [1010.625, 1012.975, 1015.025, ...,  974.25 ,  978.325,
          981.95 ],
        [1015.5  , 1017.675, 1019.55 , ...,  976.95 ,  981.475,
          985.325],
...
        [1011.025, 1010.875, 1010.8  , ..., 1008.775, 1008.8  ,
         1008.825],
        [1010.625, 1010.525, 1010.65 , ..., 1009.075, 1008.9  ,
         1008.65 ],
        [1011.025, 1010.85 , 1010.825, ..., 1008.475, 1008.325,
         1008.75 ]],

       [[1024.175, 1025.275, 1026.675, ..., 1019.775, 1019.725,
         1019.45 ],
        [1029.125, 1029.8  , 1030.6  , ..., 1006.275, 1007.75 ,
         1010.   ],
        [1034.4  , 1034.875, 1035.45 , ...,  995.475,  997.3  ,
         1000.925],
        ...,
        [1011.825, 1011.275, 1010.975, ..., 1009.225, 1009.4  ,
         1009.475],
        [1011.55 , 1011.   , 1010.475, ..., 1008.975, 1009.125,
         1008.975],
        [1011.575, 1011.275, 1010.925, ..., 1008.9  , 1009.2  ,
         1009.025]]], dtype=float32)
Coordinates:
  * lat      (lat) float32 60.0 57.5 55.0 52.5 50.0 ... 10.0 7.5 5.0 2.5 0.0
  * lon      (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
  * time     (time) datetime64[ns] 2021-12-01 2021-12-02 ... 2021-12-31
    X        (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
    Y        (lat) float32 60.0 57.5 55.0 52.5 50.0 ... 10.0 7.5 5.0 2.5 0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'mslp'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 31</li><li><span class='xr-has-index'>lat</span>: 25</li><li><span class='xr-has-index'>lon</span>: 33</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-fcc6cc91-7182-4526-9fba-01b4ad82ac53' class='xr-array-in' type='checkbox' checked><label for='section-fcc6cc91-7182-4526-9fba-01b4ad82ac53' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.013e+03 1.015e+03 1.017e+03 ... 1.009e+03 1.009e+03 1.009e+03</span></div><div class='xr-array-data'><pre>array([[[1013.425, 1015.375, 1017.25 , ..., 1015.8  , 1015.5  ,
         1015.45 ],
        [1019.35 , 1020.625, 1021.65 , ..., 1009.975, 1012.825,
         1015.25 ],
        [1023.575, 1024.4  , 1025.175, ..., 1008.025, 1013.475,
         1017.35 ],
        ...,
        [1010.3  , 1009.675, 1008.85 , ..., 1006.8  , 1007.1  ,
         1007.05 ],
        [1010.15 , 1009.875, 1009.05 , ..., 1006.775, 1007.25 ,
         1007.125],
        [1010.075, 1009.9  , 1009.175, ..., 1007.15 , 1007.35 ,
         1007.275]],

       [[1003.85 , 1006.025, 1008.05 , ...,  983.225,  983.4  ,
          984.375],
        [1010.625, 1012.975, 1015.025, ...,  974.25 ,  978.325,
          981.95 ],
        [1015.5  , 1017.675, 1019.55 , ...,  976.95 ,  981.475,
          985.325],
...
        [1011.025, 1010.875, 1010.8  , ..., 1008.775, 1008.8  ,
         1008.825],
        [1010.625, 1010.525, 1010.65 , ..., 1009.075, 1008.9  ,
         1008.65 ],
        [1011.025, 1010.85 , 1010.825, ..., 1008.475, 1008.325,
         1008.75 ]],

       [[1024.175, 1025.275, 1026.675, ..., 1019.775, 1019.725,
         1019.45 ],
        [1029.125, 1029.8  , 1030.6  , ..., 1006.275, 1007.75 ,
         1010.   ],
        [1034.4  , 1034.875, 1035.45 , ...,  995.475,  997.3  ,
         1000.925],
        ...,
        [1011.825, 1011.275, 1010.975, ..., 1009.225, 1009.4  ,
         1009.475],
        [1011.55 , 1011.   , 1010.475, ..., 1008.975, 1009.125,
         1008.975],
        [1011.575, 1011.275, 1010.925, ..., 1008.9  , 1009.2  ,
         1009.025]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-1d891cdc-cf07-4add-a546-a772b746ab13' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1d891cdc-cf07-4add-a546-a772b746ab13' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>60.0 57.5 55.0 52.5 ... 5.0 2.5 0.0</div><input id='attrs-1eb330e5-78d2-4b50-be90-716eba8c6579' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1eb330e5-78d2-4b50-be90-716eba8c6579' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcb77e6b-6f3b-43df-99b8-3060d5a542b0' class='xr-var-data-in' type='checkbox'><label for='data-bcb77e6b-6f3b-43df-99b8-3060d5a542b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[ 90. -90.]</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([60. , 57.5, 55. , 52.5, 50. , 47.5, 45. , 42.5, 40. , 37.5, 35. , 32.5,
       30. , 27.5, 25. , 22.5, 20. , 17.5, 15. , 12.5, 10. ,  7.5,  5. ,  2.5,
        0. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-8aaaf971-482d-488c-b002-ad6cfc8557c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8aaaf971-482d-488c-b002-ad6cfc8557c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-755c07f5-4bba-4783-baae-beaca8b06e92' class='xr-var-data-in' type='checkbox'><label for='data-755c07f5-4bba-4783-baae-beaca8b06e92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.  357.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-12-01 ... 2021-12-31</div><input id='attrs-8682ef9a-487d-490a-99ec-0e31ea74af3e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8682ef9a-487d-490a-99ec-0e31ea74af3e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f461eef9-a618-4c5a-97c3-d915f01d4b6c' class='xr-var-data-in' type='checkbox'><label for='data-f461eef9-a618-4c5a-97c3-d915f01d4b6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>avg_period :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>actual_range :</span></dt><dd>[1937256. 1945992.]</dd><dt><span>coordinate_defines :</span></dt><dd>start</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-12-01T00:00:00.000000000&#x27;, &#x27;2021-12-02T00:00:00.000000000&#x27;,
       &#x27;2021-12-03T00:00:00.000000000&#x27;, &#x27;2021-12-04T00:00:00.000000000&#x27;,
       &#x27;2021-12-05T00:00:00.000000000&#x27;, &#x27;2021-12-06T00:00:00.000000000&#x27;,
       &#x27;2021-12-07T00:00:00.000000000&#x27;, &#x27;2021-12-08T00:00:00.000000000&#x27;,
       &#x27;2021-12-09T00:00:00.000000000&#x27;, &#x27;2021-12-10T00:00:00.000000000&#x27;,
       &#x27;2021-12-11T00:00:00.000000000&#x27;, &#x27;2021-12-12T00:00:00.000000000&#x27;,
       &#x27;2021-12-13T00:00:00.000000000&#x27;, &#x27;2021-12-14T00:00:00.000000000&#x27;,
       &#x27;2021-12-15T00:00:00.000000000&#x27;, &#x27;2021-12-16T00:00:00.000000000&#x27;,
       &#x27;2021-12-17T00:00:00.000000000&#x27;, &#x27;2021-12-18T00:00:00.000000000&#x27;,
       &#x27;2021-12-19T00:00:00.000000000&#x27;, &#x27;2021-12-20T00:00:00.000000000&#x27;,
       &#x27;2021-12-21T00:00:00.000000000&#x27;, &#x27;2021-12-22T00:00:00.000000000&#x27;,
       &#x27;2021-12-23T00:00:00.000000000&#x27;, &#x27;2021-12-24T00:00:00.000000000&#x27;,
       &#x27;2021-12-25T00:00:00.000000000&#x27;, &#x27;2021-12-26T00:00:00.000000000&#x27;,
       &#x27;2021-12-27T00:00:00.000000000&#x27;, &#x27;2021-12-28T00:00:00.000000000&#x27;,
       &#x27;2021-12-29T00:00:00.000000000&#x27;, &#x27;2021-12-30T00:00:00.000000000&#x27;,
       &#x27;2021-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>X</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-e92398d3-f6ce-49b0-8247-4ec332491db3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e92398d3-f6ce-49b0-8247-4ec332491db3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45bb369b-af17-4da6-8403-4f5ab267a6bf' class='xr-var-data-in' type='checkbox'><label for='data-45bb369b-af17-4da6-8403-4f5ab267a6bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>actual_range :</span></dt><dd>[  0.  357.5]</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Y</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>60.0 57.5 55.0 52.5 ... 5.0 2.5 0.0</div><input id='attrs-72c3d0e5-f5ea-4ccb-9432-e77f421ba7e8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-72c3d0e5-f5ea-4ccb-9432-e77f421ba7e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b51bb3fa-25b5-4cdf-b3b4-761d45981c16' class='xr-var-data-in' type='checkbox'><label for='data-b51bb3fa-25b5-4cdf-b3b4-761d45981c16' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[ 90. -90.]</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array([60. , 57.5, 55. , 52.5, 50. , 47.5, 45. , 42.5, 40. , 37.5, 35. , 32.5,
       30. , 27.5, 25. , 22.5, 20. , 17.5, 15. , 12.5, 10. ,  7.5,  5. ,  2.5,
        0. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b3d004a6-40d2-4f0d-bc75-0b9d415abea7' class='xr-section-summary-in' type='checkbox'  ><label for='section-b3d004a6-40d2-4f0d-bc75-0b9d415abea7' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-efec187b-a24d-4404-9fbe-d0fd503ceb9d' class='xr-index-data-in' type='checkbox'/><label for='index-efec187b-a24d-4404-9fbe-d0fd503ceb9d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.0, 57.5, 55.0, 52.5, 50.0, 47.5, 45.0, 42.5, 40.0, 37.5, 35.0, 32.5,
       30.0, 27.5, 25.0, 22.5, 20.0, 17.5, 15.0, 12.5, 10.0,  7.5,  5.0,  2.5,
        0.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4b12a0d3-3ee2-4e1e-a4f6-3ec780caa8aa' class='xr-index-data-in' type='checkbox'/><label for='index-4b12a0d3-3ee2-4e1e-a4f6-3ec780caa8aa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 80.0,  82.5,  85.0,  87.5,  90.0,  92.5,  95.0,  97.5, 100.0, 102.5,
       105.0, 107.5, 110.0, 112.5, 115.0, 117.5, 120.0, 122.5, 125.0, 127.5,
       130.0, 132.5, 135.0, 137.5, 140.0, 142.5, 145.0, 147.5, 150.0, 152.5,
       155.0, 157.5, 160.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-379fa40a-0a5b-498a-ad58-d3e128e0d7b5' class='xr-index-data-in' type='checkbox'/><label for='index-379fa40a-0a5b-498a-ad58-d3e128e0d7b5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2021-12-01&#x27;, &#x27;2021-12-02&#x27;, &#x27;2021-12-03&#x27;, &#x27;2021-12-04&#x27;,
               &#x27;2021-12-05&#x27;, &#x27;2021-12-06&#x27;, &#x27;2021-12-07&#x27;, &#x27;2021-12-08&#x27;,
               &#x27;2021-12-09&#x27;, &#x27;2021-12-10&#x27;, &#x27;2021-12-11&#x27;, &#x27;2021-12-12&#x27;,
               &#x27;2021-12-13&#x27;, &#x27;2021-12-14&#x27;, &#x27;2021-12-15&#x27;, &#x27;2021-12-16&#x27;,
               &#x27;2021-12-17&#x27;, &#x27;2021-12-18&#x27;, &#x27;2021-12-19&#x27;, &#x27;2021-12-20&#x27;,
               &#x27;2021-12-21&#x27;, &#x27;2021-12-22&#x27;, &#x27;2021-12-23&#x27;, &#x27;2021-12-24&#x27;,
               &#x27;2021-12-25&#x27;, &#x27;2021-12-26&#x27;, &#x27;2021-12-27&#x27;, &#x27;2021-12-28&#x27;,
               &#x27;2021-12-29&#x27;, &#x27;2021-12-30&#x27;, &#x27;2021-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-755a55f8-dbe9-46dc-9416-0f67b2433441' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-755a55f8-dbe9-46dc-9416-0f67b2433441' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>我們設定的條件就是<code class="docutils literal notranslate"><span class="pre">topo&lt;=3000</span></code>，不滿足的會直接被設定為缺失值。也可以在<code class="docutils literal notranslate"><span class="pre">where</span></code>的引數<code class="docutils literal notranslate"><span class="pre">other</span></code>中，設定當不滿足條件時要代入的值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>  
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">proj</span><span class="p">})</span>     

<span class="c1"># 繪圖</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MSLP, Dec. 2021&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>    <span class="c1"># 設定圖片標題，並且置於圖的左側。</span>
<span class="n">olrPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">mslp_mask</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                                   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                                   <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">986</span><span class="p">,</span><span class="mi">1048</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> 
                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>  
                                   <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                                   <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                                   <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>                      
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/waynetsai/micromamba/envs/p3/lib/python3.10/site-packages/shapely/predicates.py:798: RuntimeWarning: invalid value encountered in intersects
  return lib.intersects(a, b, **kwargs)
</pre></div>
</div>
<img alt="_images/a637a8201f9dc5cfaba7dbc506a96a5259089019455e52ac3dbd25869015ade3.png" src="_images/a637a8201f9dc5cfaba7dbc506a96a5259089019455e52ac3dbd25869015ade3.png" />
</div>
</div>
</section>
<section id="vorticity-divergence">
<h2>計算相對渦度 (vorticity)、散度 (divergence)<a class="headerlink" href="#vorticity-divergence" title="Link to this heading">#</a></h2>
<p>以上的計算都只是一些基本的統計，利用xarray的函數就可以辦到。但如果想要計算一些氣象的函數應該怎麼辦呢？我們可以使用MetPy，目前MetPy對xarray有完整的支援，可以直接將DataArray讀入MetPy的函數中。接下來我們以計算相對渦度為例，渦度和散度是氣象上常用來衡量風的旋轉量和輻合散的方法，<a class="reference external" href="https://unidata.github.io/MetPy/latest/api/generated/metpy.calc.vorticity.html">metpy.calc.vorticity</a> 可以用來計算渦度。</p>
<p><strong>Example 5:</strong> 計算2017年12月平均之850-hPa 相對渦度。</p>
<p>Step 1: 讀風場資料、選擇時空範圍。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latn</span> <span class="o">=</span> <span class="mi">30</span> 
<span class="n">lats</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>

<span class="n">uds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/ncep_r2_uv850/u850.2017.nc&#39;</span><span class="p">)</span>
<span class="n">vds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/ncep_r2_uv850/v850.2017.nc&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">uds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-12-31&#39;</span><span class="p">),</span> 
            <span class="n">level</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
            <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">uwnd</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-12-31&#39;</span><span class="p">),</span> 
            <span class="n">level</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latn</span><span class="p">,</span><span class="n">lats</span><span class="p">),</span>
            <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">vwnd</span>
</pre></div>
</div>
</div>
</div>
<p>Step 2: 利用MetPy計算渦度。</p>
<p>在計算前，應檢查u, v是不是有單位 m/s，如果沒有的話，必須先利用MetPy加上單位才能進行渦度計算。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>
<span class="n">vor</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vorticity</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">),</span> <span class="n">v</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">))</span>
<span class="n">vorm</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">vorm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 21, lon: 33)&gt;
&lt;Quantity([[ 2.27227035e-06 -6.35822645e-06 -1.46749070e-05 -2.08053115e-05
  -2.30204190e-05 -2.14179636e-05 -1.73882539e-05 -1.29046760e-05
  -9.84929500e-06 -9.54206099e-06 -1.12507049e-05 -1.23807539e-05
  -1.01248504e-05 -4.97617877e-06 -9.28601335e-07 -2.13257232e-06
  -8.04519296e-06 -1.36745794e-05 -1.37081362e-05 -8.49913312e-06
  -2.77764758e-06 -1.18851542e-06 -3.59719131e-06 -6.00788240e-06
  -5.68558831e-06 -3.57765352e-06 -2.98596786e-06 -5.61280440e-06
  -9.78352706e-06 -1.28709753e-05 -1.36409031e-05 -1.30405734e-05
  -1.21284570e-05]
 [ 1.59641488e-06  1.27951490e-07 -2.96147587e-06 -6.09627077e-06
  -7.14075885e-06 -6.30349598e-06 -5.16875042e-06 -4.56615673e-06
  -4.01070010e-06 -3.29133037e-06 -3.14996178e-06 -4.03313727e-06
  -5.06772766e-06 -5.30085544e-06 -5.33611754e-06 -7.06711890e-06
  -1.08910896e-05 -1.43131536e-05 -1.42338578e-05 -1.03047389e-05
  -5.71612173e-06 -3.96175474e-06 -5.53658936e-06 -7.88921794e-06
  -8.64479278e-06 -8.03751306e-06 -8.04710263e-06 -9.82336098e-06
  -1.24495122e-05 -1.41660453e-05 -1.44190610e-05 -1.42504704e-05
  -1.44654921e-05]
 [-2.25853323e-06  1.13172266e-06  2.50715062e-06  3.24109081e-06
   4.54796451e-06  5.22032636e-06  3.42384104e-06  8.61968466e-08
...
  -8.52059086e-06 -1.10716107e-05 -1.19881288e-05 -1.13950856e-05
  -9.98141214e-06]
 [ 3.40814844e-07 -1.87193747e-06 -2.55199434e-06 -1.83217317e-06
  -7.07930811e-07 -2.45485863e-07 -7.17219789e-07 -1.21135839e-06
  -6.77305687e-07  1.98063110e-07 -8.42058040e-07 -4.36596747e-06
  -7.21982209e-06 -6.11138032e-06 -2.24744337e-06  6.50249030e-08
  -5.85517420e-07 -8.93727851e-07  1.92617077e-06  5.34523983e-06
   4.91827661e-06  6.98802749e-07 -2.36916696e-06 -8.49899076e-07
   3.18171194e-06  5.20927594e-06  3.40469449e-06 -5.15668196e-07
  -4.15454945e-06 -6.51466556e-06 -7.57468620e-06 -7.70031620e-06
  -7.32678885e-06]
 [ 3.86059996e-06  4.83366406e-07 -1.67842807e-06 -2.14714011e-06
  -1.31075583e-06 -6.41593796e-07 -9.82999754e-07 -1.46979384e-06
  -7.01365099e-07  5.12796672e-07 -4.05116393e-07 -4.63963087e-06
  -8.87224706e-06 -8.92474419e-06 -4.83957896e-06 -1.08197146e-06
  -7.43141058e-07 -2.15767543e-06 -1.95926642e-06 -1.83126193e-07
  -9.75771821e-09 -3.08505634e-06 -6.80966442e-06 -7.53604087e-06
  -4.54671714e-06 -6.88500940e-08  3.41230334e-06  4.97175514e-06
   4.77222735e-06  3.07068630e-06  7.25767405e-07 -1.38476001e-06
  -2.89335635e-06]], &#x27;1 / second&#x27;)&gt;
Coordinates:
  * lon      (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
  * lat      (lat) float32 30.0 27.5 25.0 22.5 20.0 ... -12.5 -15.0 -17.5 -20.0
    level    float32 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 21</li><li><span class='xr-has-index'>lon</span>: 33</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5d1a08b5-f705-4f53-a5b7-7f501d4d40ae' class='xr-array-in' type='checkbox' checked><label for='section-5d1a08b5-f705-4f53-a5b7-7f501d4d40ae' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>&lt;Quantity([[ 2.27227035e-06 -6.35822645e-06 -1.46749070e-05 -2.0805...</span></div><div class='xr-array-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[2.2722703461187007e-06 -6.358226452586636e-06 -1.4674907009428994e-05<br>  -2.080531145111759e-05 -2.3020418995001485e-05 -2.1417963591096124e-05<br>  -1.7388253902920417e-05 -1.2904676013381433e-05 -9.849294999168519e-06<br>  -9.542060990556455e-06 -1.1250704927181363e-05 -1.2380753919162373e-05<br>  -1.0124850438216734e-05 -4.976178766587057e-06 -9.286013353159017e-07<br>  -2.132572324743622e-06 -8.045192957595025e-06 -1.3674579408708126e-05<br>  -1.3708136200666585e-05 -8.499133117521014e-06 -2.7776475803707053e-06<br>  -1.1885154179402646e-06 -3.5971913116342015e-06 -6.007882399744302e-06<br>  -5.685588307426723e-06 -3.5776535168221907e-06 -2.985967855080586e-06<br>  -5.612804403277315e-06 -9.78352705973712e-06 -1.2870975335799364e-05<br>  -1.3640903071492601e-05 -1.3040573425958505e-05 -1.2128456972468793e-05]<br> [1.596414882945071e-06 1.2795149049005645e-07 -2.9614758686475784e-06<br>  -6.096270767710856e-06 -7.140758846276769e-06 -6.303495983924571e-06<br>  -5.168750423520519e-06 -4.566156734464828e-06 -4.010700100883968e-06<br>  -3.2913303685778783e-06 -3.1499617791576115e-06 -4.0331372650934594e-06<br>  -5.067727664220179e-06 -5.300855439481811e-06 -5.336117537160412e-06<br>  -7.06711889623673e-06 -1.0891089605673275e-05 -1.4313153571815478e-05<br>  -1.4233857827145078e-05 -1.0304738886989389e-05 -5.716121728920912e-06<br>  -3.961754739751795e-06 -5.536589364660747e-06 -7.889217935776608e-06<br>  -8.644792776505274e-06 -8.037513056362988e-06 -8.047102629882055e-06<br>  -9.823360975330714e-06 -1.2449512171764136e-05 -1.4166045262144323e-05<br>  -1.4419061044965475e-05 -1.4250470379271057e-05 -1.4465492097990906e-05]<br> [-2.2585332302136e-06 1.1317226573650863e-06 2.5071506197278965e-06<br>  3.2410908082727475e-06 4.547964505465633e-06 5.220326364224136e-06<br>  3.4238410425914625e-06 8.619684660881651e-08 -1.5362344870121402e-06<br>  6.12410653532341e-08 2.3857829035785163e-06 1.8025570148941924e-06<br>  -2.408797201062852e-06 -7.588407985078474e-06 -1.1050822063474414e-05<br>  -1.2495714147835894e-05 -1.3159765226179001e-05 -1.3636408977144576e-05<br>  -1.320943335786569e-05 -1.1224003192111219e-05 -8.580318292679229e-06<br>  -6.783361911417595e-06 -6.725515333179122e-06 -7.861824883793195e-06<br>  -9.173395934001234e-06 -1.0216649681335902e-05 -1.1261541817405911e-05<br>  -1.2425317228107825e-05 -1.3319313121547483e-05 -1.3542357250621313e-05<br>  -1.3405909602289175e-05 -1.3894011704292113e-05 -1.5307631297820786e-05]<br> [-9.803539673609103e-06 -5.641600095844945e-06 -2.0242352166001024e-06<br>  2.1597759352246824e-06 6.387980090496668e-06 7.883686804927709e-06<br>  4.566556238376104e-06 -1.3527274202672697e-06 -4.9487273327695584e-06<br>  -4.118350479092369e-06 -1.7512197290729788e-06 -1.98783544561876e-06<br>  -5.731424380629395e-06 -1.0295558141344558e-05 -1.2667966229518815e-05<br>  -1.2302640779569727e-05 -1.0778115991883639e-05 -9.704105111738587e-06<br>  -9.510840428783196e-06 -9.668186163239688e-06 -9.29667825251532e-06<br>  -8.091236801724279e-06 -6.681898683154606e-06 -6.103402460993393e-06<br>  -6.948942240587295e-06 -8.970189753025635e-06 -1.1154438396463644e-05<br>  -1.2497119707802418e-05 -1.2767432193559544e-05 -1.2362014687202878e-05<br>  -1.2138438430058508e-05 -1.2761686286173847e-05 -1.4084307286746625e-05]<br> [-1.4878665922178312e-05 -1.2157301291851449e-05 -8.605763884392467e-06<br>  -3.7062457205008603e-06 1.1042715959662451e-06 2.8076731100878914e-06<br>  -9.001169937421862e-08 -5.334462328483613e-06 -9.195028368260541e-06<br>  -1.0575141048304983e-05 -1.1039754631257844e-05 -1.1558864166590024e-05<br>  -1.1172941853029464e-05 -9.08520550254593e-06 -6.260605291801828e-06<br>  -4.351353693592642e-06 -3.763831848203712e-06 -3.820305606162836e-06<br>  -4.233903946702487e-06 -5.140667573590637e-06 -6.235319763877219e-06<br>  -6.62520547729044e-06 -5.880661368348814e-06 -5.024715482765596e-06<br>  -5.360886217110399e-06 -7.262432506759373e-06 -9.732212370247838e-06<br>  -1.147884107180633e-05 -1.205600350047008e-05 -1.2010528675482112e-05<br>  -1.2004554812922694e-05 -1.2229567702647457e-05 -1.2492414735817763e-05]<br> [-1.2293906167230888e-05 -9.847937040146753e-06 -6.89322184014568e-06<br>  -4.046079193938322e-06 -2.1752084300842347e-06 -2.2698790381632754e-06<br>  -3.8312439331968884e-06 -5.345203768423907e-06 -6.816084543829679e-06<br>  -1.0158356632609815e-05 -1.5265326070087967e-05 -1.7885007049394708e-05<br>  -1.3774222434872657e-05 -4.742149564555888e-06 2.557020836884123e-06<br>  3.7488091180152515e-06 1.0708845798748566e-06 -7.588866218903557e-07<br>  -1.9647026348261869e-07 4.947678091528283e-07 -6.88603669308725e-07<br>  -3.0942965858553647e-06 -4.876297405478015e-06 -5.339234968359036e-06<br>  -5.393338575529001e-06 -5.977474565739893e-06 -7.080751184441889e-06<br>  -8.051964651143461e-06 -8.53514714016464e-06 -8.790060241587303e-06<br>  -9.034885785672135e-06 -9.078097700066231e-06 -8.731315181806528e-06]<br> [-4.4936004909221295e-06 -1.0887409523800247e-06 1.1978813075604286e-06<br>  7.304827021471752e-07 -2.0540938250353894e-06 -5.384204230761317e-06<br>  -6.1338284835337524e-06 -3.3464130871450023e-06 -1.009611645402032e-06<br>  -4.488100924619673e-06 -1.288219066361776e-05 -1.7689643132326362e-05<br>  -1.230090290401513e-05 -5.232352070323309e-07 7.307730221314349e-06<br>  6.2442351091855e-06 1.3380503304912715e-06 8.6856320640871e-08<br>  3.644065104954375e-06 7.05453836233722e-06 6.331906347217197e-06<br>  2.1339754250805955e-06 -2.1820833322753504e-06 -4.483308661627662e-06<br>  -4.907103202436195e-06 -4.468020730064026e-06 -3.9334425612214026e-06<br>  -3.4268390896928795e-06 -2.937879560664128e-06 -2.594298999449753e-06<br>  -2.66362394750033e-06 -2.8202548039028037e-06 -2.779029713804301e-06]<br> [1.4187646116838143e-06 4.683296743222577e-06 5.947185012751677e-06<br>  3.350964781557844e-06 -2.1106844806169318e-06 -7.33217432122669e-06<br>  -8.187348823292325e-06 -3.754715862796229e-06 5.8902775347539e-07<br>  -1.7040152492728908e-06 -9.430334685745812e-06 -1.3250039420085552e-05<br>  -6.8866681930734e-06 4.356100861940224e-06 1.0000354108241386e-05<br>  7.118689232001053e-06 2.7933212503733118e-06 4.282561955055889e-06<br>  1.0506298268309847e-05 1.5007756858779414e-05 1.4125414893408782e-05<br>  9.417728985749617e-06 4.403110344725791e-06 9.985621539119198e-07<br>  -8.040118193940807e-07 -1.5394651142048654e-06 -1.6092475528087912e-06<br>  -1.0770461245850296e-06 2.2368088459660065e-08 1.1325744686975034e-06<br>  1.6232782827699343e-06 1.5237763155854494e-06 1.2353887122310054e-06]<br> [2.2539479715340765e-06 4.137531316824766e-06 4.692421159365311e-06<br>  3.0675241353207454e-06 -9.785456576036117e-08 -3.57115868284942e-06<br>  -4.736523568399334e-06 -2.5443130896667334e-06 -3.8855501818971554e-07<br>  -2.3839149096640136e-06 -6.4595389103078165e-06 -5.42709500922056e-06<br>  3.3977121746524813e-06 1.3260659607534244e-05 1.585020824542514e-05<br>  1.156986517053119e-05 8.420346204985106e-06 1.1409628867598479e-05<br>  1.731320983093165e-05 2.0437273229878943e-05 1.9294667695265124e-05<br>  1.6380319120174438e-05 1.3568771402760155e-05 1.0785458334484284e-05<br>  7.680447942028873e-06 4.612021467265345e-06 2.245454985531202e-06<br>  9.801872862478723e-07 9.291450404054742e-07 1.571950575401185e-06<br>  1.8798414836278818e-06 1.5557697940251536e-06 1.1589243219944786e-06]<br> [2.288607949378604e-06 3.168945003613844e-06 4.152745415755006e-06<br>  6.085929467603452e-06 8.397216819128677e-06 9.182756062656688e-06<br>  8.089931546212932e-06 6.065250494053574e-06 3.1864017747788493e-06<br>  -1.0615823600979726e-07 -5.115747236035604e-07 5.686849465250411e-06<br>  1.6520841279398915e-05 2.393920713931518e-05 2.2542454135448216e-05<br>  1.5896935380993894e-05 1.1805258706549443e-05 1.317278339642766e-05<br>  1.6262321355574893e-05 1.749631697031143e-05 1.7555936829572333e-05<br>  1.828615320466403e-05 1.9113497680698463e-05 1.843387161098794e-05<br>  1.626663724998378e-05 1.3707466776845108e-05 1.1331419314492844e-05<br>  9.01245532314757e-06 7.036672215313085e-06 5.652993403225754e-06<br>  4.167441476623927e-06 2.395622169591143e-06 8.797877069982943e-07]<br> [5.443437673010016e-06 6.306615226992259e-06 8.001831310222036e-06<br>  1.2513403347023923e-05 1.85773670127288e-05 2.2264432448468096e-05<br>  2.1169266429116575e-05 1.613890984638587e-05 9.872505891689222e-06<br>  5.944065107616479e-06 7.824906538556809e-06 1.589497334996787e-05<br>  2.5076828819158818e-05 2.7969085736244336e-05 2.2243620051046606e-05<br>  1.3085529762959835e-05 7.174026354674316e-06 5.992152347591144e-06<br>  6.803209294324242e-06 7.939434588679301e-06 1.0130591527978899e-05<br>  1.3292160676724397e-05 1.5529918623797283e-05 1.6153455044941722e-05<br>  1.7041718020276484e-05 1.950634398856e-05 2.1840335199803486e-05<br>  2.170027509551151e-05 1.904177093804649e-05 1.5469783838664064e-05<br>  1.1882404830344957e-05 8.411657254320143e-06 5.302805440971269e-06]<br> [8.602633876860203e-06 8.679641926073596e-06 9.702522080455005e-06<br>  1.3614751739056397e-05 1.9008761413478876e-05 2.2087862189940527e-05<br>  2.0586851856109194e-05 1.561435693330084e-05 1.052343363894795e-05<br>  9.034927567922455e-06 1.2711044192411534e-05 1.9195527008653536e-05<br>  2.319749522598083e-05 2.0776296776170542e-05 1.2899217803326149e-05<br>  4.499263856496836e-06 -4.850715279365816e-07 -1.8867348521589935e-06<br>  -1.2545243659528591e-06 6.826818374210109e-07 3.470591352825835e-06<br>  5.188379472734134e-06 4.359793489982297e-06 3.236256407457206e-06<br>  6.199730495935274e-06 1.4303492819082252e-05 2.297077063111617e-05<br>  2.6833600816068574e-05 2.5112087950136465e-05 2.1045399509524918e-05<br>  1.733405553075314e-05 1.4304542537971311e-05 1.157542847085521e-05]<br> [4.886699515720533e-06 2.9374926564745755e-06 2.342131027522043e-06<br>  4.212580213801906e-06 6.919242481783616e-06 8.009662592285611e-06<br>  6.388721958108232e-06 3.559294772259922e-06 2.6353165016971543e-06<br>  5.67291728132663e-06 1.1198742676107834e-05 1.4904206143393496e-05<br>  1.345465172469813e-05 7.672437051713742e-06 1.6001076508919762e-06<br>  -1.6641260210052704e-06 -2.262903679347289e-06 -1.956114848783089e-06<br>  -1.394487489660087e-06 -2.2276888096696637e-07 5.15759203573742e-07<br>  -1.548001351015197e-06 -6.935606213275143e-06 -1.1496309014788116e-05<br>  -9.655702276821804e-06 -4.921560401708452e-07 1.0473654038970031e-05<br>  1.6504936737122054e-05 1.6046548440332633e-05 1.2973548418077562e-05<br>  1.1305827293440389e-05 1.1582886609839052e-05 1.2205804527408556e-05]<br> [-5.33952229840799e-06 -8.704992543645736e-06 -9.993437087345422e-06<br>  -8.915136239177719e-06 -7.19506666451935e-06 -6.578813152721005e-06<br>  -7.5237874843627755e-06 -8.495535890750933e-06 -6.537501337478904e-06<br>  -5.428892343893359e-07 6.0744131068719236e-06 7.852676070065128e-06<br>  3.3360276286033345e-06 -2.7579828685385874e-06 -4.7361418399740685e-06<br>  -2.029885810808619e-06 1.3926458301432746e-06 2.1861658770169226e-06<br>  7.462664767866292e-07 -9.620450459489125e-07 -2.77606888754211e-06<br>  -6.423875565024323e-06 -1.2276187966795248e-05 -1.768035960097623e-05<br>  -1.8511392096373025e-05 -1.337128506022894e-05 -5.604103688109354e-06<br>  -5.387897923659644e-07 -4.738946106468169e-07 -2.639384737721052e-06<br>  -2.579028369893327e-06 1.0161426175174823e-06 5.51705839630009e-06]<br> [-1.295088374638569e-05 -1.5587936916273553e-05 -1.6186884829401637e-05<br>  -1.4818115230518859e-05 -1.2864297090203827e-05 -1.1607806990304653e-05<br>  -1.1922501312846094e-05 -1.288041006291696e-05 -1.1387584800255694e-05<br>  -5.760351894202418e-06 4.809589378711805e-07 1.7135056523956503e-06<br>  -2.868232303512613e-06 -7.420294585926504e-06 -6.4921249072346035e-06<br>  -1.3297770699928519e-06 2.379421923999703e-06 1.405586568469394e-06<br>  -2.701864909351582e-06 -6.773793328748629e-06 -9.145238472649888e-06<br>  -1.0154072656535602e-05 -1.1034229111105364e-05 -1.283431967995698e-05<br>  -1.4820101505113006e-05 -1.4923005536188056e-05 -1.2297798377102011e-05<br>  -9.312157031769032e-06 -9.107411301532708e-06 -1.1297231388298798e-05<br>  -1.1852361429089774e-05 -8.01616007819106e-06 -2.2632272317365637e-06]<br> [-1.1264798474518239e-05 -1.1697937243832298e-05 -1.1610403969329597e-05<br>  -1.0990071613382226e-05 -1.017876648140647e-05 -9.612705852955338e-06<br>  -1.0489598361996245e-05 -1.2711233646493416e-05 -1.3277505488214866e-05<br>  -9.758083580137854e-06 -4.617307745548297e-06 -2.972249707897838e-06<br>  -5.789471511792049e-06 -8.433016768893815e-06 -7.040837520227441e-06<br>  -3.450086203930059e-06 -2.153049543660394e-06 -4.592189151911325e-06<br>  -8.737368986726737e-06 -1.2087032488074449e-05 -1.3041808104350452e-05<br>  -1.0676765740443082e-05 -6.0798877131095694e-06 -2.8673627881143913e-06<br>  -3.774079591756895e-06 -6.985573651587517e-06 -8.320885703293529e-06<br>  -7.003751569916084e-06 -6.670296865907164e-06 -9.26640507254439e-06<br>  -1.1778866193977816e-05 -1.0293050215782422e-05 -6.213697786203869e-06]<br> [-4.2366205899982845e-06 -3.009761718779192e-06 -2.9445738566039296e-06<br>  -3.958787350325387e-06 -5.466313677613832e-06 -6.8828228154694975e-06<br>  -8.929565662298798e-06 -1.1868304315290376e-05 -1.3435206603215848e-05<br>  -1.1477502467966329e-05 -7.579215589251869e-06 -5.72908208056811e-06<br>  -6.765885458285424e-06 -7.723434211172543e-06 -6.7518310860388566e-06<br>  -5.664123778941993e-06 -6.400572499890068e-06 -7.906529804848007e-06<br>  -8.425589001857558e-06 -8.384288367475396e-06 -8.177986453450766e-06<br>  -5.893377623466557e-06 -3.2557930725954096e-07 5.222418935034511e-06<br>  5.9541589622174695e-06 1.9366028334291003e-06 -1.9998980728005993e-06<br>  -2.9710591236013615e-06 -3.4157348875669164e-06 -6.109352024995957e-06<br>  -9.441831118428572e-06 -9.848852324214997e-06 -7.804189043287055e-06]<br> [-5.6551534712974835e-08 9.521441100879948e-07 9.551340608041977e-07<br>  -2.161322659844007e-07 -2.297939031405901e-06 -4.439085533792816e-06<br>  -6.641171640862909e-06 -8.898540558558832e-06 -9.874720114815469e-06<br>  -8.559397249351668e-06 -6.401188426081613e-06 -5.787356099772269e-06<br>  -6.359470206459444e-06 -5.9470806121134336e-06 -4.555873485977411e-06<br>  -4.423033925021822e-06 -5.628944977961337e-06 -5.072582517886687e-06<br>  -1.5071711528797762e-06 1.8027313142189015e-06 1.8328391160984134e-06<br>  9.052595374896353e-07 3.1759849499299173e-06 8.049327876079921e-06<br>  1.0198016949371066e-05 6.854164574395759e-06 1.0841235541890146e-06<br>  -3.2614676552561696e-06 -5.888096360580504e-06 -8.455094760050007e-06<br>  -1.0729630635511814e-05 -1.096821695693041e-05 -9.532457296538305e-06]<br> [-2.3775892301900283e-07 -8.953117205913021e-07 -8.686388730906209e-07<br>  -5.857368217559467e-07 -7.635560127815698e-07 -1.5333607614024286e-06<br>  -2.7290707718114074e-06 -3.7773359251837964e-06 -3.7765601884919017e-06<br>  -2.8529741422157834e-06 -2.831431992840211e-06 -4.556250714382301e-06<br>  -6.036541764404745e-06 -4.858786266782111e-06 -2.1394105703618696e-06<br>  -1.2094742666264004e-06 -2.2153390245655833e-06 -1.2504241214041565e-06<br>  3.3779719985436486e-06 7.682587258418457e-06 7.127853210077692e-06<br>  3.3100086758251938e-06 2.058533050965239e-06 5.345645604859078e-06<br>  8.848429575420112e-06 7.738025658481585e-06 2.2289350860754062e-06<br>  -4.022962465228084e-06 -8.520590858793207e-06 -1.1071610723113248e-05<br>  -1.1988128834925178e-05 -1.1395085582124456e-05 -9.981412144608916e-06]<br> [3.408148441667001e-07 -1.8719374712762241e-06 -2.5519943442157864e-06<br>  -1.832173171581727e-06 -7.079308114911054e-07 -2.454858629615519e-07<br>  -7.172197894195101e-07 -1.2113583928015329e-06 -6.773056874358321e-07<br>  1.9806311002436617e-07 -8.420580402768965e-07 -4.365967468419484e-06<br>  -7.219822085451604e-06 -6.111380316969779e-06 -2.2474433684284564e-06<br>  6.502490300057976e-08 -5.855174200338245e-07 -8.937278513446058e-07<br>  1.9261707737762e-06 5.34523982985006e-06 4.918276605135323e-06<br>  6.988027486654621e-07 -2.3691669579290495e-06 -8.498990758102647e-07<br>  3.1817119364138993e-06 5.209275937004438e-06 3.4046944906301064e-06<br>  -5.156681964953369e-07 -4.15454945325487e-06 -6.514665562859277e-06<br>  -7.57468620337602e-06 -7.700316203771614e-06 -7.326788845738304e-06]<br> [3.860599955154206e-06 4.833664056007341e-07 -1.6784280679449978e-06<br>  -2.1471401068565834e-06 -1.3107558313935328e-06 -6.415937963799182e-07<br>  -9.829997538495772e-07 -1.4697938361618587e-06 -7.013650994056646e-07<br>  5.127966720732557e-07 -4.051163933148043e-07 -4.639630867253177e-06<br>  -8.872247057490272e-06 -8.924744193476296e-06 -4.839578964639545e-06<br>  -1.081971457327695e-06 -7.431410575213065e-07 -2.15767543006792e-06<br>  -1.9592664178359792e-06 -1.8312619327432296e-07 -9.757718209669996e-09<br>  -3.085056337894988e-06 -6.8096644242356224e-06 -7.536040873238262e-06<br>  -4.546717136855209e-06 -6.885009397513402e-08 3.412303344112208e-06<br>  4.971755135149273e-06 4.772227346084636e-06 3.070686296607173e-06<br>  7.2576740502466e-07 -1.384760011605284e-06 -2.8933563457660367e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/second</td></tr></tbody></table></div></div></li><li class='xr-section-item'><input id='section-ac192ad6-56a1-4965-8866-47b342b93d33' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ac192ad6-56a1-4965-8866-47b342b93d33' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-3c6388da-c330-47f1-93d9-f98aac66369b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3c6388da-c330-47f1-93d9-f98aac66369b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-712854fc-fe1f-423b-af56-6788ad426ed7' class='xr-var-data-in' type='checkbox'><label for='data-712854fc-fe1f-423b-af56-6788ad426ed7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>_metpy_axis :</span></dt><dd>x,longitude</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>30.0 27.5 25.0 ... -17.5 -20.0</div><input id='attrs-8797e6e4-25d1-45a8-a092-d1f43dfff949' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8797e6e4-25d1-45a8-a092-d1f43dfff949' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67c2c452-c8d7-49cc-8ed1-903607182fb5' class='xr-var-data-in' type='checkbox'><label for='data-67c2c452-c8d7-49cc-8ed1-903607182fb5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_metpy_axis :</span></dt><dd>y,latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 30. ,  27.5,  25. ,  22.5,  20. ,  17.5,  15. ,  12.5,  10. ,   7.5,
         5. ,   2.5,   0. ,  -2.5,  -5. ,  -7.5, -10. , -12.5, -15. , -17.5,
       -20. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-1ee34107-7431-4f30-ad0b-7e404a6d0ffb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1ee34107-7431-4f30-ad0b-7e404a6d0ffb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2c80b55-c49b-4470-adf6-42621e7562dd' class='xr-var-data-in' type='checkbox'><label for='data-f2c80b55-c49b-4470-adf6-42621e7562dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>_metpy_axis :</span></dt><dd>vertical</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-35e43267-dc45-4f15-9b8d-a59d6adff88c' class='xr-section-summary-in' type='checkbox'  ><label for='section-35e43267-dc45-4f15-9b8d-a59d6adff88c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4cb6ee2d-9a0a-41d9-ad53-c6f8d251643d' class='xr-index-data-in' type='checkbox'/><label for='index-4cb6ee2d-9a0a-41d9-ad53-c6f8d251643d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 80.0,  82.5,  85.0,  87.5,  90.0,  92.5,  95.0,  97.5, 100.0, 102.5,
       105.0, 107.5, 110.0, 112.5, 115.0, 117.5, 120.0, 122.5, 125.0, 127.5,
       130.0, 132.5, 135.0, 137.5, 140.0, 142.5, 145.0, 147.5, 150.0, 152.5,
       155.0, 157.5, 160.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cd55a597-f724-4597-a727-6f5ad7b47c03' class='xr-index-data-in' type='checkbox'/><label for='index-cd55a597-f724-4597-a727-6f5ad7b47c03' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 30.0,  27.5,  25.0,  22.5,  20.0,  17.5,  15.0,  12.5,  10.0,   7.5,
         5.0,   2.5,   0.0,  -2.5,  -5.0,  -7.5, -10.0, -12.5, -15.0, -17.5,
       -20.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f2cd917e-88ae-42bb-84e9-9331763c43af' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f2cd917e-88ae-42bb-84e9-9331763c43af' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>以上預覽的資訊中，多了「Magnitude」和「Units」的資訊，這是因為在MetPy計算中，單位也很重要，因此除了文字格式的Unit attribute之外，DataArray還附上單位資訊，稱為「unit-aware array type」。如果將這個DataArray繼續做其他的計算，單位仍會保留下來。</p>
<p>有時候將unit-aware array type餵給某些函數時，程式不認得而造成錯誤，此時可以用 <code class="docutils literal notranslate"><span class="pre">.dequantify()</span></code> 的方式轉換成一般的DataArray，或稱為「unit-naive array type」。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vorm</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">dequantify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 21, lon: 33)&gt;
array([[ 2.27227035e-06, -6.35822645e-06, -1.46749070e-05,
        -2.08053115e-05, -2.30204190e-05, -2.14179636e-05,
        -1.73882539e-05, -1.29046760e-05, -9.84929500e-06,
        -9.54206099e-06, -1.12507049e-05, -1.23807539e-05,
        -1.01248504e-05, -4.97617877e-06, -9.28601335e-07,
        -2.13257232e-06, -8.04519296e-06, -1.36745794e-05,
        -1.37081362e-05, -8.49913312e-06, -2.77764758e-06,
        -1.18851542e-06, -3.59719131e-06, -6.00788240e-06,
        -5.68558831e-06, -3.57765352e-06, -2.98596786e-06,
        -5.61280440e-06, -9.78352706e-06, -1.28709753e-05,
        -1.36409031e-05, -1.30405734e-05, -1.21284570e-05],
       [ 1.59641488e-06,  1.27951490e-07, -2.96147587e-06,
        -6.09627077e-06, -7.14075885e-06, -6.30349598e-06,
        -5.16875042e-06, -4.56615673e-06, -4.01070010e-06,
        -3.29133037e-06, -3.14996178e-06, -4.03313727e-06,
        -5.06772766e-06, -5.30085544e-06, -5.33611754e-06,
        -7.06711890e-06, -1.08910896e-05, -1.43131536e-05,
        -1.42338578e-05, -1.03047389e-05, -5.71612173e-06,
        -3.96175474e-06, -5.53658936e-06, -7.88921794e-06,
        -8.64479278e-06, -8.03751306e-06, -8.04710263e-06,
...
        -7.17219789e-07, -1.21135839e-06, -6.77305687e-07,
         1.98063110e-07, -8.42058040e-07, -4.36596747e-06,
        -7.21982209e-06, -6.11138032e-06, -2.24744337e-06,
         6.50249030e-08, -5.85517420e-07, -8.93727851e-07,
         1.92617077e-06,  5.34523983e-06,  4.91827661e-06,
         6.98802749e-07, -2.36916696e-06, -8.49899076e-07,
         3.18171194e-06,  5.20927594e-06,  3.40469449e-06,
        -5.15668196e-07, -4.15454945e-06, -6.51466556e-06,
        -7.57468620e-06, -7.70031620e-06, -7.32678885e-06],
       [ 3.86059996e-06,  4.83366406e-07, -1.67842807e-06,
        -2.14714011e-06, -1.31075583e-06, -6.41593796e-07,
        -9.82999754e-07, -1.46979384e-06, -7.01365099e-07,
         5.12796672e-07, -4.05116393e-07, -4.63963087e-06,
        -8.87224706e-06, -8.92474419e-06, -4.83957896e-06,
        -1.08197146e-06, -7.43141058e-07, -2.15767543e-06,
        -1.95926642e-06, -1.83126193e-07, -9.75771821e-09,
        -3.08505634e-06, -6.80966442e-06, -7.53604087e-06,
        -4.54671714e-06, -6.88500940e-08,  3.41230334e-06,
         4.97175514e-06,  4.77222735e-06,  3.07068630e-06,
         7.25767405e-07, -1.38476001e-06, -2.89335635e-06]])
Coordinates:
  * lon      (lon) float32 80.0 82.5 85.0 87.5 90.0 ... 152.5 155.0 157.5 160.0
  * lat      (lat) float32 30.0 27.5 25.0 22.5 20.0 ... -12.5 -15.0 -17.5 -20.0
    level    float32 850.0
Attributes:
    units:    1 / second</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 21</li><li><span class='xr-has-index'>lon</span>: 33</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-76ece6ed-676e-4035-a50b-83aec4bd06ee' class='xr-array-in' type='checkbox' checked><label for='section-76ece6ed-676e-4035-a50b-83aec4bd06ee' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2.272e-06 -6.358e-06 -1.467e-05 ... 7.258e-07 -1.385e-06 -2.893e-06</span></div><div class='xr-array-data'><pre>array([[ 2.27227035e-06, -6.35822645e-06, -1.46749070e-05,
        -2.08053115e-05, -2.30204190e-05, -2.14179636e-05,
        -1.73882539e-05, -1.29046760e-05, -9.84929500e-06,
        -9.54206099e-06, -1.12507049e-05, -1.23807539e-05,
        -1.01248504e-05, -4.97617877e-06, -9.28601335e-07,
        -2.13257232e-06, -8.04519296e-06, -1.36745794e-05,
        -1.37081362e-05, -8.49913312e-06, -2.77764758e-06,
        -1.18851542e-06, -3.59719131e-06, -6.00788240e-06,
        -5.68558831e-06, -3.57765352e-06, -2.98596786e-06,
        -5.61280440e-06, -9.78352706e-06, -1.28709753e-05,
        -1.36409031e-05, -1.30405734e-05, -1.21284570e-05],
       [ 1.59641488e-06,  1.27951490e-07, -2.96147587e-06,
        -6.09627077e-06, -7.14075885e-06, -6.30349598e-06,
        -5.16875042e-06, -4.56615673e-06, -4.01070010e-06,
        -3.29133037e-06, -3.14996178e-06, -4.03313727e-06,
        -5.06772766e-06, -5.30085544e-06, -5.33611754e-06,
        -7.06711890e-06, -1.08910896e-05, -1.43131536e-05,
        -1.42338578e-05, -1.03047389e-05, -5.71612173e-06,
        -3.96175474e-06, -5.53658936e-06, -7.88921794e-06,
        -8.64479278e-06, -8.03751306e-06, -8.04710263e-06,
...
        -7.17219789e-07, -1.21135839e-06, -6.77305687e-07,
         1.98063110e-07, -8.42058040e-07, -4.36596747e-06,
        -7.21982209e-06, -6.11138032e-06, -2.24744337e-06,
         6.50249030e-08, -5.85517420e-07, -8.93727851e-07,
         1.92617077e-06,  5.34523983e-06,  4.91827661e-06,
         6.98802749e-07, -2.36916696e-06, -8.49899076e-07,
         3.18171194e-06,  5.20927594e-06,  3.40469449e-06,
        -5.15668196e-07, -4.15454945e-06, -6.51466556e-06,
        -7.57468620e-06, -7.70031620e-06, -7.32678885e-06],
       [ 3.86059996e-06,  4.83366406e-07, -1.67842807e-06,
        -2.14714011e-06, -1.31075583e-06, -6.41593796e-07,
        -9.82999754e-07, -1.46979384e-06, -7.01365099e-07,
         5.12796672e-07, -4.05116393e-07, -4.63963087e-06,
        -8.87224706e-06, -8.92474419e-06, -4.83957896e-06,
        -1.08197146e-06, -7.43141058e-07, -2.15767543e-06,
        -1.95926642e-06, -1.83126193e-07, -9.75771821e-09,
        -3.08505634e-06, -6.80966442e-06, -7.53604087e-06,
        -4.54671714e-06, -6.88500940e-08,  3.41230334e-06,
         4.97175514e-06,  4.77222735e-06,  3.07068630e-06,
         7.25767405e-07, -1.38476001e-06, -2.89335635e-06]])</pre></div></div></li><li class='xr-section-item'><input id='section-9aacc570-c6ac-4c88-96d1-079448acdfa9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9aacc570-c6ac-4c88-96d1-079448acdfa9' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>80.0 82.5 85.0 ... 157.5 160.0</div><input id='attrs-702d3e5f-0990-4035-b5ac-8b95d88618e6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-702d3e5f-0990-4035-b5ac-8b95d88618e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92de31a1-ae0b-45ae-bdd1-58bfb6dba06a' class='xr-var-data-in' type='checkbox'><label for='data-92de31a1-ae0b-45ae-bdd1-58bfb6dba06a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>_metpy_axis :</span></dt><dd>x,longitude</dd></dl></div><div class='xr-var-data'><pre>array([ 80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5, 100. , 102.5,
       105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5, 125. , 127.5,
       130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5, 150. , 152.5,
       155. , 157.5, 160. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>30.0 27.5 25.0 ... -17.5 -20.0</div><input id='attrs-22c4d281-ff52-4a63-8924-c63f08d6481c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-22c4d281-ff52-4a63-8924-c63f08d6481c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d51e0275-7097-433b-8940-fc49e9c73718' class='xr-var-data-in' type='checkbox'><label for='data-d51e0275-7097-433b-8940-fc49e9c73718' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_metpy_axis :</span></dt><dd>y,latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 30. ,  27.5,  25. ,  22.5,  20. ,  17.5,  15. ,  12.5,  10. ,   7.5,
         5. ,   2.5,   0. ,  -2.5,  -5. ,  -7.5, -10. , -12.5, -15. , -17.5,
       -20. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-fc6d16fe-d936-4781-9293-b17d0f5b6b7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc6d16fe-d936-4781-9293-b17d0f5b6b7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e4841e0-4baf-4027-863c-8431d87bc1e2' class='xr-var-data-in' type='checkbox'><label for='data-1e4841e0-4baf-4027-863c-8431d87bc1e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>_metpy_axis :</span></dt><dd>vertical</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b10efefa-d074-47cb-9f31-0ac688908e63' class='xr-section-summary-in' type='checkbox'  ><label for='section-b10efefa-d074-47cb-9f31-0ac688908e63' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5c9f52bf-efd1-40fa-bdd1-7c1149c043dd' class='xr-index-data-in' type='checkbox'/><label for='index-5c9f52bf-efd1-40fa-bdd1-7c1149c043dd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 80.0,  82.5,  85.0,  87.5,  90.0,  92.5,  95.0,  97.5, 100.0, 102.5,
       105.0, 107.5, 110.0, 112.5, 115.0, 117.5, 120.0, 122.5, 125.0, 127.5,
       130.0, 132.5, 135.0, 137.5, 140.0, 142.5, 145.0, 147.5, 150.0, 152.5,
       155.0, 157.5, 160.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5c5f16cd-15a3-48b9-a338-0867e18e6deb' class='xr-index-data-in' type='checkbox'/><label for='index-5c5f16cd-15a3-48b9-a338-0867e18e6deb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 30.0,  27.5,  25.0,  22.5,  20.0,  17.5,  15.0,  12.5,  10.0,   7.5,
         5.0,   2.5,   0.0,  -2.5,  -5.0,  -7.5, -10.0, -12.5, -15.0, -17.5,
       -20.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-33adc2c0-64ec-4b5e-ba75-09d7616d78e2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-33adc2c0-64ec-4b5e-ba75-09d7616d78e2' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1 / second</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>單位就會被轉換為文字格式的attribute。</p>
<p>Step 3: 繪圖。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cmaps</span>

<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>  
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">proj</span><span class="p">})</span> 

<span class="n">vorm</span> <span class="o">=</span> <span class="n">vorm</span> <span class="o">*</span> <span class="mf">10e5</span>
<span class="n">vorPlot</span> <span class="o">=</span> <span class="p">(</span><span class="n">vorm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>  
                              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>       
                              <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> 
                              <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="o">.</span><span class="n">CBR_coldhot</span><span class="p">,</span>  
                              <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                              <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">})</span> <span class="c1">#設定color bar</span>
                              <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
                         
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;850-hPa Vorticity, December 2017&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>             <span class="c1"># 設定坐標軸名稱。</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/waynetsai/micromamba/envs/p3/lib/python3.10/site-packages/shapely/predicates.py:798: RuntimeWarning: invalid value encountered in intersects
  return lib.intersects(a, b, **kwargs)
</pre></div>
</div>
<img alt="_images/329cbb6e7290ba533e5e93575598db52d671de70fed32039b8e6df466ae54a25.png" src="_images/329cbb6e7290ba533e5e93575598db52d671de70fed32039b8e6df466ae54a25.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>同Example 5，但計算散度 <a class="reference external" href="https://unidata.github.io/MetPy/latest/api/generated/metpy.calc.divergence.html">metpy.calc.divergence</a>。</p>
</div>
</section>
<section id="eof">
<h2>計算經驗正交函數 (EOF)<a class="headerlink" href="#eof" title="Link to this heading">#</a></h2>
<p>使用<code class="docutils literal notranslate"><span class="pre">eofs</span></code>套件，範例請見<a class="reference external" href="https://ajdawson.github.io/eofs/latest/examples/xarray_examples_index.html">官方網站</a>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">eofs.xarray</span> <span class="kn">import</span> <span class="n">Eof</span>
</pre></div>
</div>
</div>
</div>
<p>用法是</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">Eof</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
</pre></div>
</div>
<p>然後<code class="docutils literal notranslate"><span class="pre">solver</span></code>會有幾個methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solver.eofs()</span></code>: 計算EOF的主模態。若給定<code class="docutils literal notranslate"><span class="pre">neofs</span></code>引數，可以得到對應的模態數量。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.pcs()</span></code>: 計算rincipal component的時間序列。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.varianceFraction()</span></code>: 計算各個模態變異度佔全部的比例，也就是各個模態能夠解釋原始DataArray的程度之比例。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.reconstructedField()</span></code>: 利用EOF模態和時間序列重建得到的變數場。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.projectField()</span></code>: 將變數投影到EOF主模態上。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06_clim_anml.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6. Climatology and Anomaly</p>
      </div>
    </a>
    <a class="right-next"
       href="08_plotting_1d.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8. <code class="docutils literal notranslate"><span class="pre">xarray</span></code>繪圖 (1)：繪製1D資料</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regridding">Regridding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#change-coordinate-resolution">Change Coordinate Resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-mean">滑動平均 (running mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-map">相關係數地圖 (correlation map)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where"><code class="docutils literal notranslate"><span class="pre">where</span></code>條件控制</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vorticity-divergence">計算相對渦度 (vorticity)、散度 (divergence)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eof">計算經驗正交函數 (EOF)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Wayne Yuan-Huai Tsai, University of Oklahoma
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
Last updated: 2024-07-16
</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>