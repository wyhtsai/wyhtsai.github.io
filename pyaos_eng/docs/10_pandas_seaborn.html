
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>10. pandas and seaborn: Statistical Plots &#8212; Python for Atmosphere and Ocean Science (PyAOS)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-HKB5C6NRJC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-HKB5C6NRJC');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-HKB5C6NRJC');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '10_pandas_seaborn';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="11. Climate Data Operator (CDO)" href="11_cdo.html" />
    <link rel="prev" title="9. xarray Plotting (II): Plotting Data with More Than 2 Dimensions" href="09_plotting_2d.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00_syllabus_eng.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/PyAOS_gray_logo.png" class="logo__image only-light" alt="Python for Atmosphere and Ocean Science (PyAOS) - Home"/>
    <script>document.write(`<img src="_static/PyAOS_gray_logo.png" class="logo__image only-dark" alt="Python for Atmosphere and Ocean Science (PyAOS) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_syllabus_eng.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals in xarray</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_setup.html">Python Installation and Environment Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_open_nc_files.html">2. NetCDF and GRIB Datasets I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_plotting_basics.html">3. Basic Workflow Demo: Plotting A Monthly Mean Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_xr_datetime.html">4. Conditional Control of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_da_create.html">5. Manually Create a DataArray</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals in climate analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06_clim_anml.html">6. Climatology and Anomaly</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_statistics_calc.html">7. Advanced Calculation and Statistical Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced plotting</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="08_plotting_1d.html">8. <code class="docutils literal notranslate"><span class="pre">xarray</span></code> Plotting (I): Plotting 1-Dimensional Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_plotting_2d.html">9. <code class="docutils literal notranslate"><span class="pre">xarray</span></code> Plotting (II): Plotting Data with More Than 2 Dimensions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">10. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>: Statistical Plots</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="11_cdo.html">11. Climate Data Operator (CDO)</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_large_ds.html">12. <code class="docutils literal notranslate"><span class="pre">dask</span></code> and Large Datasets Computations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="appendix-main.html">Appendix: Useful Examples for Climate Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="A4_ireg_grid_sel.html">Slicing Iregular Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="A3_lanczos_filter.html">Lanczos Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="A1_mjo_phase.html">Climate Variability Analysis: Madden–Julian Oscillation (MJO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="A6_tropical_waves.html">Tropical Waves Identification and Analysis</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos_eng/docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/wyhtsai/wyhtsai.github.io/tree/main/pyaos_eng/docs/issues/new?title=Issue%20on%20page%20%2F10_pandas_seaborn.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/10_pandas_seaborn.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>10. pandas and seaborn: Statistical Plots</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure-of-pandas">Data Structure of <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-csv-file-with-pandas">Read <code class="docutils literal notranslate"><span class="pre">.csv</span></code> File with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-long-form-pandas-dataframe-with-seaborn">Plotting Long Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-of-xarray-dataarray-to-pandas-dataframe">Conversion of <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> to <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-to-pandas"><code class="docutils literal notranslate"><span class="pre">xarray.to_pandas</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-scatter-plot-and-regression-line">Example: Scatter Plot and Regression Line</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-wide-form-pandas-dataframe-with-seaborn">Plotting Wide Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-between-long-form-and-wide-form">Conversion between Long Form and Wide Form</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas-and-seaborn-statistical-plots">
<h1>10. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>: Statistical Plots<a class="headerlink" href="#pandas-and-seaborn-statistical-plots" title="Link to this heading">#</a></h1>
<p>Interpretation of climate data heavily depends on statistical methods, so it is important to learn how to visualize climate statistical information. Although <code class="docutils literal notranslate"><span class="pre">xarray</span></code> can read netCDF files and plot different types of maps, it doesn’t have built-in methods to support statistical plots such as box plots, regression line plots, density maps. Therefore, we need to use external libraries to create these plots. Here, we introduce the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> library. <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> is a powerful tool for statistical data visualization. The plotting method is very simple but highly functional, and the output diagrams are aesthetic. In this unit, we will learn how to plot with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> after performing calculations with <code class="docutils literal notranslate"><span class="pre">xarray</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code> mainly accepts <code class="docutils literal notranslate"><span class="pre">.csv</span></code> files and <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> objects. When passing datasets to <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, we need to tidy the data into a structure that <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> can identify, namely <strong>long form</strong> and <strong>wide form</strong>. The data structure accepted by <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> can be found in the <a class="reference external" href="https://seaborn.pydata.org/tutorial/data_structure.html"><code class="docutils literal notranslate"><span class="pre">seaborn</span></code> tutorial page</a>. In this unit, we will focus on how to convert a DataArray/Dataset to a long or wide form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> and pass it to <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. For details of plotting methods and options, see the <a class="reference external" href="https://seaborn.pydata.org/"><code class="docutils literal notranslate"><span class="pre">seaborn</span></code> official website</a>, which we will not cover in detail here.</p>
<p><img alt="Data Structure" src="https://seaborn.pydata.org/_images/data_structure_19_0.png" /></p>
<section id="data-structure-of-pandas">
<h2>Data Structure of <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#data-structure-of-pandas" title="Link to this heading">#</a></h2>
<p>Like <code class="docutils literal notranslate"><span class="pre">xarray</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> handles “labeled-data” (In fact, <code class="docutils literal notranslate"><span class="pre">xarray</span></code> originated from <code class="docutils literal notranslate"><span class="pre">pandas</span></code>!). Depending on the dimensionality of the data, the pandas data structures are divided into two types: <strong>Series</strong> and <strong>DataFrame</strong>.</p>
<section id="series">
<h3>Series<a class="headerlink" href="#series" title="Link to this heading">#</a></h3>
<p>A Series is a 1-dimensional, labeled array. It can store multiple types of elements. The “labels” are called <strong>index</strong> in the context of <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. The method to create a new Series is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<p>A Series can be created by specifying a data series and the label index. Here is a simple example. More detailed usage can be found in the <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/dsintro.html#dataframe">Pandas tutorial</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 

<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a   -1.538341
b    0.260428
c   -0.999467
d   -0.404520
e    0.528400
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataframe">
<h3>DataFrame<a class="headerlink" href="#dataframe" title="Link to this heading">#</a></h3>
<p>A DataFrame is a 2-dimensional labeled array. It is similar to an Excel sheet. The method to create a new DataFrame is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Index</strong> is the label for each row, whereas <strong>columns</strong> is the label for each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.312066</td>
      <td>0.547977</td>
      <td>0.269142</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.381498</td>
      <td>0.387017</td>
      <td>1.601161</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.014665</td>
      <td>2.131940</td>
      <td>-0.909217</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.630053</td>
      <td>1.009775</td>
      <td>0.922236</td>
    </tr>
    <tr>
      <th>e</th>
      <td>1.251739</td>
      <td>0.538616</td>
      <td>-0.149302</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or we can create a DataFrame using a <strong>dictionary</strong>. The <strong>keys</strong> of the dictionary will be treated as column labels (<code class="docutils literal notranslate"><span class="pre">bom</span></code>, <code class="docutils literal notranslate"><span class="pre">cma</span></code>, <code class="docutils literal notranslate"><span class="pre">ecmwf</span></code>, and <code class="docutils literal notranslate"><span class="pre">ncep</span></code> in the following example).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">bom</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                       <span class="n">cma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                       <span class="n">ecmwf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                       <span class="n">ncep</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> 
                  <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1998</span><span class="p">,</span><span class="mi">2008</span><span class="p">)</span>
                  <span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bom</th>
      <th>cma</th>
      <th>ecmwf</th>
      <th>ncep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998</th>
      <td>0.841404</td>
      <td>-0.296407</td>
      <td>-0.591968</td>
      <td>-1.519123</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>0.036797</td>
      <td>-0.230799</td>
      <td>-0.640525</td>
      <td>1.352359</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>1.112564</td>
      <td>0.787573</td>
      <td>-1.023185</td>
      <td>1.869436</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>0.951301</td>
      <td>1.492301</td>
      <td>-1.219619</td>
      <td>-1.177986</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>-0.868670</td>
      <td>-0.218609</td>
      <td>-0.510641</td>
      <td>0.189584</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>-0.369046</td>
      <td>-1.118256</td>
      <td>-0.692269</td>
      <td>-1.117366</td>
    </tr>
    <tr>
      <th>2004</th>
      <td>0.573508</td>
      <td>1.112475</td>
      <td>0.230167</td>
      <td>-0.100584</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>-0.630151</td>
      <td>1.322432</td>
      <td>0.239550</td>
      <td>0.247403</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>1.585305</td>
      <td>-1.136694</td>
      <td>-0.105676</td>
      <td>-0.765231</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>-0.062118</td>
      <td>-1.985050</td>
      <td>0.406856</td>
      <td>-1.706546</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="read-csv-file-with-pandas">
<h2>Read <code class="docutils literal notranslate"><span class="pre">.csv</span></code> File with <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#read-csv-file-with-pandas" title="Link to this heading">#</a></h2>
<p>We can read a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file using <code class="docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code> and convert the file contents to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<p><strong>Example 1a:</strong> <a class="reference external" href="https://www.mdpi.com/2073-4433/12/6/758">Tsai et al. (2021, Atmosphere)</a> defined “Subseasonal Peak Rainfall Events (SPREs)” as a maximum 15-day rainfall period within a season. The SPRE is a useful index to evaluate extreme rainfall prediction capability in forecast models. In Tsai et al. (2021), they found SPREs in the DJF season for each year from 1998 to 2019 and calculated the percentile ranks (PR) of the 15-day accumulative rainfall amount in both observation and model reforecasts. The difference of PRs between observation and models can be quantified by “root-mean-squared errors (RMSE)”. The CSV sample file <code class="docutils literal notranslate"><span class="pre">sns_sample_s2s_pr_rmse.csv</span></code> contains the RMSEs of PRs for the SPREs in the BoM and CMA reforecasts in the first 15 days prediction lead time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sns_sample_s2s_pr_rmse.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Models</th>
      <th>Lead time (days)</th>
      <th>Year</th>
      <th>PR_RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BoM</td>
      <td>1.0</td>
      <td>1998.0</td>
      <td>21.78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BoM</td>
      <td>1.0</td>
      <td>1999.0</td>
      <td>36.98</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BoM</td>
      <td>1.0</td>
      <td>2000.0</td>
      <td>7.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BoM</td>
      <td>1.0</td>
      <td>2001.0</td>
      <td>13.18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BoM</td>
      <td>1.0</td>
      <td>2002.0</td>
      <td>19.64</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="plotting-long-form-pandas-dataframe-with-seaborn">
<h2>Plotting Long Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code><a class="headerlink" href="#plotting-long-form-pandas-dataframe-with-seaborn" title="Link to this heading">#</a></h2>
<p>The above <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file is <strong>long form</strong> data accepted by <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. Now we can plot the data.</p>
<p><strong>Example 1b:</strong> Plot the RMSEs of SPRE PRs (abbreviated as <code class="docutils literal notranslate"><span class="pre">PR_RMSE</span></code> in the file) changing with prediction lead time using box plot. The x-axis is prediction lead time, the y-axis is the magnitude of RMSE, and the spread of box is the multi-year distribution of PR_RMSE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> 
<span class="n">bxplt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Lead time (days)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;PR_RMSE&#39;</span><span class="p">,</span> 
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Models&#39;</span><span class="p">,</span>
                    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set3&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PR_RMSE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a9ef1e4bfdf89923a16ca35daf85d380eec472b65ce2e8e52cca776c32c38247.png" src="_images/a9ef1e4bfdf89923a16ca35daf85d380eec472b65ce2e8e52cca776c32c38247.png" />
</div>
</div>
<p>In the following code, we specify the labels of the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> axes to <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. The <code class="docutils literal notranslate"><span class="pre">hue</span></code> parameter is used to add a third dimension to the data visualization by assigning different colors to the categories or values of a specified variable.</p>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">col</span></code> option to plot on multiple subplots. To do this, we need to use <code class="docutils literal notranslate"><span class="pre">catplot</span></code> instead of <code class="docutils literal notranslate"><span class="pre">boxplot</span></code> because setting the <code class="docutils literal notranslate"><span class="pre">col</span></code> option will plot on a <strong>FacetGrid</strong> instead of on just one subplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">bxplt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Lead time (days)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;PR_RMSE&#39;</span><span class="p">,</span> 
                    <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Models&#39;</span><span class="p">,</span>
                    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Models&#39;</span><span class="p">,</span>
                    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set3&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PR_RMSE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/49f7bca443876fdc424f9d66b9b4044caa99be252f727120a9d8ee8f56590cc5.png" src="_images/49f7bca443876fdc424f9d66b9b4044caa99be252f727120a9d8ee8f56590cc5.png" />
</div>
</div>
</section>
<section id="conversion-of-xarray-dataarray-to-pandas-dataframe">
<h2>Conversion of <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> to <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code><a class="headerlink" href="#conversion-of-xarray-dataarray-to-pandas-dataframe" title="Link to this heading">#</a></h2>
<section id="xarray-to-pandas">
<h3><code class="docutils literal notranslate"><span class="pre">xarray.to_pandas</span></code><a class="headerlink" href="#xarray-to-pandas" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.to_pandas.html">API reference</a> states that the converted pandas data type is determined by the dimensions of the DataArray.</p>
<blockquote>
<div><p>Convert this array into a pandas object with the same shape.
The type of the returned object depends on the number of DataArray dimensions:<br />
0D -&gt; <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code><br />
1D -&gt; <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code><br />
2D -&gt; <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code><br />
Only works for arrays with 2 or fewer dimensions.</p>
</div></blockquote>
</section>
<section id="example-scatter-plot-and-regression-line">
<h3>Example: Scatter Plot and Regression Line<a class="headerlink" href="#example-scatter-plot-and-regression-line" title="Link to this heading">#</a></h3>
<p><strong>Example 3:</strong> Plot the scatter plot between the Western Pacific Subtropical High (WPSH) Index and domain-averaged rainfall over the Yangtze River Basin (105.5˚-122˚E, 27˚-33.5˚N) during the MJJ season, and calculate the regression line. The WPSH index is calculated based on 850-hPa zonal wind and is defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{WPSH} = U_{850}\left[ (115˚-140˚\mathrm{E}, 28˚-30˚\mathrm{N})\right] − U_{850}\left[(115˚-140˚\mathrm{E}, 15˚-17˚\mathrm{N})\right]\]</div>
<p>This scatter plot allows us to understand the relationship between the two variables (rainfall and WPSH). The two variables are stored in two DataArrays, and they can be merged into one Dataset. Then we convert the Dataset to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> so that we can plot with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>.</p>
<p><strong>Step 1:</strong> Read and select rainfall and wind data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">pcpds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/cmorph_sample.nc&#39;</span><span class="p">)</span>
<span class="n">pcp</span> <span class="o">=</span> <span class="p">(</span><span class="n">pcpds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1998-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2018-12-31&#39;</span><span class="p">),</span>
                  <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mf">33.5</span><span class="p">),</span>
                  <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">105.5</span><span class="p">,</span><span class="mi">122</span><span class="p">))</span><span class="o">.</span><span class="n">cmorph</span><span class="p">)</span>
<span class="n">pcp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;cmorph&#x27; (time: 7670, lat: 26, lon: 66)&gt; Size: 53MB
[13161720 values with dtype=float32]
Coordinates:
  * time     (time) datetime64[ns] 61kB 1998-01-01 1998-01-02 ... 2018-12-31
  * lon      (lon) float32 264B 105.6 105.9 106.1 106.4 ... 121.4 121.6 121.9
  * lat      (lat) float32 104B 27.12 27.38 27.62 27.88 ... 32.88 33.12 33.38
Attributes:
    standard_name:  lwe_precipitation_rate
    long_name:      precipitation
    units:          mm/day
    ver_note:       1998-2020: V1,0; 2021: V0.x.
    comment:        !!! CMORPH estimate is rainrate !!!</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'cmorph'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7670</li><li><span class='xr-has-index'>lat</span>: 26</li><li><span class='xr-has-index'>lon</span>: 66</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b6060cfd-0aaf-4fbf-9f15-3b1d5c0e3796' class='xr-array-in' type='checkbox' checked><label for='section-b6060cfd-0aaf-4fbf-9f15-3b1d5c0e3796' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[13161720 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-15eaf934-0920-4851-af84-516b8f34dc95' class='xr-section-summary-in' type='checkbox'  checked><label for='section-15eaf934-0920-4851-af84-516b8f34dc95' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2018-12-31</div><input id='attrs-81b2f760-334a-42c0-930c-102e85477250' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-81b2f760-334a-42c0-930c-102e85477250' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72668520-dc18-4d5b-9ed3-66414109840e' class='xr-var-data-in' type='checkbox'><label for='data-72668520-dc18-4d5b-9ed3-66414109840e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>starting point of time period</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-02T00:00:00.000000000&#x27;,
       &#x27;1998-01-03T00:00:00.000000000&#x27;, ..., &#x27;2018-12-29T00:00:00.000000000&#x27;,
       &#x27;2018-12-30T00:00:00.000000000&#x27;, &#x27;2018-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>105.6 105.9 106.1 ... 121.6 121.9</div><input id='attrs-cff67fe3-8d54-4e84-95a0-fcae4f5bc804' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cff67fe3-8d54-4e84-95a0-fcae4f5bc804' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70fd09b6-dbc5-41a9-a4a9-a6a51f32a28a' class='xr-var-data-in' type='checkbox'><label for='data-70fd09b6-dbc5-41a9-a4a9-a6a51f32a28a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude of center of grid box</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([105.625, 105.875, 106.125, 106.375, 106.625, 106.875, 107.125, 107.375,
       107.625, 107.875, 108.125, 108.375, 108.625, 108.875, 109.125, 109.375,
       109.625, 109.875, 110.125, 110.375, 110.625, 110.875, 111.125, 111.375,
       111.625, 111.875, 112.125, 112.375, 112.625, 112.875, 113.125, 113.375,
       113.625, 113.875, 114.125, 114.375, 114.625, 114.875, 115.125, 115.375,
       115.625, 115.875, 116.125, 116.375, 116.625, 116.875, 117.125, 117.375,
       117.625, 117.875, 118.125, 118.375, 118.625, 118.875, 119.125, 119.375,
       119.625, 119.875, 120.125, 120.375, 120.625, 120.875, 121.125, 121.375,
       121.625, 121.875], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>27.12 27.38 27.62 ... 33.12 33.38</div><input id='attrs-b851188e-d4d8-456e-988a-720bc9be0d51' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b851188e-d4d8-456e-988a-720bc9be0d51' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da9ea650-3785-456d-9646-9ba8b9b745b6' class='xr-var-data-in' type='checkbox'><label for='data-da9ea650-3785-456d-9646-9ba8b9b745b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude of center of grid box</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f78c6703-9468-49cc-b818-ada0bfdad8c5' class='xr-section-summary-in' type='checkbox'  ><label for='section-f78c6703-9468-49cc-b818-ada0bfdad8c5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c9f5d236-a169-45e7-9fc8-a38ad80dd358' class='xr-index-data-in' type='checkbox'/><label for='index-c9f5d236-a169-45e7-9fc8-a38ad80dd358' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-01-01&#x27;, &#x27;1998-01-02&#x27;, &#x27;1998-01-03&#x27;, &#x27;1998-01-04&#x27;,
               &#x27;1998-01-05&#x27;, &#x27;1998-01-06&#x27;, &#x27;1998-01-07&#x27;, &#x27;1998-01-08&#x27;,
               &#x27;1998-01-09&#x27;, &#x27;1998-01-10&#x27;,
               ...
               &#x27;2018-12-22&#x27;, &#x27;2018-12-23&#x27;, &#x27;2018-12-24&#x27;, &#x27;2018-12-25&#x27;,
               &#x27;2018-12-26&#x27;, &#x27;2018-12-27&#x27;, &#x27;2018-12-28&#x27;, &#x27;2018-12-29&#x27;,
               &#x27;2018-12-30&#x27;, &#x27;2018-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7670, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8d7ddb4d-7275-4e65-a074-9953f4d5e4c6' class='xr-index-data-in' type='checkbox'/><label for='index-8d7ddb4d-7275-4e65-a074-9953f4d5e4c6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([105.625, 105.875, 106.125, 106.375, 106.625, 106.875, 107.125, 107.375,
       107.625, 107.875, 108.125, 108.375, 108.625, 108.875, 109.125, 109.375,
       109.625, 109.875, 110.125, 110.375, 110.625, 110.875, 111.125, 111.375,
       111.625, 111.875, 112.125, 112.375, 112.625, 112.875, 113.125, 113.375,
       113.625, 113.875, 114.125, 114.375, 114.625, 114.875, 115.125, 115.375,
       115.625, 115.875, 116.125, 116.375, 116.625, 116.875, 117.125, 117.375,
       117.625, 117.875, 118.125, 118.375, 118.625, 118.875, 119.125, 119.375,
       119.625, 119.875, 120.125, 120.375, 120.625, 120.875, 121.125, 121.375,
       121.625, 121.875],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0a1f6458-7a1c-44d6-9bdb-0fdd142d5082' class='xr-index-data-in' type='checkbox'/><label for='index-0a1f6458-7a1c-44d6-9bdb-0fdd142d5082' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e78ae27a-8433-4f2b-91b6-a6c875d5a33c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e78ae27a-8433-4f2b-91b6-a6c875d5a33c' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_precipitation_rate</dd><dt><span>long_name :</span></dt><dd>precipitation</dd><dt><span>units :</span></dt><dd>mm/day</dd><dt><span>ver_note :</span></dt><dd>1998-2020: V1,0; 2021: V0.x.</dd><dt><span>comment :</span></dt><dd>!!! CMORPH estimate is rainrate !!!</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span> <span class="s1">&#39;data/ncep_r2_uv850/u850.*.nc&#39;</span><span class="p">,</span>                                       
                          <span class="n">combine</span> <span class="o">=</span> <span class="s2">&quot;nested&quot;</span><span class="p">,</span>               
                          <span class="n">concat_dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>                               
                          <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span>                
                         <span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">uds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1998-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2018-12-31&#39;</span><span class="p">),</span>
            <span class="n">level</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
            <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
            <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">115</span><span class="p">,</span><span class="mi">140</span><span class="p">))</span><span class="o">.</span><span class="n">uwnd</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">u</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;uwnd&#x27; (time: 7670, lat: 7, lon: 11)&gt; Size: 2MB
array([[[  1.6199951 ,   2.199997  ,   3.7700043 , ...,  10.75      ,
          11.020004  ,  10.369995  ],
        [  2.7700043 ,   3.2200012 ,   4.399994  , ...,  10.520004  ,
           8.569992  ,   5.7700043 ],
        [  4.0200043 ,   4.319992  ,   4.75      , ...,   6.869995  ,
           3.7700043 ,   0.09999084],
        ...,
        [  0.05000305,   0.02999878,   0.02999878, ...,  -2.8600006 ,
          -2.7100067 ,  -3.3600006 ],
        [ -3.380005  ,  -3.2900085 ,  -3.0800018 , ...,  -5.630005  ,
          -4.7599945 ,  -4.630005  ],
        [ -5.2900085 ,  -4.9100037 ,  -4.8099976 , ...,  -6.6100006 ,
          -6.8399963 ,  -7.2299957 ]],

       [[  6.849991  ,   6.6399994 ,   5.5       , ...,   8.169998  ,
           9.75      ,  10.599991  ],
        [  8.669998  ,   7.0899963 ,   5.        , ...,   7.849991  ,
           9.669998  ,  11.099991  ],
        [  6.9900055 ,   5.1900024 ,   3.3399963 , ...,   3.9900055 ,
           4.619995  ,   5.7400055 ],
...
        [-10.199997  , -12.449997  , -12.220001  , ...,  -6.300003  ,
          -4.75      ,  -3.600006  ],
        [-14.470001  , -15.869995  , -14.449997  , ...,  -9.869995  ,
          -8.770004  ,  -8.169998  ],
        [-15.949997  , -17.270004  , -16.350006  , ..., -11.720001  ,
         -11.169998  , -10.869995  ]],

       [[ -0.19999695,   0.02999878,   0.13000488, ...,   2.649994  ,
           2.7799988 ,   3.        ],
        [ -1.3500061 ,  -2.4700012 ,  -3.2200012 , ...,   1.6499939 ,
           1.300003  ,   0.94999695],
        [ -2.869995  ,  -5.220001  ,  -6.669998  , ...,  -1.0700073 ,
          -1.449997  ,  -1.75      ],
        ...,
        [-10.199997  , -11.850006  , -12.        , ...,  -7.650009  ,
          -6.970001  ,  -6.050003  ],
        [-14.070007  , -13.949997  , -12.600006  , ...,  -9.619995  ,
          -9.        ,  -8.150009  ],
        [-16.15001   , -14.350006  , -12.25      , ..., -10.720001  ,
         -10.5       , -10.220001  ]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 61kB 1998-01-01 1998-01-02 ... 2018-12-31
  * lon      (lon) float32 44B 115.0 117.5 120.0 122.5 ... 135.0 137.5 140.0
  * lat      (lat) float32 28B 30.0 27.5 25.0 22.5 20.0 17.5 15.0
    level    float32 4B 850.0
Attributes: (12/14)
    standard_name:         eastward_wind
    long_name:             Daily U-wind on Pressure Levels
    units:                 m/s
    unpacked_valid_range:  [-140.  175.]
    actual_range:          [-78.96 110.35]
    precision:             2
    ...                    ...
    var_desc:              u-wind
    dataset:               NCEP/DOE AMIP-II Reanalysis (Reanalysis-2) Daily A...
    level_desc:            Pressure Levels
    statistic:             Mean
    parent_stat:           Individual Obs
    cell_methods:          time: mean (of 4 6-hourly values in one day)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'uwnd'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7670</li><li><span class='xr-has-index'>lat</span>: 7</li><li><span class='xr-has-index'>lon</span>: 11</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-28c8541d-65ac-4f25-8f6e-11bc4c41bf30' class='xr-array-in' type='checkbox' checked><label for='section-28c8541d-65ac-4f25-8f6e-11bc4c41bf30' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.62 2.2 3.77 6.27 8.57 9.79 ... -11.92 -11.17 -10.72 -10.5 -10.22</span></div><div class='xr-array-data'><pre>array([[[  1.6199951 ,   2.199997  ,   3.7700043 , ...,  10.75      ,
          11.020004  ,  10.369995  ],
        [  2.7700043 ,   3.2200012 ,   4.399994  , ...,  10.520004  ,
           8.569992  ,   5.7700043 ],
        [  4.0200043 ,   4.319992  ,   4.75      , ...,   6.869995  ,
           3.7700043 ,   0.09999084],
        ...,
        [  0.05000305,   0.02999878,   0.02999878, ...,  -2.8600006 ,
          -2.7100067 ,  -3.3600006 ],
        [ -3.380005  ,  -3.2900085 ,  -3.0800018 , ...,  -5.630005  ,
          -4.7599945 ,  -4.630005  ],
        [ -5.2900085 ,  -4.9100037 ,  -4.8099976 , ...,  -6.6100006 ,
          -6.8399963 ,  -7.2299957 ]],

       [[  6.849991  ,   6.6399994 ,   5.5       , ...,   8.169998  ,
           9.75      ,  10.599991  ],
        [  8.669998  ,   7.0899963 ,   5.        , ...,   7.849991  ,
           9.669998  ,  11.099991  ],
        [  6.9900055 ,   5.1900024 ,   3.3399963 , ...,   3.9900055 ,
           4.619995  ,   5.7400055 ],
...
        [-10.199997  , -12.449997  , -12.220001  , ...,  -6.300003  ,
          -4.75      ,  -3.600006  ],
        [-14.470001  , -15.869995  , -14.449997  , ...,  -9.869995  ,
          -8.770004  ,  -8.169998  ],
        [-15.949997  , -17.270004  , -16.350006  , ..., -11.720001  ,
         -11.169998  , -10.869995  ]],

       [[ -0.19999695,   0.02999878,   0.13000488, ...,   2.649994  ,
           2.7799988 ,   3.        ],
        [ -1.3500061 ,  -2.4700012 ,  -3.2200012 , ...,   1.6499939 ,
           1.300003  ,   0.94999695],
        [ -2.869995  ,  -5.220001  ,  -6.669998  , ...,  -1.0700073 ,
          -1.449997  ,  -1.75      ],
        ...,
        [-10.199997  , -11.850006  , -12.        , ...,  -7.650009  ,
          -6.970001  ,  -6.050003  ],
        [-14.070007  , -13.949997  , -12.600006  , ...,  -9.619995  ,
          -9.        ,  -8.150009  ],
        [-16.15001   , -14.350006  , -12.25      , ..., -10.720001  ,
         -10.5       , -10.220001  ]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4ba82e51-e2e1-47a9-8f21-1f126dcf5089' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4ba82e51-e2e1-47a9-8f21-1f126dcf5089' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-01-01 ... 2018-12-31</div><input id='attrs-9090cc1d-a57b-46d1-9b78-1628bc603b56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9090cc1d-a57b-46d1-9b78-1628bc603b56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42af4a1a-06e2-49a2-a1f4-dfaf06799180' class='xr-var-data-in' type='checkbox'><label for='data-42af4a1a-06e2-49a2-a1f4-dfaf06799180' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-01-01T00:00:00.000000000&#x27;, &#x27;1998-01-02T00:00:00.000000000&#x27;,
       &#x27;1998-01-03T00:00:00.000000000&#x27;, ..., &#x27;2018-12-29T00:00:00.000000000&#x27;,
       &#x27;2018-12-30T00:00:00.000000000&#x27;, &#x27;2018-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>115.0 117.5 120.0 ... 137.5 140.0</div><input id='attrs-631f81fb-6097-4060-9943-381b10a90e77' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-631f81fb-6097-4060-9943-381b10a90e77' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c785271-6743-41be-88c1-73376a7acea8' class='xr-var-data-in' type='checkbox'><label for='data-4c785271-6743-41be-88c1-73376a7acea8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([115. , 117.5, 120. , 122.5, 125. , 127.5, 130. , 132.5, 135. , 137.5,
       140. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>30.0 27.5 25.0 22.5 20.0 17.5 15.0</div><input id='attrs-9325357e-83ad-4ea9-866d-0025ebfbea21' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9325357e-83ad-4ea9-866d-0025ebfbea21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8de2acb9-1a55-4545-9ff6-8ab9faa4cf9e' class='xr-var-data-in' type='checkbox'><label for='data-8de2acb9-1a55-4545-9ff6-8ab9faa4cf9e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([30. , 27.5, 25. , 22.5, 20. , 17.5, 15. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-171d10a2-15fc-4e2a-8dc5-05b9aca9cd43' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-171d10a2-15fc-4e2a-8dc5-05b9aca9cd43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2adacde-5256-432a-a156-db4aef6eda0c' class='xr-var-data-in' type='checkbox'><label for='data-a2adacde-5256-432a-a156-db4aef6eda0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa6e83be-db1c-4ebc-80d5-478467eba597' class='xr-section-summary-in' type='checkbox'  ><label for='section-fa6e83be-db1c-4ebc-80d5-478467eba597' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1d6d2a31-3c42-42b4-8ee2-2aeb4056c2a4' class='xr-index-data-in' type='checkbox'/><label for='index-1d6d2a31-3c42-42b4-8ee2-2aeb4056c2a4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-01-01&#x27;, &#x27;1998-01-02&#x27;, &#x27;1998-01-03&#x27;, &#x27;1998-01-04&#x27;,
               &#x27;1998-01-05&#x27;, &#x27;1998-01-06&#x27;, &#x27;1998-01-07&#x27;, &#x27;1998-01-08&#x27;,
               &#x27;1998-01-09&#x27;, &#x27;1998-01-10&#x27;,
               ...
               &#x27;2018-12-22&#x27;, &#x27;2018-12-23&#x27;, &#x27;2018-12-24&#x27;, &#x27;2018-12-25&#x27;,
               &#x27;2018-12-26&#x27;, &#x27;2018-12-27&#x27;, &#x27;2018-12-28&#x27;, &#x27;2018-12-29&#x27;,
               &#x27;2018-12-30&#x27;, &#x27;2018-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7670, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-994072ec-f62e-4567-951f-7a74cd45bdc3' class='xr-index-data-in' type='checkbox'/><label for='index-994072ec-f62e-4567-951f-7a74cd45bdc3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([115.0, 117.5, 120.0, 122.5, 125.0, 127.5, 130.0, 132.5, 135.0, 137.5,
       140.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5ef8d90c-5def-4709-8b4a-ded2f167f6d1' class='xr-index-data-in' type='checkbox'/><label for='index-5ef8d90c-5def-4709-8b4a-ded2f167f6d1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([30.0, 27.5, 25.0, 22.5, 20.0, 17.5, 15.0], dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b0e2d166-9f8f-4167-ba5c-b086a346a7b5' class='xr-section-summary-in' type='checkbox'  ><label for='section-b0e2d166-9f8f-4167-ba5c-b086a346a7b5' class='xr-section-summary' >Attributes: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>long_name :</span></dt><dd>Daily U-wind on Pressure Levels</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>unpacked_valid_range :</span></dt><dd>[-140.  175.]</dd><dt><span>actual_range :</span></dt><dd>[-78.96 110.35]</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>GRIB_id :</span></dt><dd>33</dd><dt><span>GRIB_name :</span></dt><dd>UGRD</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>dataset :</span></dt><dd>NCEP/DOE AMIP-II Reanalysis (Reanalysis-2) Daily Averages</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Individual Obs</dd><dt><span>cell_methods :</span></dt><dd>time: mean (of 4 6-hourly values in one day)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p><strong>Step 2</strong> Statistical analysis: calculate area mean rainfall and WPSH index, and select the season we need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
            <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>
            <span class="p">)</span>
<span class="n">pcp_ptd</span> <span class="o">=</span> <span class="n">pcpts</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">coord_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># 計算pentad mean</span>
<span class="n">pcp_ptd_mjj</span> <span class="o">=</span> <span class="n">pcp_ptd</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="n">pcp_ptd</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])))</span>
<span class="n">pcp_ptd_mjj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;cmorph&#x27; (time: 399)&gt; Size: 2kB
array([ 4.8970165 ,  7.9518876 ,  6.319289  ,  2.4725406 ,  5.27035   ,
        2.170851  ,  4.783776  ,  3.937529  , 11.973356  , 10.144266  ,
       11.061295  , 13.090139  ,  9.517157  ,  2.0094523 ,  3.4387412 ,
        6.7226806 , 11.502437  , 10.5547905 ,  9.479826  ,  2.9567833 ,
        3.5055594 ,  4.1681933 ,  6.725932  , 11.227705  ,  2.9874592 ,
        2.4019814 ,  4.487879  ,  2.9615617 ,  9.328345  ,  8.361376  ,
       17.8       ,  5.0629954 ,  9.045652  ,  4.8956294 ,  9.328997  ,
        3.7565734 ,  3.8314571 ,  4.111655  ,  0.3021329 ,  3.6132984 ,
        3.5981002 ,  2.3257692 ,  7.2976217 ,  5.5318065 , 13.691736  ,
        7.9762588 ,  4.2428904 ,  3.8893006 , 13.693474  ,  6.9901514 ,
        9.405932  ,  4.689091  ,  6.358776  ,  3.2129135 ,  2.252133  ,
        7.383217  ,  2.8664687 ,  4.964475  ,  4.936305  ,  1.1263635 ,
        2.2311187 ,  2.2804198 ,  4.0579023 ,  8.117238  ,  6.8227034 ,
        5.0488696 ,  8.666551  ,  5.666422  ,  4.5268536 ,  3.3424478 ,
        3.6482053 ,  6.963858  ,  1.558951  ,  3.8080535 ,  2.550478  ,
        5.6249647 ,  9.637308  ,  6.783858  , 12.585258  ,  4.844767  ,
        1.3790094 ,  4.6789045 ,  1.5510608 ,  7.1460257 ,  5.1195927 ,
        7.1560845 , 12.34908   , 12.694429  ,  3.5173545 ,  2.4259324 ,
        0.28142193,  9.145932  , 12.452902  ,  4.6736712 ,  5.1581006 ,
        6.8205705 ,  4.7389283 ,  9.617587  ,  3.4697907 ,  3.9260025 ,
...
        5.9538927 ,  5.01324   ,  0.9436598 ,  4.4753027 ,  6.041911  ,
        6.934068  ,  5.07711   ,  4.8284035 ,  8.588112  ,  1.5448952 ,
       10.228043  ,  1.7740676 ,  1.9260607 ,  7.228357  ,  8.549138  ,
        6.3187065 , 12.640233  ,  1.4202797 , 11.316084  ,  7.279161  ,
        4.142191  ,  3.5260372 ,  2.4751165 ,  4.1878905 ,  7.2561064 ,
       11.466655  ,  4.0412    ,  1.946387  ,  7.6451874 , 10.063392  ,
        6.7887535 ,  6.0969815 , 12.194288  ,  8.405164  , 10.297377  ,
        7.8729143 ,  2.699021  ,  4.153112  ,  5.390607  , 10.084627  ,
        3.1376457 ,  2.0847204 ,  9.51324   , 11.786633  ,  3.1671562 ,
        5.3714223 ,  4.1579022 ,  5.4215965 , 14.319791  ,  3.3686714 ,
        4.624697  , 13.882413  , 12.359255  , 10.334114  , 21.119303  ,
        5.0222025 ,  7.4891496 , 11.105817  ,  0.966352  ,  3.1370628 ,
        6.3480887 ,  4.5376463 ,  4.9669466 ,  7.596236  ,  1.2960141 ,
        4.0143824 ,  0.98304194,  9.380851  ,  8.573579  , 11.14049   ,
        4.2023306 , 13.881643  ,  9.043998  ,  9.088369  ,  9.648952  ,
        4.0862937 ,  3.827599  ,  0.41491842,  1.7904428 ,  4.379033  ,
        6.227797  ,  4.3578324 ,  1.9046853 , 12.030944  ,  7.8016205 ,
        5.260373  ,  2.5838928 ,  3.4374127 ,  2.6103146 ,  6.182331  ,
        4.548438  ,  7.4217596 , 12.894266  ,  7.690734  ,  2.6264687 ,
        0.7665617 ,  2.525     ,  7.5979834 ,  5.8932753 ], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 3kB 1998-05-01 1998-05-06 ... 2018-07-30</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'cmorph'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 399</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-dc146394-9a0d-4a80-a3fb-01b9a19b1bb4' class='xr-array-in' type='checkbox' checked><label for='section-dc146394-9a0d-4a80-a3fb-01b9a19b1bb4' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>4.897 7.952 6.319 2.473 5.27 2.171 ... 2.626 0.7666 2.525 7.598 5.893</span></div><div class='xr-array-data'><pre>array([ 4.8970165 ,  7.9518876 ,  6.319289  ,  2.4725406 ,  5.27035   ,
        2.170851  ,  4.783776  ,  3.937529  , 11.973356  , 10.144266  ,
       11.061295  , 13.090139  ,  9.517157  ,  2.0094523 ,  3.4387412 ,
        6.7226806 , 11.502437  , 10.5547905 ,  9.479826  ,  2.9567833 ,
        3.5055594 ,  4.1681933 ,  6.725932  , 11.227705  ,  2.9874592 ,
        2.4019814 ,  4.487879  ,  2.9615617 ,  9.328345  ,  8.361376  ,
       17.8       ,  5.0629954 ,  9.045652  ,  4.8956294 ,  9.328997  ,
        3.7565734 ,  3.8314571 ,  4.111655  ,  0.3021329 ,  3.6132984 ,
        3.5981002 ,  2.3257692 ,  7.2976217 ,  5.5318065 , 13.691736  ,
        7.9762588 ,  4.2428904 ,  3.8893006 , 13.693474  ,  6.9901514 ,
        9.405932  ,  4.689091  ,  6.358776  ,  3.2129135 ,  2.252133  ,
        7.383217  ,  2.8664687 ,  4.964475  ,  4.936305  ,  1.1263635 ,
        2.2311187 ,  2.2804198 ,  4.0579023 ,  8.117238  ,  6.8227034 ,
        5.0488696 ,  8.666551  ,  5.666422  ,  4.5268536 ,  3.3424478 ,
        3.6482053 ,  6.963858  ,  1.558951  ,  3.8080535 ,  2.550478  ,
        5.6249647 ,  9.637308  ,  6.783858  , 12.585258  ,  4.844767  ,
        1.3790094 ,  4.6789045 ,  1.5510608 ,  7.1460257 ,  5.1195927 ,
        7.1560845 , 12.34908   , 12.694429  ,  3.5173545 ,  2.4259324 ,
        0.28142193,  9.145932  , 12.452902  ,  4.6736712 ,  5.1581006 ,
        6.8205705 ,  4.7389283 ,  9.617587  ,  3.4697907 ,  3.9260025 ,
...
        5.9538927 ,  5.01324   ,  0.9436598 ,  4.4753027 ,  6.041911  ,
        6.934068  ,  5.07711   ,  4.8284035 ,  8.588112  ,  1.5448952 ,
       10.228043  ,  1.7740676 ,  1.9260607 ,  7.228357  ,  8.549138  ,
        6.3187065 , 12.640233  ,  1.4202797 , 11.316084  ,  7.279161  ,
        4.142191  ,  3.5260372 ,  2.4751165 ,  4.1878905 ,  7.2561064 ,
       11.466655  ,  4.0412    ,  1.946387  ,  7.6451874 , 10.063392  ,
        6.7887535 ,  6.0969815 , 12.194288  ,  8.405164  , 10.297377  ,
        7.8729143 ,  2.699021  ,  4.153112  ,  5.390607  , 10.084627  ,
        3.1376457 ,  2.0847204 ,  9.51324   , 11.786633  ,  3.1671562 ,
        5.3714223 ,  4.1579022 ,  5.4215965 , 14.319791  ,  3.3686714 ,
        4.624697  , 13.882413  , 12.359255  , 10.334114  , 21.119303  ,
        5.0222025 ,  7.4891496 , 11.105817  ,  0.966352  ,  3.1370628 ,
        6.3480887 ,  4.5376463 ,  4.9669466 ,  7.596236  ,  1.2960141 ,
        4.0143824 ,  0.98304194,  9.380851  ,  8.573579  , 11.14049   ,
        4.2023306 , 13.881643  ,  9.043998  ,  9.088369  ,  9.648952  ,
        4.0862937 ,  3.827599  ,  0.41491842,  1.7904428 ,  4.379033  ,
        6.227797  ,  4.3578324 ,  1.9046853 , 12.030944  ,  7.8016205 ,
        5.260373  ,  2.5838928 ,  3.4374127 ,  2.6103146 ,  6.182331  ,
        4.548438  ,  7.4217596 , 12.894266  ,  7.690734  ,  2.6264687 ,
        0.7665617 ,  2.525     ,  7.5979834 ,  5.8932753 ], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-cee044b5-00ab-463a-a66f-3c32a33f272e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cee044b5-00ab-463a-a66f-3c32a33f272e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-05-01 ... 2018-07-30</div><input id='attrs-3c235a74-f788-4d66-b68b-27573d6f0f01' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3c235a74-f788-4d66-b68b-27573d6f0f01' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c2001b0-ce92-445e-ad02-7e755062ca0d' class='xr-var-data-in' type='checkbox'><label for='data-6c2001b0-ce92-445e-ad02-7e755062ca0d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>starting point of time period</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-05-01T00:00:00.000000000&#x27;, &#x27;1998-05-06T00:00:00.000000000&#x27;,
       &#x27;1998-05-11T00:00:00.000000000&#x27;, ..., &#x27;2018-07-20T00:00:00.000000000&#x27;,
       &#x27;2018-07-25T00:00:00.000000000&#x27;, &#x27;2018-07-30T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9cb7e3b9-6766-4532-9068-84e852cd1030' class='xr-section-summary-in' type='checkbox'  ><label for='section-9cb7e3b9-6766-4532-9068-84e852cd1030' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8e21ecb7-6b60-4801-8571-3493fd4b3994' class='xr-index-data-in' type='checkbox'/><label for='index-8e21ecb7-6b60-4801-8571-3493fd4b3994' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-05-01&#x27;, &#x27;1998-05-06&#x27;, &#x27;1998-05-11&#x27;, &#x27;1998-05-16&#x27;,
               &#x27;1998-05-21&#x27;, &#x27;1998-05-26&#x27;, &#x27;1998-05-31&#x27;, &#x27;1998-06-05&#x27;,
               &#x27;1998-06-10&#x27;, &#x27;1998-06-15&#x27;,
               ...
               &#x27;2018-06-15&#x27;, &#x27;2018-06-20&#x27;, &#x27;2018-06-25&#x27;, &#x27;2018-06-30&#x27;,
               &#x27;2018-07-05&#x27;, &#x27;2018-07-10&#x27;, &#x27;2018-07-15&#x27;, &#x27;2018-07-20&#x27;,
               &#x27;2018-07-25&#x27;, &#x27;2018-07-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=399, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ca4f97f-0ac1-4bd6-9f49-d5401bf2c96e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8ca4f97f-0ac1-4bd6-9f49-d5401bf2c96e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ushear</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">28</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span>
            <span class="n">u</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="n">ushear_ts</span> <span class="o">=</span> <span class="n">ushear</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">ushear</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ushear</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>

<span class="n">us_ptd</span> <span class="o">=</span> <span class="n">ushear_ts</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">coord_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># 計算pentad mean</span>
<span class="n">us_ptd_mjj</span> <span class="o">=</span> <span class="n">us_ptd</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="n">us_ptd</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])))</span>
<span class="n">us_ptd_mjj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;uwnd&#x27; (time: 399)&gt; Size: 2kB
array([ 1.08629093e+01,  1.14845448e+01,  1.27180004e+01,  7.67090893e+00,
       -9.08927250e+00,  1.62546352e-01,  6.54854584e+00,  3.03854513e+00,
        1.47341814e+01,  1.10549088e+01,  9.51418018e+00,  1.52740021e+01,
        1.17298174e+01,  2.34254599e+00,  2.37345576e+00,  7.63490915e+00,
        4.29800034e+00,  6.97127247e+00,  4.96727324e+00,  2.77472639e+00,
        1.08218277e+00,  4.87781811e+00,  8.18581676e+00,  1.13078175e+01,
        6.89981747e+00, -2.22527266e+00,  3.71763611e+00,  1.82545400e+00,
        1.15070896e+01,  9.05963612e+00,  1.38921814e+01,  3.99600029e+00,
        5.89817762e-01, -4.41818285e+00,  2.03655250e-02, -1.17494535e+01,
       -5.74236393e+00, -1.61383629e+01,  3.51745367e+00, -4.62781763e+00,
        2.14727211e+00, -1.37327230e+00, -1.08218157e+00,  1.28032742e+01,
        1.37232723e+01,  6.91254520e+00,  1.41690862e+00,  4.48781872e+00,
        1.29796352e+01,  1.31552734e+01, -3.22763681e+00, -1.13463602e+01,
        5.61654615e+00, -1.32600141e+00,  3.53109050e+00, -3.57618141e+00,
       -1.29454046e-01,  3.42327356e+00,  6.09636402e+00,  5.71090996e-01,
        3.73472667e+00,  2.64709067e+00,  4.57490826e+00,  8.40818024e+00,
        7.98672724e+00,  3.31927180e+00,  1.02049084e+01,  7.53345490e+00,
        1.54910917e+01,  1.94982028e+00,  8.39455009e-01, -2.55490899e+00,
       -1.37581897e+00, -6.59454703e-01, -4.54090881e+00, -2.80399990e+00,
        7.21654510e+00,  1.01392727e+01,  8.40781975e+00,  2.78236127e+00,
...
       -3.35909081e+00, -2.14472914e+00, -1.34690914e+01,  6.40454388e+00,
        8.35018063e+00,  1.52945461e+01,  5.94981766e+00,  4.46163559e+00,
        6.36672592e+00,  1.17292728e+01,  1.14947262e+01,  1.54529085e+01,
        1.32661800e+01,  7.82145548e+00,  1.52783642e+01,  5.10400009e+00,
       -1.55118198e+01, -1.47272739e+01, -6.11872625e+00,  4.78290796e+00,
        7.42691040e+00,  5.28327274e+00,  1.16412716e+01,  1.51381836e+01,
        8.13599968e+00,  2.07236433e+00, -7.25818276e-01,  7.70108938e+00,
        1.57998517e-01,  2.49309182e+00,  7.68818140e+00,  1.67116356e+01,
        1.72925453e+01,  1.54359989e+01,  1.11898193e+01, -3.40909266e+00,
        1.10725451e+01,  1.00247269e+01,  2.75854492e+00,  1.69309044e+00,
       -3.19054580e+00,  5.67236233e+00,  1.40927277e+01,  1.23472738e+01,
        6.06909454e-01, -4.36436462e+00,  3.72109175e+00,  1.00218236e+00,
        8.18345451e+00,  5.64036417e+00, -1.42000675e-01,  1.12516356e+01,
        1.03294554e+01,  1.05718184e+01,  1.32959995e+01,  8.56436348e+00,
        1.11461811e+01,  1.51509058e+00, -1.21736355e+01, -1.27656345e+01,
        1.33679991e+01,  9.29127407e+00,  8.62581921e+00,  7.17381811e+00,
        5.08327198e+00,  8.33309078e+00,  4.55763721e+00, -1.31781673e+00,
       -6.21254635e+00, -6.81823716e-02,  1.00396366e+01,  5.55800009e+00,
       -1.58636284e+00, -2.48218107e+00, -5.53545380e+00, -1.40667267e+01,
       -1.13407259e+01, -6.04981899e+00, -6.60945368e+00], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 3kB 1998-05-01 1998-05-06 ... 2018-07-30
    level    float32 4B 850.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'uwnd'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 399</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-36e74f8c-9d8c-44eb-b4dc-cdff0cf5a410' class='xr-array-in' type='checkbox' checked><label for='section-36e74f8c-9d8c-44eb-b4dc-cdff0cf5a410' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>10.86 11.48 12.72 7.671 -9.089 ... -5.535 -14.07 -11.34 -6.05 -6.609</span></div><div class='xr-array-data'><pre>array([ 1.08629093e+01,  1.14845448e+01,  1.27180004e+01,  7.67090893e+00,
       -9.08927250e+00,  1.62546352e-01,  6.54854584e+00,  3.03854513e+00,
        1.47341814e+01,  1.10549088e+01,  9.51418018e+00,  1.52740021e+01,
        1.17298174e+01,  2.34254599e+00,  2.37345576e+00,  7.63490915e+00,
        4.29800034e+00,  6.97127247e+00,  4.96727324e+00,  2.77472639e+00,
        1.08218277e+00,  4.87781811e+00,  8.18581676e+00,  1.13078175e+01,
        6.89981747e+00, -2.22527266e+00,  3.71763611e+00,  1.82545400e+00,
        1.15070896e+01,  9.05963612e+00,  1.38921814e+01,  3.99600029e+00,
        5.89817762e-01, -4.41818285e+00,  2.03655250e-02, -1.17494535e+01,
       -5.74236393e+00, -1.61383629e+01,  3.51745367e+00, -4.62781763e+00,
        2.14727211e+00, -1.37327230e+00, -1.08218157e+00,  1.28032742e+01,
        1.37232723e+01,  6.91254520e+00,  1.41690862e+00,  4.48781872e+00,
        1.29796352e+01,  1.31552734e+01, -3.22763681e+00, -1.13463602e+01,
        5.61654615e+00, -1.32600141e+00,  3.53109050e+00, -3.57618141e+00,
       -1.29454046e-01,  3.42327356e+00,  6.09636402e+00,  5.71090996e-01,
        3.73472667e+00,  2.64709067e+00,  4.57490826e+00,  8.40818024e+00,
        7.98672724e+00,  3.31927180e+00,  1.02049084e+01,  7.53345490e+00,
        1.54910917e+01,  1.94982028e+00,  8.39455009e-01, -2.55490899e+00,
       -1.37581897e+00, -6.59454703e-01, -4.54090881e+00, -2.80399990e+00,
        7.21654510e+00,  1.01392727e+01,  8.40781975e+00,  2.78236127e+00,
...
       -3.35909081e+00, -2.14472914e+00, -1.34690914e+01,  6.40454388e+00,
        8.35018063e+00,  1.52945461e+01,  5.94981766e+00,  4.46163559e+00,
        6.36672592e+00,  1.17292728e+01,  1.14947262e+01,  1.54529085e+01,
        1.32661800e+01,  7.82145548e+00,  1.52783642e+01,  5.10400009e+00,
       -1.55118198e+01, -1.47272739e+01, -6.11872625e+00,  4.78290796e+00,
        7.42691040e+00,  5.28327274e+00,  1.16412716e+01,  1.51381836e+01,
        8.13599968e+00,  2.07236433e+00, -7.25818276e-01,  7.70108938e+00,
        1.57998517e-01,  2.49309182e+00,  7.68818140e+00,  1.67116356e+01,
        1.72925453e+01,  1.54359989e+01,  1.11898193e+01, -3.40909266e+00,
        1.10725451e+01,  1.00247269e+01,  2.75854492e+00,  1.69309044e+00,
       -3.19054580e+00,  5.67236233e+00,  1.40927277e+01,  1.23472738e+01,
        6.06909454e-01, -4.36436462e+00,  3.72109175e+00,  1.00218236e+00,
        8.18345451e+00,  5.64036417e+00, -1.42000675e-01,  1.12516356e+01,
        1.03294554e+01,  1.05718184e+01,  1.32959995e+01,  8.56436348e+00,
        1.11461811e+01,  1.51509058e+00, -1.21736355e+01, -1.27656345e+01,
        1.33679991e+01,  9.29127407e+00,  8.62581921e+00,  7.17381811e+00,
        5.08327198e+00,  8.33309078e+00,  4.55763721e+00, -1.31781673e+00,
       -6.21254635e+00, -6.81823716e-02,  1.00396366e+01,  5.55800009e+00,
       -1.58636284e+00, -2.48218107e+00, -5.53545380e+00, -1.40667267e+01,
       -1.13407259e+01, -6.04981899e+00, -6.60945368e+00], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-8105f80d-dc73-4716-9dd9-d2473c4a9493' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8105f80d-dc73-4716-9dd9-d2473c4a9493' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1998-05-01 ... 2018-07-30</div><input id='attrs-5ea53e2a-6aec-45ed-aa96-4958451c98aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5ea53e2a-6aec-45ed-aa96-4958451c98aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7e6f09c-12ed-427c-8cf8-1bf0c2046dc3' class='xr-var-data-in' type='checkbox'><label for='data-e7e6f09c-12ed-427c-8cf8-1bf0c2046dc3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1998-05-01T00:00:00.000000000&#x27;, &#x27;1998-05-06T00:00:00.000000000&#x27;,
       &#x27;1998-05-11T00:00:00.000000000&#x27;, ..., &#x27;2018-07-20T00:00:00.000000000&#x27;,
       &#x27;2018-07-25T00:00:00.000000000&#x27;, &#x27;2018-07-30T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>850.0</div><input id='attrs-d8d44059-d5d3-4a16-b852-d3cd67e5270e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d8d44059-d5d3-4a16-b852-d3cd67e5270e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79e3a176-5b17-45ca-8ea4-833201194946' class='xr-var-data-in' type='checkbox'><label for='data-79e3a176-5b17-45ca-8ea4-833201194946' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd></dl></div><div class='xr-var-data'><pre>array(850., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a06b5041-1acb-40d7-889c-5310027cce00' class='xr-section-summary-in' type='checkbox'  ><label for='section-a06b5041-1acb-40d7-889c-5310027cce00' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-828ef378-2467-41bb-b6cf-d9831e269bbc' class='xr-index-data-in' type='checkbox'/><label for='index-828ef378-2467-41bb-b6cf-d9831e269bbc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1998-05-01&#x27;, &#x27;1998-05-06&#x27;, &#x27;1998-05-11&#x27;, &#x27;1998-05-16&#x27;,
               &#x27;1998-05-21&#x27;, &#x27;1998-05-26&#x27;, &#x27;1998-05-31&#x27;, &#x27;1998-06-05&#x27;,
               &#x27;1998-06-10&#x27;, &#x27;1998-06-15&#x27;,
               ...
               &#x27;2018-06-15&#x27;, &#x27;2018-06-20&#x27;, &#x27;2018-06-25&#x27;, &#x27;2018-06-30&#x27;,
               &#x27;2018-07-05&#x27;, &#x27;2018-07-10&#x27;, &#x27;2018-07-15&#x27;, &#x27;2018-07-20&#x27;,
               &#x27;2018-07-25&#x27;, &#x27;2018-07-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=399, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-33552820-9af9-4950-aa12-c7ee482fec83' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-33552820-9af9-4950-aa12-c7ee482fec83' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p><strong>Step 3:</strong> Convert the DataArrays to long frame DataFrame, and pass to <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> for plotting. To plot scatter plot and regression line, use <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.regplot.html#seaborn.regplot"><code class="docutils literal notranslate"><span class="pre">seaborn.regplot</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scatter_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">pcp_ptd_mjj</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;pcp&#39;</span><span class="p">),</span> <span class="n">us_ptd_mjj</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;ushear&#39;</span><span class="p">)])</span>
                <span class="o">.</span><span class="n">to_dataframe</span><span class="p">())</span>
<span class="n">scatter_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pcp</th>
      <th>level</th>
      <th>ushear</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998-05-01</th>
      <td>4.897017</td>
      <td>850.0</td>
      <td>10.862909</td>
    </tr>
    <tr>
      <th>1998-05-06</th>
      <td>7.951888</td>
      <td>850.0</td>
      <td>11.484545</td>
    </tr>
    <tr>
      <th>1998-05-11</th>
      <td>6.319289</td>
      <td>850.0</td>
      <td>12.718000</td>
    </tr>
    <tr>
      <th>1998-05-16</th>
      <td>2.472541</td>
      <td>850.0</td>
      <td>7.670909</td>
    </tr>
    <tr>
      <th>1998-05-21</th>
      <td>5.270350</td>
      <td>850.0</td>
      <td>-9.089272</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-07-10</th>
      <td>2.626469</td>
      <td>850.0</td>
      <td>-5.535454</td>
    </tr>
    <tr>
      <th>2018-07-15</th>
      <td>0.766562</td>
      <td>850.0</td>
      <td>-14.066727</td>
    </tr>
    <tr>
      <th>2018-07-20</th>
      <td>2.525000</td>
      <td>850.0</td>
      <td>-11.340726</td>
    </tr>
    <tr>
      <th>2018-07-25</th>
      <td>7.597983</td>
      <td>850.0</td>
      <td>-6.049819</td>
    </tr>
    <tr>
      <th>2018-07-30</th>
      <td>5.893275</td>
      <td>850.0</td>
      <td>-6.609454</td>
    </tr>
  </tbody>
</table>
<p>399 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">def</span> <span class="nf">corr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 計算相關係數和統計顯著性。</span>
<span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">corr</span><span class="p">(</span><span class="n">us_ptd_mjj</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">pcp_ptd_mjj</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;ushear&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pcp&quot;</span><span class="p">,</span>
                  <span class="n">data</span><span class="o">=</span><span class="n">scatter_df</span><span class="p">,</span>
                  <span class="n">ci</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1"># ci是信心水準</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$R=$ </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">5.3f</span><span class="si">}</span><span class="s1">, $p=$ </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">8.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span> <span class="p">)</span>  <span class="c1"># Correlation coefficient and p-values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(1.0, 1.0, &#39;$R=$ 0.394, $p=$ 3.07e-16&#39;)
</pre></div>
</div>
<img alt="_images/ac8a90f8df6070e8667f7a6ede17accbf0b29aad0d6e6df7053e7ffdf204dde6.png" src="_images/ac8a90f8df6070e8667f7a6ede17accbf0b29aad0d6e6df7053e7ffdf204dde6.png" />
</div>
</div>
</section>
</section>
<section id="plotting-wide-form-pandas-dataframe-with-seaborn">
<h2>Plotting Wide Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code><a class="headerlink" href="#plotting-wide-form-pandas-dataframe-with-seaborn" title="Link to this heading">#</a></h2>
<p><strong>Example 4:</strong> Plot a heat map of pentad mean rainfall percentile ranks (PRs) from April to November in 1998-2020 over the Taiwan-northern South China Sea region (18˚-24˚N, 116˚-126˚E).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span><span class="p">,</span> <span class="n">latn</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span>                  
<span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">126</span>         

<span class="n">pcp</span> <span class="o">=</span> <span class="n">pcpds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1998-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2020-12-31&#39;</span><span class="p">),</span>
                  <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lats</span><span class="p">,</span><span class="n">latn</span><span class="p">),</span>
                  <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="p">))</span><span class="o">.</span><span class="n">cmorph</span>

<span class="n">pcp_ptd_ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
                 <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pcp</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>
                 <span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">coord_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">})</span>
                 <span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">pcp_season</span> <span class="o">=</span> <span class="n">pcp_ptd_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="n">pcp_ptd_ts</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcp_rank</span> <span class="o">=</span> <span class="n">pcp_season</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.</span>  <span class="c1"># Use `DataArray.rank` to rank. `pct=True` can calculate percentiles. </span>
<span class="n">pcp_rank_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pcp_rank</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="mi">49</span><span class="p">),</span>  <span class="c1"># reshape the array to (year, pentad)</span>
                           <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;pentad&quot;</span><span class="p">],</span>
                           <span class="n">coords</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                      <span class="n">year</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1998</span><span class="p">,</span><span class="mi">2021</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                                      <span class="n">pentad</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                                      <span class="p">),</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;precip&#39;</span><span class="p">)</span>
<span class="n">pcp_rank_da</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;precip&#x27; (year: 23, pentad: 49)&gt; Size: 9kB
array([[2.40461402e+01, 7.98580302e-01, 7.22271517e+01, ...,
        6.67258208e+01, 8.33185448e+01, 3.62910382e+01],
       [3.99290151e+01, 1.87222715e+01, 6.03371783e+01, ...,
        2.72404614e+01, 1.30434783e+01, 7.00976043e+01],
       [4.31233363e+01, 3.47826087e+01, 4.62289264e+01, ...,
        6.34427684e+01, 4.42768412e+01, 6.29991127e+00],
       ...,
       [8.87311446e-02, 3.44276841e+01, 4.09937888e+01, ...,
        1.56166815e+01, 5.49245785e+01, 3.02573203e+01],
       [4.30346051e+01, 2.66193434e-01, 5.42147294e+01, ...,
        9.13930790e+01, 3.16770186e+01, 1.20674357e+01],
       [4.27684117e+01, 5.04880213e+01, 2.71517303e+01, ...,
        1.48181012e+01, 1.27772848e+01, 4.57852706e+01]])
Coordinates:
  * year     (year) int64 184B 1998 1999 2000 2001 2002 ... 2017 2018 2019 2020
  * pentad   (pentad) int64 392B 19 20 21 22 23 24 25 ... 61 62 63 64 65 66 67</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'precip'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 23</li><li><span class='xr-has-index'>pentad</span>: 49</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d0a23a50-ce52-4039-8897-4a4f64f18140' class='xr-array-in' type='checkbox' checked><label for='section-d0a23a50-ce52-4039-8897-4a4f64f18140' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>24.05 0.7986 72.23 77.11 32.48 68.41 ... 76.13 77.82 14.82 12.78 45.79</span></div><div class='xr-array-data'><pre>array([[2.40461402e+01, 7.98580302e-01, 7.22271517e+01, ...,
        6.67258208e+01, 8.33185448e+01, 3.62910382e+01],
       [3.99290151e+01, 1.87222715e+01, 6.03371783e+01, ...,
        2.72404614e+01, 1.30434783e+01, 7.00976043e+01],
       [4.31233363e+01, 3.47826087e+01, 4.62289264e+01, ...,
        6.34427684e+01, 4.42768412e+01, 6.29991127e+00],
       ...,
       [8.87311446e-02, 3.44276841e+01, 4.09937888e+01, ...,
        1.56166815e+01, 5.49245785e+01, 3.02573203e+01],
       [4.30346051e+01, 2.66193434e-01, 5.42147294e+01, ...,
        9.13930790e+01, 3.16770186e+01, 1.20674357e+01],
       [4.27684117e+01, 5.04880213e+01, 2.71517303e+01, ...,
        1.48181012e+01, 1.27772848e+01, 4.57852706e+01]])</pre></div></div></li><li class='xr-section-item'><input id='section-7aad5631-2fdc-4e4e-90f3-12dcff927b2f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7aad5631-2fdc-4e4e-90f3-12dcff927b2f' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1998 1999 2000 ... 2018 2019 2020</div><input id='attrs-0409ba1a-33a5-4774-b06b-5d65a5e7a04a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0409ba1a-33a5-4774-b06b-5d65a5e7a04a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24e2c707-795e-4693-a757-ef60708f026a' class='xr-var-data-in' type='checkbox'><label for='data-24e2c707-795e-4693-a757-ef60708f026a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,
       2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pentad</span></div><div class='xr-var-dims'>(pentad)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 20 21 22 23 ... 63 64 65 66 67</div><input id='attrs-78f2b3d7-5ddc-4f0e-b49c-f10d20cdf8c6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78f2b3d7-5ddc-4f0e-b49c-f10d20cdf8c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5e663b2-9ffa-483a-afc8-3bd43bc2cc79' class='xr-var-data-in' type='checkbox'><label for='data-b5e663b2-9ffa-483a-afc8-3bd43bc2cc79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
       37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54,
       55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cbc1c52d-d21b-4ebf-a1d1-a9e7ac3e347f' class='xr-section-summary-in' type='checkbox'  ><label for='section-cbc1c52d-d21b-4ebf-a1d1-a9e7ac3e347f' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-425c53c0-bd1c-4211-8e99-1df12ea00ca3' class='xr-index-data-in' type='checkbox'/><label for='index-425c53c0-bd1c-4211-8e99-1df12ea00ca3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,
       2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>pentad</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4e06ade6-3d20-4e38-852b-8f25da16831e' class='xr-index-data-in' type='checkbox'/><label for='index-4e06ade6-3d20-4e38-852b-8f25da16831e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
       37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54,
       55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67],
      dtype=&#x27;int64&#x27;, name=&#x27;pentad&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ae4f89d6-bbe6-48b6-81e5-4ab8a8461d77' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ae4f89d6-bbe6-48b6-81e5-4ab8a8461d77' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcp_rank_df</span> <span class="o">=</span> <span class="n">pcp_rank_da</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">pcp_rank_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>pentad</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>...</th>
      <th>58</th>
      <th>59</th>
      <th>60</th>
      <th>61</th>
      <th>62</th>
      <th>63</th>
      <th>64</th>
      <th>65</th>
      <th>66</th>
      <th>67</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998</th>
      <td>24.046140</td>
      <td>0.798580</td>
      <td>72.227152</td>
      <td>77.107365</td>
      <td>32.475599</td>
      <td>68.411713</td>
      <td>51.197870</td>
      <td>26.086957</td>
      <td>45.519077</td>
      <td>86.867791</td>
      <td>...</td>
      <td>94.942325</td>
      <td>43.300799</td>
      <td>98.225377</td>
      <td>15.527950</td>
      <td>66.104703</td>
      <td>52.440106</td>
      <td>20.585626</td>
      <td>66.725821</td>
      <td>83.318545</td>
      <td>36.291038</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>39.929015</td>
      <td>18.722272</td>
      <td>60.337178</td>
      <td>5.501331</td>
      <td>7.897072</td>
      <td>81.366460</td>
      <td>70.275067</td>
      <td>76.220053</td>
      <td>55.723159</td>
      <td>49.778172</td>
      <td>...</td>
      <td>85.891748</td>
      <td>64.951198</td>
      <td>10.559006</td>
      <td>24.312334</td>
      <td>28.748891</td>
      <td>13.487134</td>
      <td>12.156167</td>
      <td>27.240461</td>
      <td>13.043478</td>
      <td>70.097604</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>43.123336</td>
      <td>34.782609</td>
      <td>46.228926</td>
      <td>26.974268</td>
      <td>34.605146</td>
      <td>58.207631</td>
      <td>39.219166</td>
      <td>4.081633</td>
      <td>70.541260</td>
      <td>84.117125</td>
      <td>...</td>
      <td>69.565217</td>
      <td>48.890861</td>
      <td>25.554570</td>
      <td>96.628217</td>
      <td>88.553682</td>
      <td>65.838509</td>
      <td>65.306122</td>
      <td>63.442768</td>
      <td>44.276841</td>
      <td>6.299911</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>39.751553</td>
      <td>37.267081</td>
      <td>37.799468</td>
      <td>40.195209</td>
      <td>61.579414</td>
      <td>22.448980</td>
      <td>37.089618</td>
      <td>58.385093</td>
      <td>92.280390</td>
      <td>77.639752</td>
      <td>...</td>
      <td>55.989352</td>
      <td>5.944987</td>
      <td>1.863354</td>
      <td>26.619343</td>
      <td>15.882875</td>
      <td>57.409051</td>
      <td>66.637090</td>
      <td>6.654836</td>
      <td>4.170364</td>
      <td>2.040816</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>4.259095</td>
      <td>3.637977</td>
      <td>21.916593</td>
      <td>6.743567</td>
      <td>3.992902</td>
      <td>4.702751</td>
      <td>0.177462</td>
      <td>3.460515</td>
      <td>33.895297</td>
      <td>79.858030</td>
      <td>...</td>
      <td>11.002662</td>
      <td>49.423248</td>
      <td>43.212067</td>
      <td>49.068323</td>
      <td>34.072760</td>
      <td>50.399290</td>
      <td>17.125111</td>
      <td>62.999113</td>
      <td>26.796806</td>
      <td>25.820763</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>48.003549</td>
      <td>56.255546</td>
      <td>20.496894</td>
      <td>31.322094</td>
      <td>78.615794</td>
      <td>7.808341</td>
      <td>37.533274</td>
      <td>6.122449</td>
      <td>11.268855</td>
      <td>47.914818</td>
      <td>...</td>
      <td>44.454303</td>
      <td>11.712511</td>
      <td>2.750665</td>
      <td>61.490683</td>
      <td>57.231588</td>
      <td>27.861579</td>
      <td>64.596273</td>
      <td>50.842946</td>
      <td>46.140195</td>
      <td>8.340728</td>
    </tr>
    <tr>
      <th>2004</th>
      <td>44.099379</td>
      <td>18.367347</td>
      <td>21.118012</td>
      <td>17.746229</td>
      <td>5.678793</td>
      <td>8.518190</td>
      <td>9.671695</td>
      <td>30.434783</td>
      <td>19.698314</td>
      <td>77.994676</td>
      <td>...</td>
      <td>15.705413</td>
      <td>38.509317</td>
      <td>62.910382</td>
      <td>1.685892</td>
      <td>3.194321</td>
      <td>13.753327</td>
      <td>19.343390</td>
      <td>42.945874</td>
      <td>56.965395</td>
      <td>28.926353</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>7.187223</td>
      <td>1.419698</td>
      <td>26.264419</td>
      <td>8.074534</td>
      <td>18.988465</td>
      <td>11.801242</td>
      <td>17.480035</td>
      <td>86.956522</td>
      <td>61.668146</td>
      <td>27.595386</td>
      <td>...</td>
      <td>13.664596</td>
      <td>9.405501</td>
      <td>29.281278</td>
      <td>56.166815</td>
      <td>0.976043</td>
      <td>42.502218</td>
      <td>50.044366</td>
      <td>66.015972</td>
      <td>33.007986</td>
      <td>50.931677</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>2.218279</td>
      <td>15.350488</td>
      <td>46.406389</td>
      <td>34.960071</td>
      <td>19.254658</td>
      <td>49.334516</td>
      <td>27.950311</td>
      <td>3.105590</td>
      <td>69.476486</td>
      <td>81.543922</td>
      <td>...</td>
      <td>5.590062</td>
      <td>11.446318</td>
      <td>33.984028</td>
      <td>87.133984</td>
      <td>72.848270</td>
      <td>29.547471</td>
      <td>35.492458</td>
      <td>54.303461</td>
      <td>21.827862</td>
      <td>33.096717</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>51.020408</td>
      <td>33.185448</td>
      <td>5.767524</td>
      <td>39.396628</td>
      <td>27.772848</td>
      <td>13.398403</td>
      <td>32.386868</td>
      <td>52.706300</td>
      <td>30.967169</td>
      <td>74.090506</td>
      <td>...</td>
      <td>30.612245</td>
      <td>12.954747</td>
      <td>20.053239</td>
      <td>54.835847</td>
      <td>91.481810</td>
      <td>75.421473</td>
      <td>7.364685</td>
      <td>25.199645</td>
      <td>87.488909</td>
      <td>43.833185</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>12.333629</td>
      <td>3.904170</td>
      <td>12.599823</td>
      <td>48.269743</td>
      <td>51.641526</td>
      <td>43.389530</td>
      <td>46.850044</td>
      <td>30.079858</td>
      <td>56.433008</td>
      <td>71.960958</td>
      <td>...</td>
      <td>72.315883</td>
      <td>7.630878</td>
      <td>14.374445</td>
      <td>10.825200</td>
      <td>19.964508</td>
      <td>93.611358</td>
      <td>32.209406</td>
      <td>54.037267</td>
      <td>62.732919</td>
      <td>47.204969</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>30.700976</td>
      <td>38.952972</td>
      <td>50.754215</td>
      <td>81.721384</td>
      <td>90.683230</td>
      <td>40.550133</td>
      <td>12.688554</td>
      <td>55.013310</td>
      <td>0.532387</td>
      <td>20.763088</td>
      <td>...</td>
      <td>59.982254</td>
      <td>72.049689</td>
      <td>70.629991</td>
      <td>33.362910</td>
      <td>60.425909</td>
      <td>4.525288</td>
      <td>48.624667</td>
      <td>46.761313</td>
      <td>22.626442</td>
      <td>19.432121</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>14.640639</td>
      <td>35.314996</td>
      <td>32.564330</td>
      <td>24.134871</td>
      <td>33.629104</td>
      <td>76.841171</td>
      <td>64.063886</td>
      <td>21.472937</td>
      <td>24.755989</td>
      <td>9.849157</td>
      <td>...</td>
      <td>67.701863</td>
      <td>96.716948</td>
      <td>63.975155</td>
      <td>23.336291</td>
      <td>78.083407</td>
      <td>72.759539</td>
      <td>80.745342</td>
      <td>36.645963</td>
      <td>41.171251</td>
      <td>10.204082</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>10.647737</td>
      <td>2.484472</td>
      <td>1.153505</td>
      <td>58.473824</td>
      <td>18.101154</td>
      <td>18.012422</td>
      <td>10.026619</td>
      <td>73.469388</td>
      <td>26.530612</td>
      <td>86.335404</td>
      <td>...</td>
      <td>87.577640</td>
      <td>44.986690</td>
      <td>29.458740</td>
      <td>33.451642</td>
      <td>67.435670</td>
      <td>94.676131</td>
      <td>80.035492</td>
      <td>65.572316</td>
      <td>50.221828</td>
      <td>68.677906</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>31.588287</td>
      <td>36.557232</td>
      <td>1.597161</td>
      <td>56.699201</td>
      <td>22.981366</td>
      <td>64.507542</td>
      <td>37.976930</td>
      <td>19.875776</td>
      <td>54.392192</td>
      <td>97.249335</td>
      <td>...</td>
      <td>13.575865</td>
      <td>3.726708</td>
      <td>37.444543</td>
      <td>59.804791</td>
      <td>69.653949</td>
      <td>12.244898</td>
      <td>52.085182</td>
      <td>59.094942</td>
      <td>35.758651</td>
      <td>39.041704</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>59.538598</td>
      <td>64.685004</td>
      <td>31.410825</td>
      <td>24.578527</td>
      <td>29.724933</td>
      <td>57.941437</td>
      <td>75.332742</td>
      <td>28.305235</td>
      <td>66.193434</td>
      <td>72.138421</td>
      <td>...</td>
      <td>39.840284</td>
      <td>14.285714</td>
      <td>23.425022</td>
      <td>76.929902</td>
      <td>48.447205</td>
      <td>35.048802</td>
      <td>42.857143</td>
      <td>23.070098</td>
      <td>41.259982</td>
      <td>42.058563</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>49.955634</td>
      <td>24.489796</td>
      <td>7.275954</td>
      <td>0.709849</td>
      <td>10.292813</td>
      <td>30.346051</td>
      <td>64.862467</td>
      <td>73.824312</td>
      <td>36.202307</td>
      <td>37.000887</td>
      <td>...</td>
      <td>7.985803</td>
      <td>35.403727</td>
      <td>34.693878</td>
      <td>4.436557</td>
      <td>16.592724</td>
      <td>9.937888</td>
      <td>66.903283</td>
      <td>51.286602</td>
      <td>16.503993</td>
      <td>41.881100</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>25.643301</td>
      <td>42.324756</td>
      <td>39.574091</td>
      <td>34.871340</td>
      <td>41.703638</td>
      <td>16.149068</td>
      <td>10.115350</td>
      <td>59.449867</td>
      <td>38.065661</td>
      <td>52.883762</td>
      <td>...</td>
      <td>52.173913</td>
      <td>85.714286</td>
      <td>27.417924</td>
      <td>17.213842</td>
      <td>54.569654</td>
      <td>31.144632</td>
      <td>20.408163</td>
      <td>28.482697</td>
      <td>41.614907</td>
      <td>25.377107</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>0.621118</td>
      <td>40.638864</td>
      <td>67.169476</td>
      <td>9.228039</td>
      <td>29.192547</td>
      <td>37.355812</td>
      <td>13.220941</td>
      <td>20.230701</td>
      <td>50.310559</td>
      <td>58.651287</td>
      <td>...</td>
      <td>69.387755</td>
      <td>80.390417</td>
      <td>8.163265</td>
      <td>46.938776</td>
      <td>14.729370</td>
      <td>25.022183</td>
      <td>16.770186</td>
      <td>45.430346</td>
      <td>74.445430</td>
      <td>81.810115</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>19.165927</td>
      <td>1.952085</td>
      <td>47.116238</td>
      <td>26.885537</td>
      <td>59.361136</td>
      <td>36.379769</td>
      <td>10.913931</td>
      <td>11.623780</td>
      <td>50.133097</td>
      <td>95.563443</td>
      <td>...</td>
      <td>90.417036</td>
      <td>24.667258</td>
      <td>11.978705</td>
      <td>28.837622</td>
      <td>86.069210</td>
      <td>64.330080</td>
      <td>47.648625</td>
      <td>48.802130</td>
      <td>46.583851</td>
      <td>53.149956</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>0.088731</td>
      <td>34.427684</td>
      <td>40.993789</td>
      <td>18.456078</td>
      <td>37.178350</td>
      <td>6.921029</td>
      <td>11.091393</td>
      <td>65.394854</td>
      <td>4.791482</td>
      <td>1.064774</td>
      <td>...</td>
      <td>46.495120</td>
      <td>28.393966</td>
      <td>11.357587</td>
      <td>91.215617</td>
      <td>23.158829</td>
      <td>1.774623</td>
      <td>16.681455</td>
      <td>15.616681</td>
      <td>54.924579</td>
      <td>30.257320</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>43.034605</td>
      <td>0.266193</td>
      <td>54.214729</td>
      <td>69.742680</td>
      <td>8.606921</td>
      <td>29.015084</td>
      <td>78.172138</td>
      <td>75.865129</td>
      <td>47.293700</td>
      <td>46.051464</td>
      <td>...</td>
      <td>24.223602</td>
      <td>14.995563</td>
      <td>19.520852</td>
      <td>37.888199</td>
      <td>88.819876</td>
      <td>47.826087</td>
      <td>38.243123</td>
      <td>91.393079</td>
      <td>31.677019</td>
      <td>12.067436</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>42.768412</td>
      <td>50.488021</td>
      <td>27.151730</td>
      <td>1.330967</td>
      <td>47.471162</td>
      <td>29.103815</td>
      <td>3.549246</td>
      <td>4.880213</td>
      <td>42.590949</td>
      <td>89.263531</td>
      <td>...</td>
      <td>45.607808</td>
      <td>84.472050</td>
      <td>79.680568</td>
      <td>53.238687</td>
      <td>74.001775</td>
      <td>76.131322</td>
      <td>77.817214</td>
      <td>14.818101</td>
      <td>12.777285</td>
      <td>45.785271</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 49 columns</p>
</div></div></div>
</div>
<p>The above DataFrame is in a wide form table.</p>
<p>In a long form DataFrame, labels are only stored in the index. In contrast, a wide form DataFrame stores labels in both columns and index, allowing for a two-dimensional representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pcp_rank_df</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet_r&#39;</span><span class="p">,</span>
                 <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s1">&#39;extend&#39;</span><span class="p">:</span><span class="s1">&#39;neither&#39;</span><span class="p">},</span>
                 <span class="n">xticklabels</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Pentad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Years&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Taiwan-Northern SCS, April to November&quot;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;pcp_pr_heatmap_obs_chn.png&quot;</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fed5a3367644b1ef0e6ac7ec7b919a4799b08de49bcc445d2fdde97606642756.png" src="_images/fed5a3367644b1ef0e6ac7ec7b919a4799b08de49bcc445d2fdde97606642756.png" />
</div>
</div>
</section>
<section id="conversion-between-long-form-and-wide-form">
<h2>Conversion between Long Form and Wide Form<a class="headerlink" href="#conversion-between-long-form-and-wide-form" title="Link to this heading">#</a></h2>
<p>Use <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.unstack</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcp_rank_long</span> <span class="o">=</span> <span class="n">pcp_rank_df</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;PR&#39;</span><span class="p">)</span>
<span class="n">pcp_rank_long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pentad</th>
      <th>year</th>
      <th>PR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>1998</td>
      <td>24.046140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>1999</td>
      <td>39.929015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>2000</td>
      <td>43.123336</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19</td>
      <td>2001</td>
      <td>39.751553</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19</td>
      <td>2002</td>
      <td>4.259095</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1122</th>
      <td>67</td>
      <td>2016</td>
      <td>81.810115</td>
    </tr>
    <tr>
      <th>1123</th>
      <td>67</td>
      <td>2017</td>
      <td>53.149956</td>
    </tr>
    <tr>
      <th>1124</th>
      <td>67</td>
      <td>2018</td>
      <td>30.257320</td>
    </tr>
    <tr>
      <th>1125</th>
      <td>67</td>
      <td>2019</td>
      <td>12.067436</td>
    </tr>
    <tr>
      <th>1126</th>
      <td>67</td>
      <td>2020</td>
      <td>45.785271</td>
    </tr>
  </tbody>
</table>
<p>1127 rows × 3 columns</p>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="09_plotting_2d.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">9. <code class="docutils literal notranslate"><span class="pre">xarray</span></code> Plotting (II): Plotting Data with More Than 2 Dimensions</p>
      </div>
    </a>
    <a class="right-next"
       href="11_cdo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">11. Climate Data Operator (CDO)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure-of-pandas">Data Structure of <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-csv-file-with-pandas">Read <code class="docutils literal notranslate"><span class="pre">.csv</span></code> File with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-long-form-pandas-dataframe-with-seaborn">Plotting Long Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-of-xarray-dataarray-to-pandas-dataframe">Conversion of <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> to <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-to-pandas"><code class="docutils literal notranslate"><span class="pre">xarray.to_pandas</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-scatter-plot-and-regression-line">Example: Scatter Plot and Regression Line</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-wide-form-pandas-dataframe-with-seaborn">Plotting Wide Form <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">seaborn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-between-long-form-and-wide-form">Conversion between Long Form and Wide Form</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Wayne Yuan-Huai Tsai, University of Oklahoma
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
Last updated: 2024-08-23
</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>